{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 5a8d08496892d4cef3c6","webpack:///D:\\学习\\webGlobe2/node_modules\\process\\browser.js","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Kernel.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\math\\Utils.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Utils.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\math\\Vertice.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\math\\Vector.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Extent.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\GraphicGroup.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\materials\\MeshTextureMaterial.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\geometries\\Mesh.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\geometries\\MeshVertice.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Service.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\TileGrid.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\math\\Matrix.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Image.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\Tile.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\MeshTextureGraphic.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Program.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\Graphic.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\geometries\\Triangle.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\math\\Line.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Object3D.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\TiledLayer.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\materials\\Material.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\VertexBufferObject.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\SubTiledLayer.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\LabelLayer.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Env.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\MultiPointsGraphic.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\materials\\MarkerTextureMaterial.ts","webpack:///D:\\学习\\webGlobe2/node_modules\\es6-promise\\dist\\es6-promise.auto.min.js","webpack:///D:\\学习\\webGlobe2/node_modules\\webpack\\buildin\\global.js","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Globe.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Renderer.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Camera.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Events.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\math\\Plan.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\Scene.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\EventHandler.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\Google.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\materials\\TileMaterial.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\geometries\\TileGeometry.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\Autonavi.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\Atmosphere.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\geometries\\Atmosphere.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\images\\atmosphere.png","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\LocationGraphic.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\images\\location.png","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\PoiLayer.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\images\\icons.png","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\layers\\RouteLayer.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\graphics\\MeshColorGraphic.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\materials\\ColorMaterial.ts","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\images\\start.png","webpack:///D:\\学习\\webGlobe2\\src\\core\\world\\images\\end.png","webpack:///D:\\学习\\webGlobe2\\src\\core\\index.ts"],"names":["process","module","exports","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","Error","defaultClearTimeout","setTimeout","e","clearTimeout","runTimeout","fun","call","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","length","concat","drainQueue","timeout","len","run","nextTick","args","Array","arguments","i","push","Item","array","prototype","apply","title","browser","env","argv","version","versions","noop","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","name","binding","cwd","chdir","dir","umask","t","define","ES6Promise","n","B","r","G","o","a","z","c","s","J","document","createTextNode","observe","characterData","data","u","MessageChannel","port1","onmessage","port2","postMessage","W","V","f","Function","require","runOnLoop","runOnContext","l","constructor","p","Z","O","_state","P","_result","E","h","g","v","TypeError","d","_","then","nt","error","y","m","S","j","_label","b","tt","et","w","resolve","A","_onerror","T","$","_subscribers","M","x","C","rt","k","F","ot","promise","Y","U","q","D","K","L","global","self","Promise","Object","toString","cast","it","N","isArray","X","H","window","I","MutationObserver","WebKitMutationObserver","Q","R","Uint8ClampedArray","importScripts","Math","random","substring","_instanceConstructor","_remaining","_enumerate","_eachEntry","_settledAt","_willSettleAt","all","race","reject","_setScheduler","_setAsap","_asap","polyfill","eval"],"mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mCAAmC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,cAAc;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;ACrnBa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;AClHa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACvBa;AACb,8CAA8C,cAAc;AAC5D,gBAAgB,mBAAO,CAAC,EAAW;AACnC;AACA;AACA,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC,2BAA2B,OAAO;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;;ACvHa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;;ACxFa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,YAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,YAAY;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,sBAAsB;AAC5D;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,sBAAsB;AAC5D;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;;;ACvJa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,iBAAiB,mBAAO,CAAC,EAAY;AACrC,cAAc,mBAAO,CAAC,EAAU;AAChC;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AClGa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,iBAAiB,mBAAO,CAAC,EAAY;AACrC,iBAAiB,mBAAO,CAAC,EAAa;AACtC,2BAA2B,mBAAO,CAAC,EAAuB;AAC1D,gBAAgB,mBAAO,CAAC,EAAiB;AACzC,cAAc,mBAAO,CAAC,CAAe;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,cAAc;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,WAAW;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,2DAA2D,YAAY;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC/Oa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;;ACtBa;AACb,8CAA8C,cAAc;AAC5D,cAAc,mBAAO,CAAC,CAAc;AACpC;AACA;AACA;AACA;AACA,iCAAiC,cAAc;AAC/C,+CAA+C,8BAA8B;AAC7E,wCAAwC,uBAAuB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,sCAAsC,sBAAsB;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,oBAAoB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,oCAAoC,qBAAqB;AACzD,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,oCAAoC,qBAAqB;AACzD,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA,oCAAoC,qBAAqB;AACzD,sCAAsC,sBAAsB;AAC5D,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,oCAAoC,qBAAqB;AACzD,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,kCAAkC,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,uCAAuC,EAAE;AACrG;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;;;;;;;;;;;ACtiBa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC,cAAc,mBAAO,CAAC,CAAc;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,+EAA+E;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;AC1La;AACb,8CAA8C,cAAc;AAC5D,cAAc,mBAAO,CAAC,CAAU;AAChC,gBAAgB,mBAAO,CAAC,EAAW;AACnC,eAAe,mBAAO,CAAC,EAAU;AACjC;AACA;AACA,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC,6BAA6B,SAAS;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,YAAY;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC3Ya;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA,cAAc;AACd;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC3Ba;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,eAAe,mBAAO,CAAC,EAAW;AAClC,cAAc,mBAAO,CAAC,CAAe;AACrC,2BAA2B,mBAAO,CAAC,EAAgC;AACnE,qBAAqB,mBAAO,CAAC,EAA2B;AACxD,qBAAqB,mBAAO,CAAC,EAA4B;AACzD,oBAAoB,mBAAO,CAAC,EAA2B;AACvD,iBAAiB,mBAAO,CAAC,EAAwB;AACjD,iBAAiB,mBAAO,CAAC,EAAa;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,mBAAmB;AACtC,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,mBAAmB,kBAAkB;AACrC,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC7Ja;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,gBAAgB,mBAAO,CAAC,EAAY;AACpC,gBAAgB,mBAAO,CAAC,EAAW;AACnC,qCAAqC,qBAAqB,mBAAmB,0BAA0B,kBAAkB,mDAAmD,cAAc,GAAG;AAC7L,oCAAoC,mBAAmB,6BAA6B,kBAAkB,2DAA2D,GAAG;AACpK;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AClFa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AClJa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC;AACA;AACA,kCAAkC,iBAAiB;AACnD,kCAAkC,iBAAiB;AACnD,oCAAoC,mBAAmB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;AC5Ca;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;;;;;;;;;;;;ACjBa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACxBa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,EAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC9Fa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,cAAc,mBAAO,CAAC,CAAU;AAChC,aAAa,mBAAO,CAAC,EAAkB;AACvC,qBAAqB,mBAAO,CAAC,EAAiB;AAC9C,sBAAsB,mBAAO,CAAC,EAAiB;AAC/C;AACA;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,eAAe;AAC7C;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,0BAA0B,mBAAmB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AClNa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;ACPa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC7Ca;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,EAAW;AAClC,iBAAiB,mBAAO,CAAC,EAAa;AACtC,qBAAqB,mBAAO,CAAC,EAAiB;AAC9C,aAAa,mBAAO,CAAC,EAAkB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,YAAY;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,sBAAsB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,yBAAyB,EAAE;AAC7E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACrJa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,aAAa,mBAAO,CAAC,EAAkB;AACvC,sBAAsB,mBAAO,CAAC,EAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0EAA0E,yCAAyC,EAAE;AACrH;AACA;AACA;AACA,CAAC;AACD;;;;;;;;ACjDa;AACb,8CAA8C,cAAc;AAC5D;;;;;;;;ACFa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,yBAAyB;AACxD;AACA;AACA;AACA,kCAAkC,4BAA4B;AAC9D,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,mBAAmB,EAAE;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,gCAAgC,EAAE;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACxWa;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,wBAAwB;AACnD;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC7Ga;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAU;AACjC,cAAc,mBAAO,CAAC,CAAS;AAC/B,eAAe,mBAAO,CAAC,EAAU;AACjC,cAAc,mBAAO,CAAC,CAAc;AACpC,gBAAgB,mBAAO,CAAC,EAAgB;AACxC,eAAe,mBAAO,CAAC,EAAe;AACtC,aAAa,mBAAO,CAAC,EAAa;AAClC,iBAAiB,mBAAO,CAAC,EAAY;AACrC,eAAe,mBAAO,CAAC,EAAe;AACtC,iBAAiB,mBAAO,CAAC,EAAY;AACrC,eAAe,mBAAO,CAAC,EAAU;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,mBAAmB,iCAAiC;AACpD;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,6BAA6B,UAAU;AACvC,gCAAgC,YAAY;AAC5C,8BAA8B,UAAU;AACxC,6BAA6B,WAAW;AACxC,+BAA+B,WAAW;AAC1C,gCAAgC,iBAAiB;AACjD,0CAA0C,2CAA2C;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,8BAA8B;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,eAAe;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,wBAAwB;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4BAA4B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4BAA4B;AAC9D,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,6CAA6C;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,cAAc;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,cAAc;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,aAAa;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;;;;;;;AC/qCa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,uDAAuD;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACnDa;AACb,8CAA8C,cAAc;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AChBa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,qBAAqB,mBAAO,CAAC,EAAgB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,QAAQ;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACnCa;AACb,8CAA8C,cAAc;AAC5D,cAAc,mBAAO,CAAC,CAAS;AAC/B,cAAc,mBAAO,CAAC,CAAc;AACpC,eAAe,mBAAO,CAAC,EAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACxUa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,EAAc;AACzC,mBAAmB,mBAAO,CAAC,EAAc;AACzC,YAAY,mBAAO,CAAC,EAAQ;AAC5B;AACA;AACA;AACA;AACA,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC9Ea;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,4BAA4B,mBAAO,CAAC,EAAuB;AAC3D,cAAc,mBAAO,CAAC,EAAU;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC9Ba;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,aAAa,mBAAO,CAAC,EAAQ;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;ACxBa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,mBAAmB,mBAAO,CAAC,EAAc;AACzC,mBAAmB,mBAAO,CAAC,EAAc;AACzC;AACA;AACA;AACA,+BAA+B,mBAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AChEa;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,2BAA2B,mBAAO,CAAC,EAAsB;AACzD,mBAAmB,mBAAO,CAAC,EAA0B;AACrD,4BAA4B,mBAAO,CAAC,EAAkC;AACtE,eAAe,mBAAO,CAAC,EAAgB;AACvC,uBAAuB,mBAAO,CAAC,EAA0B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC7Da;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,oBAAoB,mBAAO,CAAC,EAAe;AAC3C,iBAAiB,mBAAO,CAAC,EAAY;AACrC,aAAa,mBAAO,CAAC,EAAQ;AAC7B,gBAAgB,mBAAO,CAAC,EAAiB;AACzC,eAAe,mBAAO,CAAC,EAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;ACvEA,iBAAiB,qBAAuB,0C;;;;;;;ACA3B;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,2BAA2B,mBAAO,CAAC,EAAgC;AACnE,8BAA8B,mBAAO,CAAC,EAAoC;AAC1E,uBAAuB,mBAAO,CAAC,EAAwB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;ACvCA,iBAAiB,qBAAuB,0C;;;;;;;ACA3B;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,cAAc,mBAAO,CAAC,CAAU;AAChC,cAAc,mBAAO,CAAC,CAAe;AACrC,eAAe,mBAAO,CAAC,EAAgB;AACvC,oBAAoB,mBAAO,CAAC,EAA2B;AACvD,aAAa,mBAAO,CAAC,EAAoB;AACzC,2BAA2B,mBAAO,CAAC,EAAgC;AACnE,qBAAqB,mBAAO,CAAC,EAAiB;AAC9C,4BAA4B,mBAAO,CAAC,EAAkC;AACtE,gBAAgB,mBAAO,CAAC,EAAY;AACpC,eAAe,mBAAO,CAAC,EAAW;AAClC,gBAAgB,mBAAO,CAAC,EAAqB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,oCAAoC,qBAAqB;AACzD,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,oCAAoC,qBAAqB;AACzD,sCAAsC,mBAAmB;AACzD,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,CAAC;AACD;AACA;;;;;;;ACtRA,iBAAiB,qBAAuB,0C;;;;;;;ACA3B;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,cAAc,mBAAO,CAAC,CAAU;AAChC,cAAc,mBAAO,CAAC,CAAe;AACrC,gBAAgB,mBAAO,CAAC,EAAiB;AACzC,eAAe,mBAAO,CAAC,EAAgB;AACvC,oBAAoB,mBAAO,CAAC,EAA2B;AACvD,aAAa,mBAAO,CAAC,EAAoB;AACzC,yBAAyB,mBAAO,CAAC,GAA8B;AAC/D,sBAAsB,mBAAO,CAAC,GAA4B;AAC1D,8BAA8B,mBAAO,CAAC,EAAoC;AAC1E,2BAA2B,mBAAO,CAAC,EAAgC;AACnE,qBAAqB,mBAAO,CAAC,EAAiB;AAC9C,gBAAgB,mBAAO,CAAC,EAAY;AACpC,eAAe,mBAAO,CAAC,EAAW;AAClC,yBAAyB,mBAAO,CAAC,GAAqB;AACtD;AACA,uBAAuB,mBAAO,CAAC,GAAmB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA,SAAS;AACT;AACA;AACA;AACA,oCAAoC,gBAAgB;AACpD,kCAAkC,gBAAgB;AAClD,6BAA6B,mBAAmB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,cAAc;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,cAAc;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC/Za;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAW;AAClC,gBAAgB,mBAAO,CAAC,EAAY;AACpC,gBAAgB,mBAAO,CAAC,EAAW;AACnC,qCAAqC,wBAAwB,sBAAsB,0BAA0B,kBAAkB,mDAAmD,8BAA8B,GAAG;AACnN,oCAAoC,sBAAsB,kBAAkB,0BAA0B,GAAG;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;;AC1Ea;AACb;AACA;AACA,UAAU,gBAAgB,sCAAsC,iBAAiB,EAAE;AACnF,yBAAyB,uDAAuD;AAChF;AACA;AACA,uBAAuB,sBAAsB;AAC7C;AACA;AACA,CAAC;AACD,8CAA8C,cAAc;AAC5D,iBAAiB,mBAAO,CAAC,EAAY;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;;;;;;;AC7BA,iBAAiB,qBAAuB,0C;;;;;;ACAxC,iBAAiB,qBAAuB,0C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACA3B;AACb,8CAA8C,cAAc;AAC5D,eAAe,mBAAO,CAAC,CAAgB;AACvC;AACA,cAAc,mBAAO,CAAC,EAAe;AACrC;AACA","file":"index.842316328de347a542fe.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"WebGlobe\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"WebGlobe\"] = factory();\n\telse\n\t\troot[\"WebGlobe\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 178);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5a8d08496892d4cef3c6","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/process/browser.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar REAL_EARTH_RADIUS = 6378137;\r\nvar EARTH_RADIUS = 500;\r\nvar SCALE_FACTOR = EARTH_RADIUS / REAL_EARTH_RADIUS;\r\nvar MAX_PROJECTED_COORD = Math.PI * EARTH_RADIUS;\r\nvar MAX_REAL_RESOLUTION = 156543.03392800014;\r\nvar MAX_RESOLUTION = MAX_REAL_RESOLUTION * SCALE_FACTOR;\r\nvar Kernel = (function () {\r\n    function Kernel() {\r\n    }\r\n    Kernel.gl = null;\r\n    Kernel.idCounter = 0;\r\n    Kernel.version = \"0.6.3\";\r\n    Kernel.SCALE_FACTOR = SCALE_FACTOR;\r\n    Kernel.REAL_EARTH_RADIUS = REAL_EARTH_RADIUS;\r\n    Kernel.EARTH_RADIUS = EARTH_RADIUS;\r\n    Kernel.MAX_RESOLUTION = MAX_RESOLUTION;\r\n    Kernel.MAX_REAL_RESOLUTION = MAX_REAL_RESOLUTION;\r\n    Kernel.MAX_PROJECTED_COORD = MAX_PROJECTED_COORD;\r\n    Kernel.BASE_LEVEL = 6;\r\n    Kernel.MAX_LEVEL = 18;\r\n    Kernel.MIN_LEVEL = 2;\r\n    Kernel.MIN_PITCH_LEVEL = 8;\r\n    Kernel.proxy = \"\";\r\n    return Kernel;\r\n}());\r\nexports.default = Kernel;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Kernel.ts\n// module id = 1\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Utils_1 = require(\"../Utils\");\r\nvar Vertice_1 = require(\"./Vertice\");\r\nvar Vector_1 = require(\"./Vector\");\r\nvar Line_1 = require(\"./Line\");\r\nvar Plan_1 = require(\"./Plan\");\r\nif (!Math.log2) {\r\n    Math.log2 = function (value) { return (Math.log(value) / Math.log(2)); };\r\n}\r\nvar pow2Cache = {};\r\n(function (cache) {\r\n    cache[0] = 1;\r\n    for (var i = 1; i <= 20; i++) {\r\n        cache[i] = cache[i - 1] << 1;\r\n        cache[-i] = 1 / cache[i];\r\n    }\r\n})(pow2Cache);\r\nvar ONE_RADIAN_EQUAL_DEGREE = 57.29577951308232;\r\nvar ONE_DEGREE_EQUAL_RADIAN = 0.017453292519943295;\r\nvar MathUtils = (function () {\r\n    function MathUtils() {\r\n    }\r\n    MathUtils.getRealValueInWorld = function (virtualValue) {\r\n        return virtualValue / Kernel_1.default.SCALE_FACTOR;\r\n    };\r\n    MathUtils.pow2 = function (v) {\r\n        var s = v.toString();\r\n        if (pow2Cache.hasOwnProperty(s)) {\r\n            return pow2Cache[s];\r\n        }\r\n        else {\r\n            return Math.pow(2, v);\r\n        }\r\n    };\r\n    MathUtils.log2 = function (value) {\r\n        return Math.log2(value);\r\n    };\r\n    MathUtils.izZero = function (value) {\r\n        if (!Utils_1.default.isNumber(value)) {\r\n            throw \"invalid value\";\r\n        }\r\n        return Math.abs(value) < 0.000001;\r\n    };\r\n    MathUtils.isPowerOfTwo = function (value) {\r\n        return (value & (value - 1)) === 0 && value !== 0;\r\n    };\r\n    MathUtils.asinSafely = function (value) {\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        if (value < -1) {\r\n            value = -1;\r\n        }\r\n        return Math.asin(value);\r\n    };\r\n    MathUtils.acosSafely = function (value) {\r\n        if (value > 1) {\r\n            value = 1;\r\n        }\r\n        if (value < -1) {\r\n            value = -1;\r\n        }\r\n        return Math.acos(value);\r\n    };\r\n    MathUtils.numerationSystemTo10 = function (numSys, strNum) {\r\n        var sum = 0;\r\n        for (var i = 0; i < strNum.length; i++) {\r\n            var level = strNum.length - 1 - i;\r\n            var key = parseInt(strNum[i]);\r\n            sum += key * Math.pow(numSys, level);\r\n        }\r\n        return sum;\r\n    };\r\n    MathUtils.numerationSystemFrom10 = function (numSys, num) {\r\n        return num.toString(numSys);\r\n    };\r\n    MathUtils.numerationSystemChange = function (numSysFrom, numSysTo, strNumFrom) {\r\n        var temp10 = this.numerationSystemTo10(numSysFrom, strNumFrom);\r\n        var strResult = this.numerationSystemFrom10(numSysTo, temp10);\r\n        return strResult;\r\n    };\r\n    MathUtils.getTriangleArea = function (v1, v2, v3) {\r\n        var v1Copy = v1.clone();\r\n        var v2Copy = v2.clone();\r\n        var v3Copy = v3.clone();\r\n        var direction = Vector_1.default.verticeMinusVertice(v3Copy, v2Copy);\r\n        var line = new Line_1.default(v2Copy, direction);\r\n        var h = this.getLengthFromVerticeToLine(v1Copy, line);\r\n        var w = this.getLengthFromVerticeToVertice(v2Copy, v3Copy);\r\n        var area = 0.5 * w * h;\r\n        return area;\r\n    };\r\n    MathUtils.getLengthFromVerticeToVertice = function (vertice1, vertice2) {\r\n        var vertice1Copy = vertice1.clone();\r\n        var vertice2Copy = vertice2.clone();\r\n        var length2 = Math.pow(vertice1Copy.x - vertice2Copy.x, 2) + Math.pow(vertice1Copy.y - vertice2Copy.y, 2) + Math.pow(vertice1Copy.z - vertice2Copy.z, 2);\r\n        var length = Math.sqrt(length2);\r\n        return length;\r\n    };\r\n    MathUtils.getLengthFromVerticeToLine = function (vertice, line) {\r\n        var verticeCopy = vertice.clone();\r\n        var lineCopy = line.clone();\r\n        var x0 = verticeCopy.x;\r\n        var y0 = verticeCopy.y;\r\n        var z0 = verticeCopy.z;\r\n        var verticeOnLine = lineCopy.vertice;\r\n        var x1 = verticeOnLine.x;\r\n        var y1 = verticeOnLine.y;\r\n        var z1 = verticeOnLine.z;\r\n        var lineVector = lineCopy.vector;\r\n        lineVector.normalize();\r\n        var a = lineVector.x;\r\n        var b = lineVector.y;\r\n        var c = lineVector.z;\r\n        var A = (y0 - y1) * c - b * (z0 - z1);\r\n        var B = (z0 - z1) * a - c * (x0 - x1);\r\n        var C = (x0 - x1) * b - a * (y0 - y1);\r\n        return Math.sqrt(A * A + B * B + C * C);\r\n    };\r\n    MathUtils.getLengthFromVerticeToPlan = function (vertice, plan) {\r\n        var verticeCopy = vertice.clone();\r\n        var planCopy = plan.clone();\r\n        var x = verticeCopy.x;\r\n        var y = verticeCopy.y;\r\n        var z = verticeCopy.z;\r\n        var A = planCopy.A;\r\n        var B = planCopy.B;\r\n        var C = planCopy.C;\r\n        var D = planCopy.D;\r\n        var numerator = Math.abs(A * x + B * y + C * z + D);\r\n        var denominator = Math.sqrt(A * A + B * B + C * C);\r\n        var length = numerator / denominator;\r\n        return length;\r\n    };\r\n    MathUtils.getVerticeVerticalIntersectPointWidthPlan = function (vertice, plan) {\r\n        var verticeCopy = vertice.clone();\r\n        var planCopy = plan.clone();\r\n        var x0 = verticeCopy.x;\r\n        var y0 = verticeCopy.y;\r\n        var z0 = verticeCopy.z;\r\n        var normalVector = new Vector_1.default(planCopy.A, planCopy.B, planCopy.C);\r\n        normalVector.normalize();\r\n        var a = normalVector.x;\r\n        var b = normalVector.y;\r\n        var c = normalVector.z;\r\n        var d = planCopy.D * a / planCopy.A;\r\n        var k = -(a * x0 + b * y0 + c * z0 + d);\r\n        var x = k * a + x0;\r\n        var y = k * b + y0;\r\n        var z = k * c + z0;\r\n        var intersectVertice = new Vertice_1.default(x, y, z);\r\n        return intersectVertice;\r\n    };\r\n    MathUtils.getIntersectPointByLineAdPlan = function (line, plan) {\r\n        var lineCopy = line.clone();\r\n        var planCopy = plan.clone();\r\n        lineCopy.vector.normalize();\r\n        var A = planCopy.A;\r\n        var B = planCopy.B;\r\n        var C = planCopy.C;\r\n        var D = planCopy.D;\r\n        var x0 = lineCopy.vertice.x;\r\n        var y0 = lineCopy.vertice.y;\r\n        var z0 = lineCopy.vertice.z;\r\n        var a = lineCopy.vector.x;\r\n        var b = lineCopy.vector.y;\r\n        var c = lineCopy.vector.z;\r\n        var k = -(A * x0 + B * y0 + C * z0 + D) / (A * a + B * b + C * c);\r\n        var x = k * a + x0;\r\n        var y = k * b + y0;\r\n        var z = k * c + z0;\r\n        var intersectVertice = new Vertice_1.default(x, y, z);\r\n        return intersectVertice;\r\n    };\r\n    MathUtils.getLineIntersectPointWithEarth = function (line) {\r\n        var result = [];\r\n        var lineCopy = line.clone();\r\n        var vertice = lineCopy.vertice;\r\n        var direction = lineCopy.vector;\r\n        direction.normalize();\r\n        var r = Kernel_1.default.EARTH_RADIUS;\r\n        var a = direction.x;\r\n        var b = direction.y;\r\n        var c = direction.z;\r\n        var x0 = vertice.x;\r\n        var y0 = vertice.y;\r\n        var z0 = vertice.z;\r\n        var a2 = a * a;\r\n        var b2 = b * b;\r\n        var c2 = c * c;\r\n        var r2 = r * r;\r\n        var ay0 = a * y0;\r\n        var az0 = a * z0;\r\n        var bx0 = b * x0;\r\n        var bz0 = b * z0;\r\n        var cx0 = c * x0;\r\n        var cy0 = c * y0;\r\n        var deltaA = ay0 * bx0 + az0 * cx0 + bz0 * cy0;\r\n        var deltaB = ay0 * ay0 + az0 * az0 + bx0 * bx0 + bz0 * bz0 + cx0 * cx0 + cy0 * cy0;\r\n        var deltaC = a2 + b2 + c2;\r\n        var delta = 8 * deltaA - 4 * deltaB + 4 * r2 * deltaC;\r\n        if (delta < 0) {\r\n            result = [];\r\n        }\r\n        else {\r\n            var t = a * x0 + b * y0 + c * z0;\r\n            var A = a2 + b2 + c2;\r\n            if (delta == 0) {\r\n                var k = -t / A;\r\n                var x = k * a + x0;\r\n                var y = k * b + y0;\r\n                var z = k * c + z0;\r\n                var p = new Vertice_1.default(x, y, z);\r\n                result.push(p);\r\n            }\r\n            else if (delta > 0) {\r\n                var sqrtDelta = Math.sqrt(delta);\r\n                var k1 = (-2 * t + sqrtDelta) / (2 * A);\r\n                var x1 = k1 * a + x0;\r\n                var y1 = k1 * b + y0;\r\n                var z1 = k1 * c + z0;\r\n                var p1 = new Vertice_1.default(x1, y1, z1);\r\n                result.push(p1);\r\n                var k2 = (-2 * t - sqrtDelta) / (2 * A);\r\n                var x2 = k2 * a + x0;\r\n                var y2 = k2 * b + y0;\r\n                var z2 = k2 * c + z0;\r\n                var p2 = new Vertice_1.default(x2, y2, z2);\r\n                result.push(p2);\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    MathUtils.getCrossPlaneByLine = function (vertice, direction) {\r\n        var verticeCopy = vertice.clone();\r\n        var directionCopy = direction.clone();\r\n        directionCopy.normalize();\r\n        var a = directionCopy.x;\r\n        var b = directionCopy.y;\r\n        var c = directionCopy.z;\r\n        var x0 = verticeCopy.x;\r\n        var y0 = verticeCopy.y;\r\n        var z0 = verticeCopy.z;\r\n        var d = -(a * x0 + b * y0 + c * z0);\r\n        var plan = new Plan_1.default(a, b, c, d);\r\n        return plan;\r\n    };\r\n    MathUtils.convertPointFromCanvasToNDC = function (canvasWidth, canvasHeight, canvasX, canvasY) {\r\n        if (!(Utils_1.default.isNumber(canvasX))) {\r\n            throw \"invalid canvasX\";\r\n        }\r\n        if (!(Utils_1.default.isNumber(canvasY))) {\r\n            throw \"invalid canvasY\";\r\n        }\r\n        var ndcX = 2 * canvasX / canvasWidth - 1;\r\n        var ndcY = 1 - 2 * canvasY / canvasHeight;\r\n        return [ndcX, ndcY];\r\n    };\r\n    MathUtils.convertPointFromNdcToCanvas = function (canvasWidth, canvasHeight, ndcX, ndcY) {\r\n        if (!(Utils_1.default.isNumber(ndcX))) {\r\n            throw \"invalid ndcX\";\r\n        }\r\n        if (!(Utils_1.default.isNumber(ndcY))) {\r\n            throw \"invalid ndcY\";\r\n        }\r\n        var canvasX = (1 + ndcX) * canvasWidth / 2.0;\r\n        var canvasY = (1 - ndcY) * canvasHeight / 2.0;\r\n        return [canvasX, canvasY];\r\n    };\r\n    MathUtils.geographicToCartesianCoord = function (lon, lat, r) {\r\n        if (r === void 0) { r = Kernel_1.default.EARTH_RADIUS; }\r\n        if (!(lon >= -(180 + 0.001) && lon <= (180 + 0.001))) {\r\n            throw \"invalid lon\";\r\n        }\r\n        if (!(lat >= -(90 + 0.001) && lat <= (90 + 0.001))) {\r\n            throw \"invalid lat\";\r\n        }\r\n        var radianLon = this.degreeToRadian(lon);\r\n        var radianLat = this.degreeToRadian(lat);\r\n        var sin1 = Math.sin(radianLon);\r\n        var cos1 = Math.cos(radianLon);\r\n        var sin2 = Math.sin(radianLat);\r\n        var cos2 = Math.cos(radianLat);\r\n        var x = r * sin1 * cos2;\r\n        var y = r * sin2;\r\n        var z = r * cos1 * cos2;\r\n        return new Vertice_1.default(x, y, z);\r\n    };\r\n    MathUtils.cartesianCoordToGeographic = function (vertice) {\r\n        var verticeCopy = vertice.clone();\r\n        var x = verticeCopy.x;\r\n        var y = verticeCopy.y;\r\n        var z = verticeCopy.z;\r\n        var sin2 = y / Kernel_1.default.EARTH_RADIUS;\r\n        var radianLat = this.asinSafely(sin2);\r\n        var cos2 = Math.cos(radianLat);\r\n        var sin1 = x / (Kernel_1.default.EARTH_RADIUS * cos2);\r\n        if (sin1 > 1) {\r\n            sin1 = 1;\r\n        }\r\n        if (sin1 < -1) {\r\n            sin1 = -1;\r\n        }\r\n        var cos1 = z / (Kernel_1.default.EARTH_RADIUS * cos2);\r\n        if (cos1 > 1) {\r\n            cos1 = 1;\r\n        }\r\n        if (cos1 < -1) {\r\n            cos1 = -1;\r\n        }\r\n        var radianLog = this.asinSafely(sin1);\r\n        if (sin1 >= 0) {\r\n            if (cos1 >= 0) {\r\n                radianLog = radianLog;\r\n            }\r\n            else {\r\n                radianLog = Math.PI - radianLog;\r\n            }\r\n        }\r\n        else {\r\n            if (cos1 >= 0) {\r\n                radianLog = radianLog;\r\n            }\r\n            else {\r\n                radianLog = -radianLog - Math.PI;\r\n            }\r\n        }\r\n        var degreeLat = this.radianToDegree(radianLat);\r\n        var degreeLog = this.radianToDegree(radianLog);\r\n        return [degreeLog, degreeLat];\r\n    };\r\n    MathUtils.degreeToRadian = function (degree) {\r\n        return degree * ONE_DEGREE_EQUAL_RADIAN;\r\n    };\r\n    MathUtils.radianToDegree = function (radian) {\r\n        return radian * ONE_RADIAN_EQUAL_DEGREE;\r\n    };\r\n    MathUtils.getRealArcDistanceBetweenLonLats = function (lon1, lat1, lon2, lat2) {\r\n        var φ1 = this.degreeToRadian(lat1);\r\n        var φ2 = this.degreeToRadian(lat2);\r\n        var Δφ = φ2 - φ1;\r\n        var Δλ = this.degreeToRadian(lon2 - lon1);\r\n        var a = Math.sin(Δφ / 2);\r\n        var b = Math.sin(Δλ / 2);\r\n        var c = a * a + Math.cos(φ1) * Math.cos(φ2) * b * b;\r\n        var d = 2 * Math.atan2(Math.sqrt(c), Math.sqrt(1 - c));\r\n        var distance = Kernel_1.default.REAL_EARTH_RADIUS * d;\r\n        return distance;\r\n    };\r\n    MathUtils.webMercatorXToRadianLon = function (x) {\r\n        return x / Kernel_1.default.EARTH_RADIUS;\r\n    };\r\n    MathUtils.webMercatorXToDegreeLon = function (x) {\r\n        var radianLog = this.webMercatorXToRadianLon(x);\r\n        return this.radianToDegree(radianLog);\r\n    };\r\n    MathUtils.webMercatorYToRadianLat = function (y) {\r\n        if (!(Utils_1.default.isNumber(y))) {\r\n            throw \"invalid y\";\r\n        }\r\n        var a = y / Kernel_1.default.EARTH_RADIUS;\r\n        var b = Math.pow(Math.E, a);\r\n        var c = Math.atan(b);\r\n        var radianLat = 2 * c - Math.PI / 2;\r\n        return radianLat;\r\n    };\r\n    MathUtils.webMercatorYToDegreeLat = function (y) {\r\n        var radianLat = this.webMercatorYToRadianLat(y);\r\n        return this.radianToDegree(radianLat);\r\n    };\r\n    MathUtils.webMercatorToRadianGeographic = function (x, y) {\r\n        var radianLog = this.webMercatorXToRadianLon(x);\r\n        var radianLat = this.webMercatorYToRadianLat(y);\r\n        return [radianLog, radianLat];\r\n    };\r\n    MathUtils.webMercatorToDegreeGeographic = function (x, y) {\r\n        var degreeLog = this.webMercatorXToDegreeLon(x);\r\n        var degreeLat = this.webMercatorYToDegreeLat(y);\r\n        return [degreeLog, degreeLat];\r\n    };\r\n    MathUtils.radianLonToWebMercatorX = function (radianLog, real) {\r\n        if (real === void 0) { real = false; }\r\n        if (!(Utils_1.default.isNumber(radianLog) && radianLog <= (Math.PI + 0.001) && radianLog >= -(Math.PI + 0.001))) {\r\n            throw \"invalid radianLog\";\r\n        }\r\n        if (real) {\r\n            return Kernel_1.default.REAL_EARTH_RADIUS * radianLog;\r\n        }\r\n        else {\r\n            return Kernel_1.default.EARTH_RADIUS * radianLog;\r\n        }\r\n    };\r\n    MathUtils.degreeLonToWebMercatorX = function (degreeLog, real) {\r\n        if (real === void 0) { real = false; }\r\n        if (!(Utils_1.default.isNumber(degreeLog) && degreeLog <= (180 + 0.001) && degreeLog >= -(180 + 0.001))) {\r\n            throw \"invalid degreeLog\";\r\n        }\r\n        var radianLog = this.degreeToRadian(degreeLog);\r\n        return this.radianLonToWebMercatorX(radianLog, real);\r\n    };\r\n    MathUtils.radianLatToWebMercatorY = function (radianLat, real) {\r\n        if (real === void 0) { real = false; }\r\n        if (!(radianLat <= (Math.PI / 2 + 0.001) && radianLat >= -(Math.PI / 2 + 0.001))) {\r\n            throw \"invalid radianLat\";\r\n        }\r\n        var a = Math.PI / 4 + radianLat / 2;\r\n        var b = Math.tan(a);\r\n        var c = Math.log(b);\r\n        if (real) {\r\n            return Kernel_1.default.REAL_EARTH_RADIUS * c;\r\n        }\r\n        else {\r\n            return Kernel_1.default.EARTH_RADIUS * c;\r\n        }\r\n    };\r\n    MathUtils.degreeLatToWebMercatorY = function (degreeLat, real) {\r\n        if (real === void 0) { real = false; }\r\n        if (!(degreeLat <= (90 + 0.001) && degreeLat >= -(90 + 0.001))) {\r\n            throw \"invalid degreeLat\";\r\n        }\r\n        var radianLat = this.degreeToRadian(degreeLat);\r\n        return this.radianLatToWebMercatorY(radianLat, real);\r\n    };\r\n    MathUtils.radianGeographicToWebMercator = function (radianLog, radianLat) {\r\n        var x = this.radianLonToWebMercatorX(radianLog);\r\n        var y = this.radianLatToWebMercatorY(radianLat);\r\n        return [x, y];\r\n    };\r\n    MathUtils.degreeGeographicToWebMercator = function (degreeLog, degreeLat) {\r\n        var x = this.degreeLonToWebMercatorX(degreeLog);\r\n        var y = this.degreeLatToWebMercatorY(degreeLat);\r\n        return [x, y];\r\n    };\r\n    MathUtils.getTileWebMercatorEnvelopeByGrid = function (level, row, column) {\r\n        var k = Kernel_1.default.MAX_PROJECTED_COORD;\r\n        var size = 2 * k / Math.pow(2, level);\r\n        var minX = -k + column * size;\r\n        var maxX = minX + size;\r\n        var maxY = k - row * size;\r\n        var minY = maxY - size;\r\n        var Eproj = {\r\n            \"minX\": minX,\r\n            \"minY\": minY,\r\n            \"maxX\": maxX,\r\n            \"maxY\": maxY\r\n        };\r\n        return Eproj;\r\n    };\r\n    MathUtils.getTileGeographicEnvelopByGrid = function (level, row, column) {\r\n        var Eproj = this.getTileWebMercatorEnvelopeByGrid(level, row, column);\r\n        var pMin = this.webMercatorToDegreeGeographic(Eproj.minX, Eproj.minY);\r\n        var pMax = this.webMercatorToDegreeGeographic(Eproj.maxX, Eproj.maxY);\r\n        var Egeo = {\r\n            \"minLon\": pMin[0],\r\n            \"minLat\": pMin[1],\r\n            \"maxLon\": pMax[0],\r\n            \"maxLat\": pMax[1]\r\n        };\r\n        return Egeo;\r\n    };\r\n    MathUtils.getTileCartesianEnvelopByGrid = function (level, row, column) {\r\n        var Egeo = this.getTileGeographicEnvelopByGrid(level, row, column);\r\n        var minLon = Egeo.minLon;\r\n        var minLat = Egeo.minLat;\r\n        var maxLon = Egeo.maxLon;\r\n        var maxLat = Egeo.maxLat;\r\n        var pLeftBottom = this.geographicToCartesianCoord(minLon, minLat);\r\n        var pLeftTop = this.geographicToCartesianCoord(minLon, maxLat);\r\n        var pRightTop = this.geographicToCartesianCoord(maxLon, maxLat);\r\n        var pRightBottom = this.geographicToCartesianCoord(maxLon, minLat);\r\n        var Ecar = {\r\n            \"pLeftBottom\": pLeftBottom,\r\n            \"pLeftTop\": pLeftTop,\r\n            \"pRightTop\": pRightTop,\r\n            \"pRightBottom\": pRightBottom,\r\n            \"minLon\": minLon,\r\n            \"minLat\": minLat,\r\n            \"maxLon\": maxLon,\r\n            \"maxLat\": maxLat\r\n        };\r\n        return Ecar;\r\n    };\r\n    MathUtils.getGeographicTileCenter = function (level, row, column) {\r\n        var Egeo = this.getTileGeographicEnvelopByGrid(level, row, column);\r\n        var minLon = Egeo.minLon;\r\n        var minLat = Egeo.minLat;\r\n        var maxLon = Egeo.maxLon;\r\n        var maxLat = Egeo.maxLat;\r\n        var centerLon = (minLon + maxLon) / 2;\r\n        var centerLat = (minLat + maxLat) / 2;\r\n        var lonlatTileCenter = [centerLon, centerLat];\r\n        return lonlatTileCenter;\r\n    };\r\n    MathUtils.getCartesianTileCenter = function (level, row, column) {\r\n        var lonLat = this.getGeographicTileCenter(level, row, column);\r\n        var vertice = this.geographicToCartesianCoord(lonLat[0], lonLat[1]);\r\n        return vertice;\r\n    };\r\n    MathUtils.quad = function (p0, p1, p2, count) {\r\n        var points = [];\r\n        for (var i = 0; i < count; i++) {\r\n            if (i === 0) {\r\n                points.push(p0);\r\n            }\r\n            else if (i === count - 1) {\r\n                points.push(p2);\r\n            }\r\n            else {\r\n                var t = i / count;\r\n                var a = (1 - t) * (1 - t);\r\n                var b = 2 * t * (1 - t);\r\n                var c = t * t;\r\n                var x = a * p0[0] + b * p1[0] + c * p2[0];\r\n                var y = a * p0[1] + b * p1[1] + c * p2[1];\r\n                points.push([x, y]);\r\n            }\r\n        }\r\n        return points;\r\n    };\r\n    MathUtils.calculateNormals = function (vs, ind) {\r\n        var x = 0;\r\n        var y = 1;\r\n        var z = 2;\r\n        var ns = [];\r\n        for (var i = 0; i < vs.length; i = i + 3) {\r\n            ns[i + x] = 0.0;\r\n            ns[i + y] = 0.0;\r\n            ns[i + z] = 0.0;\r\n        }\r\n        for (var i = 0; i < ind.length; i = i + 3) {\r\n            var v1 = [];\r\n            var v2 = [];\r\n            var normal = [];\r\n            v1[x] = vs[3 * ind[i + 2] + x] - vs[3 * ind[i + 1] + x];\r\n            v1[y] = vs[3 * ind[i + 2] + y] - vs[3 * ind[i + 1] + y];\r\n            v1[z] = vs[3 * ind[i + 2] + z] - vs[3 * ind[i + 1] + z];\r\n            v2[x] = vs[3 * ind[i] + x] - vs[3 * ind[i + 1] + x];\r\n            v2[y] = vs[3 * ind[i] + y] - vs[3 * ind[i + 1] + y];\r\n            v2[z] = vs[3 * ind[i] + z] - vs[3 * ind[i + 1] + z];\r\n            normal[x] = v1[y] * v2[z] - v1[z] * v2[y];\r\n            normal[y] = v1[z] * v2[x] - v1[x] * v2[z];\r\n            normal[z] = v1[x] * v2[y] - v1[y] * v2[x];\r\n            for (var j = 0; j < 3; j++) {\r\n                ns[3 * ind[i + j] + x] = ns[3 * ind[i + j] + x] + normal[x];\r\n                ns[3 * ind[i + j] + y] = ns[3 * ind[i + j] + y] + normal[y];\r\n                ns[3 * ind[i + j] + z] = ns[3 * ind[i + j] + z] + normal[z];\r\n            }\r\n        }\r\n        for (var i = 0; i < vs.length; i = i + 3) {\r\n            var nn = [];\r\n            nn[x] = ns[i + x];\r\n            nn[y] = ns[i + y];\r\n            nn[z] = ns[i + z];\r\n            var len = Math.sqrt((nn[x] * nn[x]) + (nn[y] * nn[y]) + (nn[z] * nn[z]));\r\n            if (len == 0)\r\n                len = 1.0;\r\n            nn[x] = nn[x] / len;\r\n            nn[y] = nn[y] / len;\r\n            nn[z] = nn[z] / len;\r\n            ns[i + x] = nn[x];\r\n            ns[i + y] = nn[y];\r\n            ns[i + z] = nn[z];\r\n        }\r\n        return ns;\r\n    };\r\n    MathUtils.intersectTriangle = function (orig, dir, v0, v1, v2) {\r\n        var t, u, v;\r\n        var E1 = Vector_1.default.verticeMinusVertice(v1, v0);\r\n        var E2 = Vector_1.default.verticeMinusVertice(v2, v0);\r\n        var P = dir.cross(E2);\r\n        var det = E1.dot(P);\r\n        var T = null;\r\n        if (det > 0) {\r\n            T = Vector_1.default.verticeMinusVertice(orig, v0);\r\n        }\r\n        else {\r\n            T = Vector_1.default.verticeMinusVertice(v0, orig);\r\n            det = -det;\r\n        }\r\n        if (det < 0.0001) {\r\n            return false;\r\n        }\r\n        u = T.dot(P);\r\n        if (u < 0 || u > det) {\r\n            return false;\r\n        }\r\n        var Q = T.cross(E1);\r\n        v = dir.dot(Q);\r\n        if (v < 0 || (u + v) > det) {\r\n            return false;\r\n        }\r\n        return true;\r\n    };\r\n    MathUtils.convertWorldVerticeToLocalVertice = function (worldVertice, localMatrix, inverseLocalMatrix) {\r\n        if (!inverseLocalMatrix) {\r\n            inverseLocalMatrix = localMatrix.getInverseMatrix();\r\n        }\r\n        var inputColumn = worldVertice.getArray();\r\n        inputColumn.push(1);\r\n        var column = inverseLocalMatrix.multiplyColumn(inputColumn);\r\n        var localVertice = new Vertice_1.default(column[0], column[1], column[2]);\r\n        return localVertice;\r\n    };\r\n    MathUtils.convertWorldVectorToLocalVector = function (worldVector, localMatrix, inverseLocalMatrix) {\r\n        if (!inverseLocalMatrix) {\r\n            inverseLocalMatrix = localMatrix.getInverseMatrix();\r\n        }\r\n        var worldVertice1 = new Vertice_1.default(0, 0, 0);\r\n        var worldVertice2 = worldVector.getVertice();\r\n        var localVertice1 = this.convertWorldVerticeToLocalVertice(worldVertice1, localMatrix, inverseLocalMatrix);\r\n        var localVertice2 = this.convertWorldVerticeToLocalVertice(worldVertice2, localMatrix, inverseLocalMatrix);\r\n        var localVector = Vector_1.default.verticeMinusVertice(localVertice2, localVertice1);\r\n        localVector.normalize();\r\n        return localVector;\r\n    };\r\n    MathUtils.convertWorldLineToLocalLine = function (worldLine, localMatrix, inverseLocalMatrix) {\r\n        if (!inverseLocalMatrix) {\r\n            inverseLocalMatrix = localMatrix.getInverseMatrix();\r\n        }\r\n        var localVertice = this.convertWorldVerticeToLocalVertice(worldLine.vertice, localMatrix, inverseLocalMatrix);\r\n        var localVector = this.convertWorldVectorToLocalVector(worldLine.vector, localMatrix, inverseLocalMatrix);\r\n        var localLine = new Line_1.default(localVertice, localVector);\r\n        return localLine;\r\n    };\r\n    return MathUtils;\r\n}());\r\nexports.default = MathUtils;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/math/Utils.ts\n// module id = 7\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar topic = {};\r\nvar Utils = (function () {\r\n    function Utils() {\r\n    }\r\n    Utils.isNumber = function (v) {\r\n        return typeof v === \"number\";\r\n    };\r\n    Utils.isInteger = function (v) {\r\n        var isInt = false;\r\n        var isNum = this.isNumber(v);\r\n        if (isNum) {\r\n            var numFloat = parseFloat(v);\r\n            var numInt = parseInt(v);\r\n            if (numFloat === numInt) {\r\n                isInt = true;\r\n            }\r\n            else {\r\n                isInt = false;\r\n            }\r\n        }\r\n        else {\r\n            isInt = false;\r\n        }\r\n        return isInt;\r\n    };\r\n    Utils.isPositive = function (v) {\r\n        return v > 0;\r\n    };\r\n    Utils.isNegative = function (v) {\r\n        return v < 0;\r\n    };\r\n    Utils.isNonNegative = function (v) {\r\n        return v >= 0;\r\n    };\r\n    Utils.isNonPositive = function (v) {\r\n        return v <= 0;\r\n    };\r\n    Utils.isPositiveInteger = function (v) {\r\n        return this.isPositive(v) && this.isInteger(v);\r\n    };\r\n    Utils.isNonNegativeInteger = function (v) {\r\n        return this.isNonNegative(v) && this.isInteger(v);\r\n    };\r\n    Utils.isArray = function (v) {\r\n        return Object.prototype.toString.call(v) === '[object Array]';\r\n    };\r\n    Utils.isFunction = function (v) {\r\n        return typeof v === 'function';\r\n    };\r\n    Utils.forEach = function (arr, func) {\r\n        return this.isFunction(arr.forEach) ? arr.forEach(func) : Array.prototype.forEach.call(arr, func);\r\n    };\r\n    Utils.filter = function (arr, func) {\r\n        return this.isFunction(arr.filter) ? arr.filter(func) : Array.prototype.filter.call(arr, func);\r\n    };\r\n    Utils.map = function (arr, func) {\r\n        return this.isFunction(arr.map) ? arr.map(func) : Array.prototype.map.call(arr, func);\r\n    };\r\n    Utils.some = function (arr, func) {\r\n        return this.isFunction(arr.some) ? arr.some(func) : Array.prototype.some.call(arr, func);\r\n    };\r\n    Utils.every = function (arr, func) {\r\n        return this.isFunction(arr.every) ? arr.every(func) : Array.prototype.every.call(arr, func);\r\n    };\r\n    Utils.filterRepeatArray = function (arr) {\r\n        var cloneArray = arr.map(function (item) {\r\n            return item;\r\n        });\r\n        var simplifyArray = [];\r\n        while (cloneArray.length > 0) {\r\n            var e = cloneArray[0];\r\n            var exist = simplifyArray.some(function (item) {\r\n                return e.equals(item);\r\n            });\r\n            if (!exist) {\r\n                simplifyArray.push(e);\r\n            }\r\n            cloneArray.splice(0, 1);\r\n        }\r\n        return simplifyArray;\r\n    };\r\n    Utils.isMobile = function () {\r\n        return !!window.navigator.userAgent.match(/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Opera Mini/i);\r\n    };\r\n    Utils.isWindows = function () {\r\n        var platform = window.navigator.platform;\r\n        return platform.toLowerCase().indexOf('win') === 0;\r\n    };\r\n    Utils.wrapUrlWithProxy = function (url) {\r\n        if (Kernel_1.default.proxy) {\r\n            return Kernel_1.default.proxy + \"?\" + url;\r\n        }\r\n        return url;\r\n    };\r\n    Utils.subscribe = function (topicName, callback) {\r\n        if (!topic[topicName]) {\r\n            topic[topicName] = [];\r\n        }\r\n        topic[topicName].push(callback);\r\n    };\r\n    Utils.publish = function (topicName, data) {\r\n        var callbacks = topic[topicName];\r\n        if (callbacks && callbacks.length > 0) {\r\n            callbacks.forEach(function (callback) {\r\n                callback(data);\r\n            });\r\n        }\r\n    };\r\n    return Utils;\r\n}());\r\nexports.default = Utils;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Utils.ts\n// module id = 9\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Vertice = (function () {\r\n    function Vertice(x, y, z) {\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        if (z === void 0) { z = 0; }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    Vertice.prototype.getArray = function () {\r\n        return [this.x, this.y, this.z];\r\n    };\r\n    Vertice.prototype.clone = function () {\r\n        return new Vertice(this.x, this.y, this.z);\r\n    };\r\n    Vertice.prototype.getOpposite = function () {\r\n        return new Vertice(-this.x, -this.y, -this.z);\r\n    };\r\n    return Vertice;\r\n}());\r\nexports.default = Vertice;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/math/Vertice.ts\n// module id = 11\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Vertice_1 = require(\"./Vertice\");\r\nvar Vector = (function () {\r\n    function Vector(x, y, z) {\r\n        if (x === void 0) { x = 0; }\r\n        if (y === void 0) { y = 0; }\r\n        if (z === void 0) { z = 0; }\r\n        this.x = x;\r\n        this.y = y;\r\n        this.z = z;\r\n    }\r\n    Vector.fromVertice = function (vertice) {\r\n        return new Vector(vertice.x, vertice.y, vertice.z);\r\n    };\r\n    Vector.verticeMinusVertice = function (endVertice, startVertice) {\r\n        return new Vector(endVertice.x - startVertice.x, endVertice.y - startVertice.y, endVertice.z - startVertice.z);\r\n    };\r\n    Vector.verticePlusVector = function (vertice, vector) {\r\n        return new Vertice_1.default(vertice.x + vector.x, vertice.y + vector.y, vertice.z + vector.z);\r\n    };\r\n    Vector.getRadianOfTwoVectors = function (vector1, vector2) {\r\n        if (vector1.isZeroLength() || vector2.isZeroLength()) {\r\n            return 0;\r\n        }\r\n        var v1 = vector1.clone().normalize();\r\n        var v2 = vector2.clone().normalize();\r\n        var dotValue = v1.dot(v2);\r\n        if (dotValue < -1) {\r\n            dotValue = -1;\r\n        }\r\n        if (dotValue > 1) {\r\n            dotValue = 1;\r\n        }\r\n        var radian = Math.acos(dotValue);\r\n        return radian;\r\n    };\r\n    Vector.prototype.getVertice = function () {\r\n        return new Vertice_1.default(this.x, this.y, this.z);\r\n    };\r\n    Vector.prototype.getArray = function () {\r\n        return [this.x, this.y, this.z];\r\n    };\r\n    Vector.prototype.clone = function () {\r\n        return new Vector(this.x, this.y, this.z);\r\n    };\r\n    Vector.prototype.getOpposite = function () {\r\n        return new Vector(-this.x, -this.y, -this.z);\r\n    };\r\n    Vector.prototype.getLength = function () {\r\n        return Math.sqrt(this.x * this.x + this.y * this.y + this.z * this.z);\r\n    };\r\n    Vector.prototype.isZeroLength = function () {\r\n        return this.x === 0 && this.y === 0 && this.z === 0;\r\n    };\r\n    Vector.prototype.normalize = function () {\r\n        var length = this.getLength();\r\n        if (Math.abs(length) >= 0.000001) {\r\n            this.x /= length;\r\n            this.y /= length;\r\n            this.z /= length;\r\n        }\r\n        else {\r\n            this.x = 0;\r\n            this.y = 0;\r\n            this.z = 0;\r\n        }\r\n        return this;\r\n    };\r\n    Vector.prototype.setLength = function (length) {\r\n        this.normalize();\r\n        this.x *= length;\r\n        this.y *= length;\r\n        this.z *= length;\r\n        return this;\r\n    };\r\n    Vector.prototype.getRandomVerticalVector = function () {\r\n        var result;\r\n        var length = this.getLength();\r\n        if (length === 0) {\r\n            result = new Vector(0, 0, 0);\r\n        }\r\n        else {\r\n            var x2, y2, z2;\r\n            if (this.x !== 0) {\r\n                y2 = 1;\r\n                z2 = 0;\r\n                x2 = -this.y / this.x;\r\n            }\r\n            else if (this.y !== 0) {\r\n                z2 = 1;\r\n                x2 = 0;\r\n                y2 = -this.z / this.y;\r\n            }\r\n            else if (this.z !== 0) {\r\n                x2 = 1;\r\n                y2 = 0;\r\n                z2 = -this.x / this.z;\r\n            }\r\n            result = new Vector(x2, y2, z2);\r\n            result.normalize();\r\n        }\r\n        return result;\r\n    };\r\n    Vector.prototype.cross = function (other) {\r\n        var x = this.y * other.z - this.z * other.y;\r\n        var y = this.z * other.x - this.x * other.z;\r\n        var z = this.x * other.y - this.y * other.x;\r\n        return new Vector(x, y, z);\r\n    };\r\n    Vector.prototype.dot = function (other) {\r\n        if (!(other instanceof Vector)) {\r\n            throw \"invalid other\";\r\n        }\r\n        return this.x * other.x + this.y * other.y + this.z * other.z;\r\n    };\r\n    return Vector;\r\n}());\r\nexports.default = Vector;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/math/Vector.ts\n// module id = 12\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Extent = (function () {\r\n    function Extent(minLon, minLat, maxLon, maxLat) {\r\n        this.minLon = minLon;\r\n        this.minLat = minLat;\r\n        this.maxLon = maxLon;\r\n        this.maxLat = maxLat;\r\n    }\r\n    Extent.prototype.clone = function () {\r\n        return new Extent(this.minLon, this.minLat, this.maxLon, this.maxLat);\r\n    };\r\n    Extent.prototype.getMinLon = function () {\r\n        return this.minLon;\r\n    };\r\n    Extent.prototype.getMinLat = function () {\r\n        return this.minLat;\r\n    };\r\n    Extent.prototype.getMaxLon = function () {\r\n        return this.maxLon;\r\n    };\r\n    Extent.prototype.getMaxLat = function () {\r\n        return this.maxLat;\r\n    };\r\n    Extent.prototype.toJson = function () {\r\n        return [this.minLon, this.minLat, this.maxLon, this.maxLat];\r\n    };\r\n    Extent.merge = function (extents, union) {\r\n        var result = null;\r\n        if (extents.length === 1) {\r\n            result = extents[0].clone();\r\n        }\r\n        else if (extents.length > 1) {\r\n            var minLons = [];\r\n            var minLats = [];\r\n            var maxLons = [];\r\n            var maxLats = [];\r\n            extents.forEach(function (extent) {\r\n                minLons.push(extent.getMinLon());\r\n                minLats.push(extent.getMinLat());\r\n                maxLons.push(extent.getMaxLon());\r\n                maxLats.push(extent.getMaxLat());\r\n            });\r\n            if (union) {\r\n                var minLon = Math.min.apply(Math, minLons);\r\n                var minLat = Math.min.apply(Math, minLats);\r\n                var maxLon = Math.max.apply(Math, maxLons);\r\n                var maxLat = Math.max.apply(Math, maxLats);\r\n                result = new Extent(minLon, minLat, maxLon, maxLat);\r\n            }\r\n            else {\r\n                var minLon = Math.max.apply(Math, minLons);\r\n                var minLat = Math.max.apply(Math, minLats);\r\n                var maxLon = Math.min.apply(Math, maxLons);\r\n                var maxLat = Math.min.apply(Math, maxLats);\r\n                if (minLon < maxLon && minLat < maxLat) {\r\n                    result = new Extent(minLon, minLat, maxLon, maxLat);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Extent.union = function (extents) {\r\n        return this.merge(extents, true);\r\n    };\r\n    Extent.intersect = function (extents) {\r\n        return this.merge(extents, false);\r\n    };\r\n    Extent.fromLonlats = function (lonlats) {\r\n        if (lonlats.length <= 1) {\r\n            return null;\r\n        }\r\n        var lons = [];\r\n        var lats = [];\r\n        lonlats.forEach(function (lonlat) {\r\n            lons.push(lonlat[0]);\r\n            lats.push(lonlat[1]);\r\n        });\r\n        var minLon = Math.min.apply(Math, lons);\r\n        var minLat = Math.min.apply(Math, lats);\r\n        var maxLon = Math.max.apply(Math, lons);\r\n        var maxLat = Math.max.apply(Math, lats);\r\n        var extent = new Extent(minLon, minLat, maxLon, maxLat);\r\n        return extent;\r\n    };\r\n    return Extent;\r\n}());\r\nexports.default = Extent;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Extent.ts\n// module id = 15\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar GraphicGroup = (function () {\r\n    function GraphicGroup() {\r\n        this.visible = true;\r\n        this.id = ++Kernel_1.default.idCounter;\r\n        this.children = [];\r\n    }\r\n    GraphicGroup.prototype.add = function (g, first) {\r\n        if (first === void 0) { first = false; }\r\n        if (first) {\r\n            this.children.unshift(g);\r\n        }\r\n        else {\r\n            this.children.push(g);\r\n        }\r\n        g.parent = this;\r\n    };\r\n    GraphicGroup.prototype.remove = function (g) {\r\n        var index = this.findChildIndex(g);\r\n        if (index >= 0) {\r\n            this.children.splice(index, 1);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    GraphicGroup.prototype.clear = function () {\r\n        var i = 0, length = this.children.length, g = null;\r\n        for (; i < length; i++) {\r\n            g = this.children[i];\r\n            g.destroy();\r\n        }\r\n        this.children = [];\r\n    };\r\n    GraphicGroup.prototype.destroy = function () {\r\n        this.parent = null;\r\n        this.clear();\r\n    };\r\n    GraphicGroup.prototype.findChildIndex = function (child) {\r\n        var count = this.children.length;\r\n        for (var i = 0; i < count; i++) {\r\n            var g = this.children[i];\r\n            if (child === g) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    };\r\n    GraphicGroup.prototype.findChildById = function (graphicId) {\r\n        var i = 0, length = this.children.length, g = null;\r\n        for (; i < length; i++) {\r\n            g = this.children[i];\r\n            if (g.id === graphicId) {\r\n                return {\r\n                    index: i,\r\n                    graphic: g\r\n                };\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    GraphicGroup.prototype.shouldDraw = function () {\r\n        return this.visible && this.children.length > 0;\r\n    };\r\n    GraphicGroup.prototype.moveChildToLastPosition = function (child) {\r\n        var index = this.findChildIndex(child);\r\n        this.children.splice(index, 1);\r\n        this.children.push(child);\r\n    };\r\n    GraphicGroup.prototype.draw = function (camera) {\r\n        if (this.shouldDraw()) {\r\n            this.onBeforeDraw();\r\n            this.onDraw(camera);\r\n            this.onAfterDraw();\r\n        }\r\n    };\r\n    GraphicGroup.prototype.onBeforeDraw = function () {\r\n    };\r\n    GraphicGroup.prototype.onDraw = function (camera) {\r\n        this.children.forEach(function (g) {\r\n            if (g.shouldDraw(camera)) {\r\n                g.draw(camera);\r\n            }\r\n        });\r\n    };\r\n    GraphicGroup.prototype.onAfterDraw = function () {\r\n    };\r\n    return GraphicGroup;\r\n}());\r\n;\r\nvar PickableGraphicGroup = (function (_super) {\r\n    __extends(PickableGraphicGroup, _super);\r\n    function PickableGraphicGroup() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.pickListener = null;\r\n        return _this;\r\n    }\r\n    PickableGraphicGroup.prototype.pickByLocalLine = function (localLine, emitListener) {\r\n        if (emitListener === void 0) { emitListener = false; }\r\n        var count = this.children.length;\r\n        for (var i = count - 1; i >= 0; i--) {\r\n            var child = this.children[i];\r\n            if (child.ifIntersectLocalLine(localLine)) {\r\n                if (emitListener) {\r\n                    this.onPick(child);\r\n                }\r\n                return child;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    PickableGraphicGroup.prototype.pickByWorldLine = function (worldLine, emitListener) {\r\n        if (emitListener === void 0) { emitListener = false; }\r\n        var count = this.children.length;\r\n        for (var i = count - 1; i >= 0; i--) {\r\n            var child = this.children[i];\r\n            if (child.ifIntersectWorldLine(worldLine)) {\r\n                if (emitListener) {\r\n                    this.onPick(child);\r\n                }\r\n                return child;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    PickableGraphicGroup.prototype.onPick = function (target) {\r\n        this.moveChildToLastPosition(target);\r\n        if (this.pickListener) {\r\n            this.pickListener(target);\r\n        }\r\n    };\r\n    PickableGraphicGroup.prototype.hasPickListener = function () {\r\n        return !!this.pickListener;\r\n    };\r\n    PickableGraphicGroup.prototype.setPickListener = function (listener) {\r\n        this.pickListener = listener;\r\n    };\r\n    return PickableGraphicGroup;\r\n}(GraphicGroup));\r\nexports.PickableGraphicGroup = PickableGraphicGroup;\r\nexports.default = GraphicGroup;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/GraphicGroup.ts\n// module id = 18\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Material_1 = require(\"./Material\");\r\nvar Image_1 = require(\"../Image\");\r\nvar MeshTextureMaterial = (function (_super) {\r\n    __extends(MeshTextureMaterial, _super);\r\n    function MeshTextureMaterial(imageOrUrl, flipY) {\r\n        if (imageOrUrl === void 0) { imageOrUrl = null; }\r\n        if (flipY === void 0) { flipY = false; }\r\n        var _this = _super.call(this) || this;\r\n        _this.flipY = flipY;\r\n        _this.ready = false;\r\n        _this.deleted = false;\r\n        _this.texture = Kernel_1.default.gl.createTexture();\r\n        if (imageOrUrl) {\r\n            _this.setImageOrUrl(imageOrUrl);\r\n        }\r\n        return _this;\r\n    }\r\n    MeshTextureMaterial.prototype.isReady = function () {\r\n        return this.ready && !this.deleted;\r\n    };\r\n    MeshTextureMaterial.prototype.setImageOrUrl = function (imageOrUrl) {\r\n        if (!imageOrUrl) {\r\n            return;\r\n        }\r\n        if (imageOrUrl instanceof Image && imageOrUrl.width > 0 && imageOrUrl.height > 0) {\r\n            this.setImage(imageOrUrl);\r\n        }\r\n        else if (typeof imageOrUrl === \"string\") {\r\n            this.setImageUrl(imageOrUrl);\r\n        }\r\n    };\r\n    MeshTextureMaterial.prototype.setImage = function (image) {\r\n        if (image.width > 0 && image.height > 0) {\r\n            this.ready = false;\r\n            this.image = image;\r\n            this.onLoad();\r\n        }\r\n    };\r\n    MeshTextureMaterial.prototype.setImageUrl = function (url) {\r\n        var tileImage = Image_1.default.get(url);\r\n        if (tileImage) {\r\n            this.setImage(tileImage);\r\n        }\r\n        else {\r\n            this.ready = false;\r\n            this.image = new Image();\r\n            this.image.crossOrigin = 'anonymous';\r\n            this.image.onload = this.onLoad.bind(this);\r\n            this.image.src = url;\r\n        }\r\n    };\r\n    MeshTextureMaterial.prototype.onLoad = function () {\r\n        if (this.deleted) {\r\n            return;\r\n        }\r\n        var gl = Kernel_1.default.gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, this.texture);\r\n        if (this.flipY) {\r\n            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, +true);\r\n        }\r\n        else {\r\n            gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, +false);\r\n        }\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, this.image);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        this.ready = true;\r\n    };\r\n    MeshTextureMaterial.prototype.destroy = function () {\r\n        var gl = Kernel_1.default.gl;\r\n        if (this.texture) {\r\n            gl.deleteTexture(this.texture);\r\n        }\r\n        if (this.image && !this.ready) {\r\n            this.image.src = \"\";\r\n        }\r\n        this.ready = false;\r\n        this.texture = null;\r\n        this.deleted = true;\r\n    };\r\n    return MeshTextureMaterial;\r\n}(Material_1.default));\r\nexports.default = MeshTextureMaterial;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/materials/MeshTextureMaterial.ts\n// module id = 22\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Triangle_1 = require(\"./Triangle\");\r\nvar Object3D_1 = require(\"../Object3D\");\r\nvar VertexBufferObject_1 = require(\"../VertexBufferObject\");\r\nvar Vertice_1 = require(\"../math/Vertice\");\r\nvar Utils_1 = require(\"../math/Utils\");\r\nvar Mesh = (function (_super) {\r\n    __extends(Mesh, _super);\r\n    function Mesh() {\r\n        var _this = _super.call(this) || this;\r\n        _this.vertices = null;\r\n        _this.triangles = null;\r\n        _this.vbo = null;\r\n        _this.ibo = null;\r\n        _this.nbo = null;\r\n        _this.uvbo = null;\r\n        _this.cbo = null;\r\n        _this.box = null;\r\n        _this.vertices = [];\r\n        _this.triangles = [];\r\n        return _this;\r\n    }\r\n    Mesh.buildPlane = function (vLeftTop, vLeftBottom, vRightTop, vRightBottom) {\r\n        var tri0 = new Triangle_1.default(vLeftTop, vLeftBottom, vRightTop);\r\n        var tri1 = new Triangle_1.default(vRightTop, vLeftBottom, vRightBottom);\r\n        return [tri0, tri1];\r\n    };\r\n    Mesh.buildMesh = function (vLeftTop, vLeftBottom, vRightTop, vRightBottom) {\r\n        var mesh = new Mesh();\r\n        mesh.vertices = [vLeftTop, vLeftBottom, vRightTop, vRightBottom];\r\n        mesh.triangles = this.buildPlane(vLeftTop, vLeftBottom, vRightTop, vRightBottom);\r\n        return mesh;\r\n    };\r\n    Mesh.prototype.updateBox = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        var triCount = this.triangles.length;\r\n        var verCount = this.vertices.length;\r\n        if (triCount === 0 || verCount <= 3) {\r\n            this.box = null;\r\n            return;\r\n        }\r\n        if (!this.box || force) {\r\n            var maxX = -Infinity;\r\n            var maxY = -Infinity;\r\n            var maxZ = -Infinity;\r\n            var minX = Infinity;\r\n            var minY = Infinity;\r\n            var minZ = Infinity;\r\n            for (var i = 0; i < verCount; i++) {\r\n                var vertice = this.vertices[i];\r\n                var _a = vertice.p, x = _a[0], y = _a[1], z = _a[2];\r\n                if (x > maxX) {\r\n                    maxX = x;\r\n                }\r\n                if (y > maxY) {\r\n                    maxY = y;\r\n                }\r\n                if (z > maxZ) {\r\n                    maxZ = z;\r\n                }\r\n                if (x < minX) {\r\n                    minX = x;\r\n                }\r\n                if (y < minY) {\r\n                    minY = y;\r\n                }\r\n                if (z < minZ) {\r\n                    minZ = z;\r\n                }\r\n            }\r\n            var deltaX = maxX - minX;\r\n            var deltaY = maxY - minY;\r\n            var deltaZ = maxZ - minZ;\r\n            var radius = Math.sqrt(deltaX * deltaX + deltaY * deltaY + deltaZ * deltaZ);\r\n            var center = new Vertice_1.default((maxX + minX) / 2, (maxY + minY) / 2, (maxZ + minZ) / 2);\r\n            this.box = {\r\n                center: center,\r\n                radius: radius\r\n            };\r\n        }\r\n    };\r\n    Mesh.prototype.ifIntersectWorldLine = function (worldLine) {\r\n        var localLine = Utils_1.default.convertWorldLineToLocalLine(worldLine, this.matrix);\r\n        return this.ifIntersectLocalLine(localLine);\r\n    };\r\n    Mesh.prototype.ifIntersectLocalLine = function (localLine) {\r\n        this.updateBox(false);\r\n        if (!this.box) {\r\n            return false;\r\n        }\r\n        var distance = Utils_1.default.getLengthFromVerticeToLine(this.box.center, localLine);\r\n        if (distance > this.box.radius) {\r\n            return false;\r\n        }\r\n        var count = this.triangles.length;\r\n        for (var i = 0; i < count; i++) {\r\n            var tri = this.triangles[i];\r\n            var v1 = new Vertice_1.default(tri.v1.p[0], tri.v1.p[1], tri.v1.p[2]);\r\n            var v2 = new Vertice_1.default(tri.v2.p[0], tri.v2.p[1], tri.v2.p[2]);\r\n            var v3 = new Vertice_1.default(tri.v3.p[0], tri.v3.p[1], tri.v3.p[2]);\r\n            var isIntersected = Utils_1.default.intersectTriangle(localLine.vertice, localLine.vector, v1, v2, v3);\r\n            if (isIntersected) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Mesh.prototype.buildTriangles = function () {\r\n        this.vertices = [];\r\n        this.triangles = [];\r\n    };\r\n    Mesh.prototype.calculateVBO = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        if (!this.vbo || force) {\r\n            var vboData = [], vertex;\r\n            for (var i = 0, length = this.vertices.length; i < length; i++) {\r\n                vertex = this.vertices[i];\r\n                vboData.push(vertex.p[0]);\r\n                vboData.push(vertex.p[1]);\r\n                vboData.push(vertex.p[2]);\r\n            }\r\n            if (!this.vbo) {\r\n                this.vbo = new VertexBufferObject_1.default(Kernel_1.default.gl.ARRAY_BUFFER);\r\n            }\r\n            this.vbo.bind();\r\n            this.vbo.bufferData(vboData, Kernel_1.default.gl.STATIC_DRAW, true);\r\n        }\r\n        return this.vbo;\r\n    };\r\n    Mesh.prototype.calculateIBO = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        if (!this.ibo || force) {\r\n            var iboData = [], triangle;\r\n            for (var i = 0, length = this.triangles.length; i < length; i++) {\r\n                triangle = this.triangles[i];\r\n                iboData.push(triangle.v1.i);\r\n                iboData.push(triangle.v2.i);\r\n                iboData.push(triangle.v3.i);\r\n            }\r\n            if (!this.ibo) {\r\n                this.ibo = new VertexBufferObject_1.default(Kernel_1.default.gl.ELEMENT_ARRAY_BUFFER);\r\n            }\r\n            this.ibo.bind();\r\n            this.ibo.bufferData(iboData, Kernel_1.default.gl.STATIC_DRAW, true);\r\n        }\r\n        return this.ibo;\r\n    };\r\n    Mesh.prototype.calculateNBO = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        if (!this.nbo || force) {\r\n            var nboData = [], vertex;\r\n            for (var i = 0, length = this.vertices.length; i < length; i++) {\r\n                vertex = this.vertices[i];\r\n                nboData.push(vertex.n[0]);\r\n                nboData.push(vertex.n[1]);\r\n                nboData.push(vertex.n[2]);\r\n            }\r\n            if (!this.nbo) {\r\n                this.nbo = new VertexBufferObject_1.default(Kernel_1.default.gl.ARRAY_BUFFER);\r\n            }\r\n            this.nbo.bind();\r\n            this.nbo.bufferData(nboData, Kernel_1.default.gl.STATIC_DRAW, true);\r\n        }\r\n        return this.nbo;\r\n    };\r\n    Mesh.prototype.calculateUVBO = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        if (!this.uvbo || force) {\r\n            var uvboData = [], vertex;\r\n            for (var i = 0, length = this.vertices.length; i < length; i++) {\r\n                vertex = this.vertices[i];\r\n                uvboData.push(vertex.uv[0]);\r\n                uvboData.push(vertex.uv[1]);\r\n            }\r\n            if (!this.uvbo) {\r\n                this.uvbo = new VertexBufferObject_1.default(Kernel_1.default.gl.ARRAY_BUFFER);\r\n            }\r\n            this.uvbo.bind();\r\n            this.uvbo.bufferData(uvboData, Kernel_1.default.gl.STATIC_DRAW, true);\r\n        }\r\n        return this.uvbo;\r\n    };\r\n    Mesh.prototype.calculateCBO = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        if (!this.cbo || force) {\r\n            var cboData = [], vertex;\r\n            for (var i = 0, length = this.vertices.length; i < length; i++) {\r\n                vertex = this.vertices[i];\r\n                cboData.push(vertex.c[0]);\r\n                cboData.push(vertex.c[1]);\r\n                cboData.push(vertex.c[2]);\r\n            }\r\n            if (!this.cbo) {\r\n                this.cbo = new VertexBufferObject_1.default(Kernel_1.default.gl.ARRAY_BUFFER);\r\n            }\r\n            this.cbo.bind();\r\n            this.cbo.bufferData(cboData, Kernel_1.default.gl.STATIC_DRAW, true);\r\n        }\r\n        return this.cbo;\r\n    };\r\n    Mesh.prototype.destroy = function () {\r\n        if (this.vbo) {\r\n            this.vbo.destroy();\r\n        }\r\n        if (this.ibo) {\r\n            this.ibo.destroy();\r\n        }\r\n        if (this.nbo) {\r\n            this.nbo.destroy();\r\n        }\r\n        if (this.cbo) {\r\n            this.cbo.destroy();\r\n        }\r\n        if (this.uvbo) {\r\n            this.uvbo.destroy();\r\n        }\r\n        this.vbo = null;\r\n        this.ibo = null;\r\n        this.nbo = null;\r\n        this.cbo = null;\r\n        this.uvbo = null;\r\n        this.vertices = [];\r\n        this.triangles = [];\r\n    };\r\n    return Mesh;\r\n}(Object3D_1.default));\r\nexports.default = Mesh;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/geometries/Mesh.ts\n// module id = 23\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar MeshVertice = (function () {\r\n    function MeshVertice(args) {\r\n        this.i = args.i;\r\n        this.p = args.p;\r\n        this.uv = args.uv;\r\n        this.n = args.n;\r\n        this.c = args.c;\r\n    }\r\n    MeshVertice.prototype.clone = function () {\r\n        var args = {};\r\n        args.i = this.i;\r\n        args.p = this.p.slice();\r\n        args.uv = this.uv.slice();\r\n        args.n = this.n.slice();\r\n        args.c = this.c.slice();\r\n        return new MeshVertice(args);\r\n    };\r\n    return MeshVertice;\r\n}());\r\nexports.default = MeshVertice;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/geometries/MeshVertice.ts\n// module id = 24\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils_1 = require(\"./math/Utils\");\r\nvar Service = (function () {\r\n    function Service() {\r\n    }\r\n    Service.jsonp = function (url, callback, charset, callbackParameterName, callbackPrefix) {\r\n        if (charset === void 0) { charset = \"\"; }\r\n        if (callbackParameterName === void 0) { callbackParameterName = \"cb\"; }\r\n        if (callbackPrefix === void 0) { callbackPrefix = \"QQ\"; }\r\n        var callbackName = callbackPrefix + \"_webglobe_callback_\" + Math.random().toString().substring(2);\r\n        if (url.indexOf('?') < 0) {\r\n            url += '?';\r\n        }\r\n        else {\r\n            url += '&';\r\n        }\r\n        url += callbackParameterName + \"=window.\" + callbackName;\r\n        var scriptElement = document.createElement(\"script\");\r\n        scriptElement.setAttribute(\"src\", url);\r\n        if (charset) {\r\n            scriptElement.setAttribute(\"charset\", charset);\r\n        }\r\n        scriptElement.setAttribute(\"async\", \"true\");\r\n        scriptElement.setAttribute(\"defer\", \"true\");\r\n        document.body.appendChild(scriptElement);\r\n        var canceled = false;\r\n        function clear() {\r\n            delete window[callbackName];\r\n            scriptElement.src = \"\";\r\n            if (scriptElement.parentNode) {\r\n                scriptElement.parentNode.removeChild(scriptElement);\r\n            }\r\n            scriptElement = null;\r\n        }\r\n        window[callbackName] = function (response) {\r\n            if (!canceled) {\r\n                callback(response);\r\n            }\r\n            clear();\r\n        };\r\n        return function () {\r\n            canceled = true;\r\n            clear();\r\n        };\r\n    };\r\n    Service.getCityLocation = function () {\r\n        var _this = this;\r\n        var p = new Promise(function (resolve) {\r\n            if (_this.cityLocation) {\r\n                resolve(_this.cityLocation);\r\n            }\r\n            else {\r\n                var url = \"//apis.map.qq.com/jsapi?qt=gc&output=jsonp\";\r\n                Service.jsonp(url, function (response) {\r\n                    console.log(\"\\u5B9A\\u4F4D\\uFF1A\", response);\r\n                    var detail = response.detail;\r\n                    if (response.detail) {\r\n                        _this.cityLocation = {\r\n                            lon: parseFloat(detail.pointx),\r\n                            lat: parseFloat(detail.pointy),\r\n                            accuracy: Infinity,\r\n                            city: detail.cname\r\n                        };\r\n                        resolve(_this.cityLocation);\r\n                    }\r\n                    else {\r\n                        resolve(null);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        return p;\r\n    };\r\n    Service.getCurrentPosition = function (highAccuracy) {\r\n        var _this = this;\r\n        if (highAccuracy === void 0) { highAccuracy = false; }\r\n        var p = new Promise(function (resolve) {\r\n            _this.getCityLocation().then(function (cityLocation) {\r\n                if (highAccuracy) {\r\n                    navigator.geolocation.getCurrentPosition(function (response) {\r\n                        var location = {\r\n                            lon: response.coords.longitude,\r\n                            lat: response.coords.latitude,\r\n                            accuracy: response.coords.accuracy,\r\n                            city: cityLocation.city\r\n                        };\r\n                        _this.location = location;\r\n                        resolve(_this.location);\r\n                    }, function (err) {\r\n                        console.error(err);\r\n                        if (_this.location) {\r\n                            resolve(_this.location);\r\n                        }\r\n                        else {\r\n                            resolve(cityLocation);\r\n                        }\r\n                    }, {\r\n                        enableHighAccuracy: true\r\n                    });\r\n                }\r\n                else {\r\n                    if (_this.location) {\r\n                        resolve(_this.location);\r\n                    }\r\n                    else {\r\n                        resolve(cityLocation);\r\n                    }\r\n                }\r\n            });\r\n        });\r\n        return p;\r\n    };\r\n    Service.createPoiTypes = function () {\r\n        this._createPoiTypes(this.poiClasses, this.poiTypes);\r\n        return this.poiTypes;\r\n    };\r\n    Service._createPoiTypes = function (obj, types) {\r\n        var _this = this;\r\n        for (var key in obj) {\r\n            if (obj.hasOwnProperty(key)) {\r\n                types.push(key);\r\n                var values = obj[key];\r\n                if (values && values.length > 0) {\r\n                    values.forEach(function (value) {\r\n                        if (typeof value === 'string') {\r\n                            types.push(value);\r\n                        }\r\n                        else if (typeof value === 'object') {\r\n                            _this._createPoiTypes(value, types);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Service._getStrictSearchType = function (keyword) {\r\n        var searchType = 'POI';\r\n        for (var i = 0; i < this.poiTypes.length; i++) {\r\n            var poiType = this.poiTypes[i];\r\n            if (poiType.indexOf(keyword) >= 0) {\r\n                searchType = 'Type';\r\n                return searchType;\r\n            }\r\n            var looselyContain = true;\r\n            for (var j = 0; j < keyword.length; j++) {\r\n                var char = keyword.charAt(j);\r\n                if (poiType.indexOf(char) < 0) {\r\n                    looselyContain = false;\r\n                    break;\r\n                }\r\n            }\r\n            if (looselyContain) {\r\n                searchType = 'Type';\r\n                return searchType;\r\n            }\r\n        }\r\n        return searchType;\r\n    };\r\n    Service._getUrlBySearchType = function (url, searchType) {\r\n        if (searchType === 'Type') {\r\n            url += '&qt=rn';\r\n        }\r\n        else if (searchType === 'POI') {\r\n            url += '&qt=poi';\r\n        }\r\n        return url;\r\n    };\r\n    Service.searchByExtent = function (keyword, level, _a, pageCapacity, pageIndex) {\r\n        var minLon = _a.minLon, minLat = _a.minLat, maxLon = _a.maxLon, maxLat = _a.maxLat;\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        var p = new Promise(function (resolve) {\r\n            var url = \"//apis.map.qq.com/jsapi?qt=syn&wd=\" + keyword + \"&pn=\" + pageIndex + \"&rn=\" + pageCapacity + \"&output=jsonp&b=\" + minLon + \",\" + minLat + \",\" + maxLon + \",\" + maxLat + \"&l=\" + level + \"&c=000000\";\r\n            Service.jsonp(url, function (response) {\r\n                resolve(response);\r\n            });\r\n        });\r\n        return p;\r\n    };\r\n    Service.searchByBuffer = function (keyword, lon, lat, radius, searchType, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (searchType === void 0) { searchType = 'Auto'; }\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        if (searchType === 'Auto') {\r\n            searchType = this._getStrictSearchType(keyword);\r\n            return this._rawSearchByBuffer(searchType, keyword, lon, lat, radius, pageCapacity, pageIndex).then(function (response) {\r\n                var poiCount = 0;\r\n                if (response && response.detail && response.detail.pois && response.detail.pois.length > 0) {\r\n                    poiCount = response.detail.pois.length;\r\n                }\r\n                if (poiCount === 0) {\r\n                    if (searchType === 'Type') {\r\n                        return _this._rawSearchByBuffer('POI', keyword, lon, lat, radius, pageCapacity, pageIndex);\r\n                    }\r\n                    else if (searchType === 'POI') {\r\n                        return _this._rawSearchByBuffer('Type', keyword, lon, lat, radius, pageCapacity, pageIndex);\r\n                    }\r\n                }\r\n                return response;\r\n            });\r\n        }\r\n        else {\r\n            return this._rawSearchByBuffer(searchType, keyword, lon, lat, radius, pageCapacity, pageIndex);\r\n        }\r\n    };\r\n    Service._rawSearchByBuffer = function (searchType, keyword, lon, lat, radius, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        var p = new Promise(function (resolve) {\r\n            var url = \"//apis.map.qq.com/jsapi?wd=\" + keyword + \"&pn=\" + pageIndex + \"&rn=\" + pageCapacity + \"&px=\" + lon + \"&py=\" + lat + \"&r=\" + radius + \"&output=jsonp\";\r\n            url = _this._getUrlBySearchType(url, searchType);\r\n            Service.jsonp(url, function (response) {\r\n                if (response) {\r\n                    response.location = [lon, lat];\r\n                }\r\n                resolve(response);\r\n            });\r\n        });\r\n        return p;\r\n    };\r\n    Service.searchByCity = function (keyword, city, searchType, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (searchType === void 0) { searchType = 'Auto'; }\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        if (searchType === 'Auto') {\r\n            searchType = this._getStrictSearchType(keyword);\r\n            return this._rawSearchByCity(searchType, keyword, city, pageCapacity, pageIndex).then(function (response) {\r\n                var poiCount = 0;\r\n                if (response && response.detail && response.detail.pois && response.detail.pois.length > 0) {\r\n                    poiCount = response.detail.pois.length;\r\n                }\r\n                if (poiCount === 0) {\r\n                    if (searchType === 'Type') {\r\n                        return _this._rawSearchByCity('POI', keyword, city, pageCapacity, pageIndex);\r\n                    }\r\n                    else if (searchType === 'POI') {\r\n                        return _this._rawSearchByCity('Type', keyword, city, pageCapacity, pageIndex);\r\n                    }\r\n                }\r\n                return response;\r\n            });\r\n        }\r\n        else {\r\n            return this._rawSearchByCity(searchType, keyword, city, pageCapacity, pageIndex);\r\n        }\r\n    };\r\n    Service._rawSearchByCity = function (searchType, keyword, city, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        var p = new Promise(function (resolve) {\r\n            var url = \"//apis.map.qq.com/jsapi?wd=\" + keyword + \"&pn=\" + pageIndex + \"&rn=\" + pageCapacity + \"&c=\" + city + \"&output=jsonp\";\r\n            url = _this._getUrlBySearchType(url, searchType);\r\n            Service.jsonp(url, function (response) {\r\n                if (response) {\r\n                    if (_this.location) {\r\n                        response.location = [_this.location.lon, _this.location.lat];\r\n                    }\r\n                    else if (_this.cityLocation) {\r\n                        response.location = [_this.cityLocation.lon, _this.cityLocation.lat];\r\n                    }\r\n                    else {\r\n                        response.location = null;\r\n                    }\r\n                }\r\n                resolve(response);\r\n            });\r\n        });\r\n        return p;\r\n    };\r\n    Service.searchNearby = function (keyword, radius, searchType, highAccuracy, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (searchType === void 0) { searchType = 'Auto'; }\r\n        if (highAccuracy === void 0) { highAccuracy = false; }\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        return this.getCurrentPosition(highAccuracy).then(function (location) {\r\n            return _this.searchByBuffer(keyword, location.lon, location.lat, radius, searchType, pageCapacity, pageIndex);\r\n        });\r\n    };\r\n    Service.searchByCurrentCity = function (keyword, searchType, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (searchType === void 0) { searchType = 'Auto'; }\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        return this.getCityLocation().then(function (cityLocation) {\r\n            return _this.searchByCity(keyword, cityLocation.city, searchType, pageCapacity, pageIndex);\r\n        });\r\n    };\r\n    Service.routeByDriving = function (fromLon, fromLat, toLon, toLat, key, strategy) {\r\n        var _this = this;\r\n        if (strategy === void 0) { strategy = 5; }\r\n        var p = new Promise(function (resolve, reject) {\r\n            var url = \"//restapi.amap.com/v3/direction/driving?origin=\" + fromLon + \",\" + fromLat + \"&destination=\" + toLon + \",\" + toLat + \"&extensions=all&output=json&key=\" + key + \"&strategy=\" + strategy;\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open(\"GET\", url, true);\r\n            xhr.onload = function (event) {\r\n                var response = _this._handleDrivingResult(event.target.responseText);\r\n                resolve(response);\r\n            };\r\n            xhr.onerror = function (err) {\r\n                reject(err);\r\n            };\r\n            xhr.onabort = function (err) {\r\n                reject(err);\r\n            };\r\n            xhr.send();\r\n        });\r\n        return p;\r\n    };\r\n    Service._handleDrivingResult = function (responseText) {\r\n        var _this = this;\r\n        var response = JSON.parse(responseText);\r\n        if (response.route) {\r\n            response.route.type = 'driving';\r\n            if (response.route.paths && response.route.paths.length > 0) {\r\n                response.route.paths.forEach(function (path) {\r\n                    if (path.steps) {\r\n                        path.steps.forEach(function (step) { return _this._parseStepPolyline(step); });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return response;\r\n    };\r\n    Service.routeByBus = function (fromLon, fromLat, toLon, toLat, startCity, endCity, key, strategy) {\r\n        var _this = this;\r\n        if (strategy === void 0) { strategy = 0; }\r\n        var p = new Promise(function (resolve, reject) {\r\n            var url = \"//restapi.amap.com/v3/direction/transit/integrated?origin=\" + fromLon + \",\" + fromLat + \"&destination=\" + toLon + \",\" + toLat + \"&city=\" + startCity + \"&cityd=\" + endCity + \"&output=json&key=\" + key;\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open(\"GET\", url, true);\r\n            xhr.onload = function (event) {\r\n                var response = _this._handleBusResult(event.target.responseText);\r\n                resolve(response);\r\n            };\r\n            xhr.onerror = function (err) {\r\n                reject(err);\r\n            };\r\n            xhr.onabort = function (err) {\r\n                reject(err);\r\n            };\r\n            xhr.send();\r\n        });\r\n        return p;\r\n    };\r\n    Service._handleBusResult = function (responseText) {\r\n        var _this = this;\r\n        var response = JSON.parse(responseText);\r\n        if (response.route) {\r\n            response.route.type = 'bus';\r\n            if (response.route.transits && response.route.transits.length > 0) {\r\n                response.route.transits.forEach(function (transit) {\r\n                    var walking_distance = 0;\r\n                    transit.segments.forEach(function (segment) {\r\n                        if (segment.walking && segment.walking.steps && segment.walking.steps.length > 0) {\r\n                            segment.walking.lonlats = [];\r\n                            segment.walking.steps.forEach(function (step) {\r\n                                var _a;\r\n                                _this._parseStepPolyline(step);\r\n                                (_a = segment.walking.lonlats).push.apply(_a, step.lonlats);\r\n                                if (step.distance) {\r\n                                    var stepDistance = parseFloat(step.distance);\r\n                                    if (!isNaN(stepDistance)) {\r\n                                        walking_distance += stepDistance;\r\n                                    }\r\n                                }\r\n                            });\r\n                            segment.walking.firstLonlat = segment.walking.lonlats[0];\r\n                            segment.walking.lastLonlat = segment.walking.lonlats[segment.walking.lonlats.length - 1];\r\n                        }\r\n                        if (segment.bus && segment.bus.buslines && segment.bus.buslines.length > 0) {\r\n                            segment.bus.lonlats = [];\r\n                            segment.bus.buslines.forEach(function (step) {\r\n                                var _a;\r\n                                _this._parseStepPolyline(step);\r\n                                (_a = segment.bus.lonlats).push.apply(_a, step.lonlats);\r\n                                step.busName = step.name;\r\n                                var idx = step.name.indexOf(\"(\");\r\n                                if (idx >= 0) {\r\n                                    step.busName = step.name.slice(0, idx);\r\n                                }\r\n                            });\r\n                            if (segment.bus.lonlats.length > 0) {\r\n                                segment.bus.firstLonlat = segment.bus.lonlats[0];\r\n                                segment.bus.lastLonlat = segment.bus.lonlats[segment.bus.lonlats.length - 1];\r\n                            }\r\n                        }\r\n                        if (segment.railway && segment.railway.departure_stop && segment.railway.arrival_stop) {\r\n                            var location1 = segment.railway.departure_stop.location;\r\n                            var location2 = segment.railway.arrival_stop.location;\r\n                            segment.railway.lonlats = [];\r\n                            if (location1 && location2) {\r\n                                var splits1 = location1.split(\" \");\r\n                                var lon1 = parseFloat(splits1[0]);\r\n                                var lat1 = parseFloat(splits1[1]);\r\n                                var splits2 = location2.split(\" \");\r\n                                var lon2 = parseFloat(splits2[0]);\r\n                                var lat2 = parseFloat(splits2[1]);\r\n                                if (!isNaN(lon1) && !isNaN(lat1) && !isNaN(lon2) && !isNaN(lat2)) {\r\n                                    segment.railway.lonlats = [[lon1, lat1], [lon2, lat2]];\r\n                                }\r\n                            }\r\n                        }\r\n                    });\r\n                    var originalWalkingDistance = parseFloat(transit.walking_distance);\r\n                    if (isNaN(originalWalkingDistance)) {\r\n                        transit.walking_distance = walking_distance;\r\n                    }\r\n                    else {\r\n                        transit.walking_distance = originalWalkingDistance;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return response;\r\n    };\r\n    Service.routeByWalking = function (fromLon, fromLat, toLon, toLat, key) {\r\n        var _this = this;\r\n        var p = new Promise(function (resolve, reject) {\r\n            var url = \"//restapi.amap.com/v3/direction/walking?origin=\" + fromLon + \",\" + fromLat + \"&destination=\" + toLon + \",\" + toLat + \"&key=\" + key;\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open(\"GET\", url, true);\r\n            xhr.onload = function (event) {\r\n                var response = _this._handleWalkingResult(event.target.responseText);\r\n                resolve(response);\r\n            };\r\n            xhr.onerror = function (err) {\r\n                reject(err);\r\n            };\r\n            xhr.onabort = function (err) {\r\n                reject(err);\r\n            };\r\n            xhr.send();\r\n        });\r\n        return p;\r\n    };\r\n    Service._handleWalkingResult = function (responseText) {\r\n        var _this = this;\r\n        var response = JSON.parse(responseText);\r\n        if (response.route) {\r\n            response.route.type = 'walking';\r\n            if (response.route.paths && response.route.paths.length > 0) {\r\n                response.route.paths.forEach(function (path) {\r\n                    if (path && path.steps && path.steps.length > 0) {\r\n                        path.steps.forEach(function (step) {\r\n                            _this._parseStepPolyline(step);\r\n                        });\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        return response;\r\n    };\r\n    Service._parseStepPolyline = function (step) {\r\n        var strLonLats = step.polyline.split(\";\");\r\n        var lonlats = strLonLats.map(function (strLonlat) {\r\n            var splits = strLonlat.split(\",\");\r\n            var lon = parseFloat(splits[0]);\r\n            var lat = parseFloat(splits[1]);\r\n            return [lon, lat];\r\n        });\r\n        step.firstLonlat = lonlats[0];\r\n        step.lastLonlat = lonlats[lonlats.length - 1];\r\n        step.lonlats = lonlats;\r\n    };\r\n    Service.decodeQQPolyline = function (polyline) {\r\n        for (var i = 2; i < polyline.length; i++) {\r\n            polyline[i] = polyline[i - 2] + polyline[i] / 1000000;\r\n        }\r\n        return polyline;\r\n    };\r\n    Service.qqRouteByDriving = function (fromLon, fromLat, toLon, toLat, key, policy) {\r\n        var url = \"//apis.map.qq.com/ws/direction/v1/driving/?from=\" + fromLat + \",\" + fromLon + \"&to=\" + toLat + \",\" + toLon + \"&output=jsonp&key=\" + key;\r\n        if (policy) {\r\n            url += \"&policy=\" + policy;\r\n        }\r\n        var p = new Promise(function (resolve) {\r\n            Service.jsonp(url, function (response) {\r\n                response.result.routes.forEach(function (route) {\r\n                    Service.decodeQQPolyline(route.polyline);\r\n                });\r\n                resolve(response);\r\n            });\r\n        });\r\n        return p;\r\n    };\r\n    Service.qqRoute = function (routeType, fromLon, fromLat, toLon, toLat) {\r\n        var fromX = Utils_1.default.degreeLonToWebMercatorX(fromLon, true);\r\n        var fromY = Utils_1.default.degreeLatToWebMercatorY(fromLat, true);\r\n        var toX = Utils_1.default.degreeLonToWebMercatorX(toLon, true);\r\n        var toY = Utils_1.default.degreeLatToWebMercatorY(toLat, true);\r\n        var url = \"//apis.map.qq.com/jsapi?qt=\" + routeType + \"&start=1$$$$\" + fromX + \", \" + fromY + \"$$&dest=1$$$$\" + toX + \", \" + toY + \"$$&cond=3&mt=2&s=2&fm=0&output=jsonp&pf=jsapi&ref=jsapi\";\r\n        var p = new Promise(function (resolve) {\r\n            Service.jsonp(url, function (response) {\r\n                console.log(response);\r\n                resolve(response);\r\n            }, \"GBK\");\r\n        });\r\n        return p;\r\n    };\r\n    Service.cityLocation = null;\r\n    Service.location = null;\r\n    Service.poiClasses = {\r\n        '美食': [\r\n            '西餐', '烧烤', '火锅', '海鲜', '素食', '清真', '自助餐', '面包甜点', '冷饮店', '小吃快餐', {\r\n                '中餐厅': ['鲁菜', '粤菜', '湘菜', '川菜', '浙江菜', '安徽菜', '东北菜', '北京菜'],\r\n                '日韩菜': ['日本料理', '韩国料理'],\r\n                '东南亚菜': ['泰国菜']\r\n            }, '美食畅饮', '甜点饮品'\r\n        ],\r\n        '购物': ['综合商场', '便利店', '超市', '数码家电', '花鸟鱼虫', '家具家居建材', '农贸市场', '小商品市场', '旧货市场', '体育户外', '服饰鞋包', '图书音像', '眼镜店', '母婴儿童', '珠宝饰品', '化妆品', '礼品', '摄影器材', '拍卖典当行', '古玩字画', '自行车专卖', '烟酒专卖', '文化用品'],\r\n        '生活服务': ['旅行社', '报刊亭', '自来水营业厅', '电力营业厅', '摄影冲印', '洗衣店', '招聘求职', '彩票', '中介机构', '宠物服务', '废品收购站', '福利院养老院', '美容美发', {\r\n                '票务代售': ['飞机票代售', '火车票代售', '汽车票代售', '公交及IC卡'],\r\n                '邮局速递': ['邮局', '速递'],\r\n                '通讯服务': ['中国电信营业厅', '中国网通营业厅', '中国移动营业厅', '中国联通营业厅', '中国铁通营业厅'],\r\n                '家政': ['月嫂保姆', '保洁钟点工', '开锁', '送水', '家电维修', '搬家']\r\n            }],\r\n        '娱乐休闲': ['洗浴推拿足疗', 'KTV', '酒吧', '咖啡厅', '夜总会', '电影院', '剧场音乐厅', '度假疗养', '网吧', {\r\n                '户外活动': ['游乐场', '垂钓园', '采摘园'],\r\n                '游戏棋牌': ['游戏厅', '棋牌室']\r\n            }],\r\n        '汽车': ['停车场', '汽车销售', '汽车维修', '汽车养护', '洗车场', {\r\n                '加油站': ['中石化', '中石油', '其它加油加气站'],\r\n                '摩托车': ['摩托车服务相关', '销售', '维修', '其它摩托车']\r\n            }],\r\n        '医疗保健': ['综合医院', '诊所', '急救中心', '药房药店'],\r\n        '酒店宾馆': ['酒店宾馆', '星级酒店', '经济型酒店', '旅馆招待所', '青年旅社', '快捷酒店'],\r\n        '旅游景点': [],\r\n        '文化场馆': ['博物馆', '展览馆', '科技馆', '图书馆', '美术馆', '会展中心'],\r\n        '教育学校': ['大学', '中学', '小学', '幼儿园', '培训', '职业技术学校', '成人教育'],\r\n        '银行金融': ['银行', '自动提款机', '保险公司', '证券公司', 'ATM'],\r\n        '基础设施': ['其它基础设施', {\r\n                '交通设施': ['公交车站', '地铁站', '火车站', '长途汽车站', '公交线路', '地铁线路'],\r\n                '公共设施': ['公共厕所', '公用电话', '紧急避难场所'],\r\n                '道路附属': ['收费站', '服务区']\r\n            }],\r\n        '房产小区': ['商务楼宇', {\r\n                '住宅区': ['住宅小区', '别墅', '宿舍', '社区中心']\r\n            }]\r\n    };\r\n    Service.poiTypes = [];\r\n    return Service;\r\n}());\r\n;\r\nService.createPoiTypes();\r\nexports.default = Service;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Service.ts\n// module id = 27\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar Utils_1 = require(\"./math/Utils\");\r\nvar TileGridPosition;\r\n(function (TileGridPosition) {\r\n    TileGridPosition[TileGridPosition[\"LEFT_TOP\"] = 0] = \"LEFT_TOP\";\r\n    TileGridPosition[TileGridPosition[\"RIGHT_TOP\"] = 1] = \"RIGHT_TOP\";\r\n    TileGridPosition[TileGridPosition[\"LEFT_BOTTOM\"] = 2] = \"LEFT_BOTTOM\";\r\n    TileGridPosition[TileGridPosition[\"RIGHT_BOTTOM\"] = 3] = \"RIGHT_BOTTOM\";\r\n    TileGridPosition[TileGridPosition[\"LEFT\"] = 4] = \"LEFT\";\r\n    TileGridPosition[TileGridPosition[\"RIGHT\"] = 5] = \"RIGHT\";\r\n    TileGridPosition[TileGridPosition[\"TOP\"] = 6] = \"TOP\";\r\n    TileGridPosition[TileGridPosition[\"BOTTOM\"] = 7] = \"BOTTOM\";\r\n})(TileGridPosition = exports.TileGridPosition || (exports.TileGridPosition = {}));\r\nvar maxLatitudeOfWebMercator = Utils_1.default.webMercatorYToDegreeLat(Kernel_1.default.MAX_PROJECTED_COORD);\r\nvar TileGrid = (function () {\r\n    function TileGrid(level, row, column) {\r\n        this.level = level;\r\n        this.row = row;\r\n        this.column = column;\r\n        this.Egeo = null;\r\n    }\r\n    TileGrid.prototype.equals = function (other) {\r\n        return other && this.level === other.level && this.row === other.row && this.column === other.column;\r\n    };\r\n    TileGrid.prototype.getEgeo = function () {\r\n        if (!this.Egeo) {\r\n            this.Egeo = Utils_1.default.getTileGeographicEnvelopByGrid(this.level, this.row, this.column);\r\n        }\r\n        return this.Egeo;\r\n    };\r\n    TileGrid.prototype.getLeftTopTag = function () {\r\n        return this.level + \"_\" + this.row + \"_\" + this.column;\r\n    };\r\n    TileGrid.prototype.getRightTopTag = function () {\r\n        return this.level + \"_\" + this.row + \"_\" + (this.column + 1);\r\n    };\r\n    TileGrid.prototype.getLeftBottomTag = function () {\r\n        return this.level + \"_\" + (this.row + 1) + \"_\" + this.column;\r\n    };\r\n    TileGrid.prototype.getRightBottomTag = function () {\r\n        return this.level + \"_\" + (this.row + 1) + \"_\" + (this.column + 1);\r\n    };\r\n    TileGrid.prototype.getLeft = function () {\r\n        return TileGrid.getTileGridByBrother(this.level, this.row, this.column, TileGridPosition.LEFT);\r\n    };\r\n    TileGrid.prototype.getRight = function () {\r\n        return TileGrid.getTileGridByBrother(this.level, this.row, this.column, TileGridPosition.RIGHT);\r\n    };\r\n    TileGrid.prototype.getTop = function () {\r\n        return TileGrid.getTileGridByBrother(this.level, this.row, this.column, TileGridPosition.TOP);\r\n    };\r\n    TileGrid.prototype.getBottom = function () {\r\n        return TileGrid.getTileGridByBrother(this.level, this.row, this.column, TileGridPosition.BOTTOM);\r\n    };\r\n    TileGrid.prototype.getParent = function () {\r\n        return TileGrid.getTileGridAncestor(this.level - 1, this.level, this.row, this.column);\r\n    };\r\n    TileGrid.prototype.getAncestor = function (ancestorLevel) {\r\n        return TileGrid.getTileGridAncestor(ancestorLevel, this.level, this.row, this.column);\r\n    };\r\n    TileGrid.getTileGridByParent = function (parentLevel, parentRow, parentColumn, position) {\r\n        var level = parentLevel + 1;\r\n        var row = -1;\r\n        var column = -1;\r\n        if (position === TileGridPosition.LEFT_TOP) {\r\n            row = 2 * parentRow;\r\n            column = 2 * parentColumn;\r\n        }\r\n        else if (position === TileGridPosition.RIGHT_TOP) {\r\n            row = 2 * parentRow;\r\n            column = 2 * parentColumn + 1;\r\n        }\r\n        else if (position === TileGridPosition.LEFT_BOTTOM) {\r\n            row = 2 * parentRow + 1;\r\n            column = 2 * parentColumn;\r\n        }\r\n        else if (position === TileGridPosition.RIGHT_BOTTOM) {\r\n            row = 2 * parentRow + 1;\r\n            column = 2 * parentColumn + 1;\r\n        }\r\n        else {\r\n            throw \"invalid position\";\r\n        }\r\n        return new TileGrid(level, row, column);\r\n    };\r\n    TileGrid.getTilePositionOfParent = function (level, row, column, parent) {\r\n        var position = null;\r\n        parent = parent || this.getTileGridAncestor(level - 1, level, row, column);\r\n        var ltTileGrid = this.getTileGridByParent(parent.level, parent.row, parent.column, TileGridPosition.LEFT_TOP);\r\n        if (ltTileGrid.row === row) {\r\n            if (ltTileGrid.column === column) {\r\n                position = TileGridPosition.LEFT_TOP;\r\n            }\r\n            else if (ltTileGrid.column + 1 === column) {\r\n                position = TileGridPosition.RIGHT_TOP;\r\n            }\r\n        }\r\n        else if (ltTileGrid.row + 1 === row) {\r\n            if (ltTileGrid.column === column) {\r\n                position = TileGridPosition.LEFT_BOTTOM;\r\n            }\r\n            else if (ltTileGrid.column + 1 === column) {\r\n                position = TileGridPosition.RIGHT_BOTTOM;\r\n            }\r\n        }\r\n        return position;\r\n    };\r\n    TileGrid.getTileGridByBrother = function (brotherLevel, brotherRow, brotherColumn, position, options) {\r\n        options = options || {};\r\n        var result = new TileGrid(brotherLevel, brotherRow, brotherColumn);\r\n        if (position === TileGridPosition.LEFT) {\r\n            if (brotherColumn === 0) {\r\n                var maxSize = options.maxSize || Math.pow(2, brotherLevel);\r\n                result.column = maxSize - 1;\r\n            }\r\n            else {\r\n                result.column = brotherColumn - 1;\r\n            }\r\n        }\r\n        else if (position === TileGridPosition.RIGHT) {\r\n            var maxSize = options.maxSize || Math.pow(2, brotherLevel);\r\n            if (brotherColumn === maxSize - 1) {\r\n                result.column = 0;\r\n            }\r\n            else {\r\n                result.column = brotherColumn + 1;\r\n            }\r\n        }\r\n        else if (position === TileGridPosition.TOP) {\r\n            if (brotherRow === 0) {\r\n                var maxSize = options.maxSize || Math.pow(2, brotherLevel);\r\n                result.row = maxSize - 1;\r\n            }\r\n            else {\r\n                result.row = brotherRow - 1;\r\n            }\r\n        }\r\n        else if (position === TileGridPosition.BOTTOM) {\r\n            var maxSize = options.maxSize || Math.pow(2, brotherLevel);\r\n            if (brotherRow === maxSize - 1) {\r\n                result.row = 0;\r\n            }\r\n            else {\r\n                result.row = brotherRow + 1;\r\n            }\r\n        }\r\n        else {\r\n            throw \"invalid position\";\r\n        }\r\n        return result;\r\n    };\r\n    TileGrid.getTileGridAncestor = function (ancestorLevel, level, row, column) {\r\n        var result = null;\r\n        if (ancestorLevel < level) {\r\n            var deltaLevel = level - ancestorLevel;\r\n            var a = Math.pow(2, deltaLevel);\r\n            var ancestorRow = Math.floor(row / a);\r\n            var ancestorColumn = Math.floor(column / a);\r\n            result = new TileGrid(ancestorLevel, ancestorRow, ancestorColumn);\r\n        }\r\n        else if (ancestorLevel === level) {\r\n            result = new TileGrid(level, row, column);\r\n        }\r\n        return result;\r\n    };\r\n    TileGrid.isValidLatitude = function (lat) {\r\n        return lat >= -maxLatitudeOfWebMercator && lat <= maxLatitudeOfWebMercator;\r\n    };\r\n    TileGrid.getTileGridByGeo = function (lon, lat, level) {\r\n        if (!(lon >= -180 && lon <= 180)) {\r\n            throw \"invalid lon: \" + lon;\r\n        }\r\n        var coordWebMercator = Utils_1.default.degreeGeographicToWebMercator(lon, lat);\r\n        var x = coordWebMercator[0];\r\n        var y = coordWebMercator[1];\r\n        var horX = x + Kernel_1.default.MAX_PROJECTED_COORD;\r\n        var verY = Kernel_1.default.MAX_PROJECTED_COORD - y;\r\n        var size = Kernel_1.default.MAX_PROJECTED_COORD / Math.pow(2, level - 1);\r\n        var row = Math.floor(verY / size);\r\n        var column = Math.floor(horX / size);\r\n        return new TileGrid(level, row, column);\r\n    };\r\n    return TileGrid;\r\n}());\r\nexports.default = TileGrid;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/TileGrid.ts\n// module id = 32\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils_1 = require(\"../Utils\");\r\nvar Vertice_1 = require(\"./Vertice\");\r\nvar Vector_1 = require(\"./Vector\");\r\nvar Matrix = (function () {\r\n    function Matrix(m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44) {\r\n        if (m11 === void 0) { m11 = 1; }\r\n        if (m12 === void 0) { m12 = 0; }\r\n        if (m13 === void 0) { m13 = 0; }\r\n        if (m14 === void 0) { m14 = 0; }\r\n        if (m21 === void 0) { m21 = 0; }\r\n        if (m22 === void 0) { m22 = 1; }\r\n        if (m23 === void 0) { m23 = 0; }\r\n        if (m24 === void 0) { m24 = 0; }\r\n        if (m31 === void 0) { m31 = 0; }\r\n        if (m32 === void 0) { m32 = 0; }\r\n        if (m33 === void 0) { m33 = 1; }\r\n        if (m34 === void 0) { m34 = 0; }\r\n        if (m41 === void 0) { m41 = 0; }\r\n        if (m42 === void 0) { m42 = 0; }\r\n        if (m43 === void 0) { m43 = 0; }\r\n        if (m44 === void 0) { m44 = 1; }\r\n        this.elements = new Float64Array(16);\r\n        this.setElements(m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44);\r\n    }\r\n    Matrix.prototype.getFloat32Array = function () {\r\n        return new Float32Array(this.elements);\r\n    };\r\n    Matrix.prototype.equals = function (matrix) {\r\n        if (this === matrix) {\r\n            return true;\r\n        }\r\n        return Utils_1.default.every(this.elements, function (ele, index) {\r\n            return ele === matrix.elements[index];\r\n        });\r\n    };\r\n    Matrix.prototype.toJson = function () {\r\n        var elements = [];\r\n        Utils_1.default.forEach(this.elements, function (ele) {\r\n            elements.push(ele);\r\n        });\r\n        return {\r\n            elements: elements\r\n        };\r\n    };\r\n    Matrix.prototype.fromJson = function (json) {\r\n        var _this = this;\r\n        json.elements.forEach(function (ele, i) {\r\n            _this.elements[i] = ele;\r\n        });\r\n    };\r\n    Matrix.fromJson = function (json) {\r\n        if (!json) {\r\n            return null;\r\n        }\r\n        var mat = new Matrix();\r\n        mat.fromJson(json);\r\n        return mat;\r\n    };\r\n    Matrix.prototype.setElements = function (m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44) {\r\n        var count = arguments.length;\r\n        if (count < 16) {\r\n            throw \"invalid arguments:arguments length error\";\r\n        }\r\n        var values = this.elements;\r\n        values[0] = m11;\r\n        values[4] = m12;\r\n        values[8] = m13;\r\n        values[12] = m14;\r\n        values[1] = m21;\r\n        values[5] = m22;\r\n        values[9] = m23;\r\n        values[13] = m24;\r\n        values[2] = m31;\r\n        values[6] = m32;\r\n        values[10] = m33;\r\n        values[14] = m34;\r\n        values[3] = m41;\r\n        values[7] = m42;\r\n        values[11] = m43;\r\n        values[15] = m44;\r\n        return this;\r\n    };\r\n    Matrix.prototype.setVectorX = function (vector) {\r\n        this.elements[0] = vector.x;\r\n        this.elements[1] = vector.y;\r\n        this.elements[2] = vector.z;\r\n    };\r\n    Matrix.prototype.getVectorX = function () {\r\n        return new Vector_1.default(this.elements[0], this.elements[1], this.elements[2]);\r\n    };\r\n    Matrix.prototype.setVectorY = function (vector) {\r\n        this.elements[4] = vector.x;\r\n        this.elements[5] = vector.y;\r\n        this.elements[6] = vector.z;\r\n    };\r\n    Matrix.prototype.getVectorY = function () {\r\n        return new Vector_1.default(this.elements[4], this.elements[5], this.elements[6]);\r\n    };\r\n    Matrix.prototype.setVectorZ = function (vector) {\r\n        this.elements[8] = vector.x;\r\n        this.elements[9] = vector.y;\r\n        this.elements[10] = vector.z;\r\n    };\r\n    Matrix.prototype.getVectorZ = function () {\r\n        return new Vector_1.default(this.elements[8], this.elements[9], this.elements[10]);\r\n    };\r\n    Matrix.prototype.setPosition = function (vertice) {\r\n        this.elements[12] = vertice.x;\r\n        this.elements[13] = vertice.y;\r\n        this.elements[14] = vertice.z;\r\n    };\r\n    Matrix.prototype.getPosition = function () {\r\n        return new Vertice_1.default(this.elements[12], this.elements[13], this.elements[14]);\r\n    };\r\n    Matrix.prototype.setLastRowDefault = function () {\r\n        this.elements[3] = 0;\r\n        this.elements[7] = 0;\r\n        this.elements[11] = 0;\r\n        this.elements[15] = 1;\r\n    };\r\n    Matrix.prototype.transpose = function () {\r\n        var result = this.getTransposeMatrix();\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.getTransposeMatrix = function () {\r\n        var result = new Matrix();\r\n        result.elements[0] = this.elements[0];\r\n        result.elements[4] = this.elements[1];\r\n        result.elements[8] = this.elements[2];\r\n        result.elements[12] = this.elements[3];\r\n        result.elements[1] = this.elements[4];\r\n        result.elements[5] = this.elements[5];\r\n        result.elements[9] = this.elements[6];\r\n        result.elements[13] = this.elements[7];\r\n        result.elements[2] = this.elements[8];\r\n        result.elements[6] = this.elements[9];\r\n        result.elements[10] = this.elements[10];\r\n        result.elements[14] = this.elements[11];\r\n        result.elements[3] = this.elements[12];\r\n        result.elements[7] = this.elements[13];\r\n        result.elements[11] = this.elements[14];\r\n        result.elements[15] = this.elements[15];\r\n        return result;\r\n    };\r\n    Matrix.prototype.inverse = function () {\r\n        var result = this.getInverseMatrix();\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.getInverseMatrix = function () {\r\n        var a = this.elements;\r\n        var result = new Matrix();\r\n        var b = result.elements;\r\n        var c = a[0], d = a[1], e = a[2], g = a[3], f = a[4], h = a[5], i = a[6], j = a[7], k = a[8], l = a[9], n = a[10], o = a[11], m = a[12], p = a[13], r = a[14], s = a[15];\r\n        var A = c * h - d * f;\r\n        var B = c * i - e * f;\r\n        var t = c * j - g * f;\r\n        var u = d * i - e * h;\r\n        var v = d * j - g * h;\r\n        var w = e * j - g * i;\r\n        var x = k * p - l * m;\r\n        var y = k * r - n * m;\r\n        var z = k * s - o * m;\r\n        var C = l * r - n * p;\r\n        var D = l * s - o * p;\r\n        var E = n * s - o * r;\r\n        var q = A * E - B * D + t * C + u * z - v * y + w * x;\r\n        if (!q) {\r\n            console.log(\"can't get inverse matrix\");\r\n            return null;\r\n        }\r\n        q = 1 / q;\r\n        b[0] = (h * E - i * D + j * C) * q;\r\n        b[1] = (-d * E + e * D - g * C) * q;\r\n        b[2] = (p * w - r * v + s * u) * q;\r\n        b[3] = (-l * w + n * v - o * u) * q;\r\n        b[4] = (-f * E + i * z - j * y) * q;\r\n        b[5] = (c * E - e * z + g * y) * q;\r\n        b[6] = (-m * w + r * t - s * B) * q;\r\n        b[7] = (k * w - n * t + o * B) * q;\r\n        b[8] = (f * D - h * z + j * x) * q;\r\n        b[9] = (-c * D + d * z - g * x) * q;\r\n        b[10] = (m * v - p * t + s * A) * q;\r\n        b[11] = (-k * v + l * t - o * A) * q;\r\n        b[12] = (-f * C + h * y - i * x) * q;\r\n        b[13] = (c * C - d * y + e * x) * q;\r\n        b[14] = (-m * u + p * B - r * A) * q;\r\n        b[15] = (k * u - l * B + n * A) * q;\r\n        return result;\r\n    };\r\n    Matrix.prototype.setMatrixByOther = function (otherMatrix) {\r\n        for (var i = 0; i < otherMatrix.elements.length; i++) {\r\n            this.elements[i] = otherMatrix.elements[i];\r\n        }\r\n    };\r\n    Matrix.prototype.setUnitMatrix = function () {\r\n        this.setElements(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n    };\r\n    Matrix.prototype.setUniqueValue = function (value) {\r\n        var length = this.elements.length;\r\n        for (var i = 0; i < length; i++) {\r\n            this.elements[i] = value;\r\n        }\r\n    };\r\n    Matrix.prototype.isUnitMatrix = function () {\r\n        var values = this.elements;\r\n        for (var i = 0; i < values.length; i++) {\r\n            if (i % 4 === 0) {\r\n                if (values[i] != 1) {\r\n                    return false;\r\n                }\r\n            }\r\n            else {\r\n                if (values[i] !== 0) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    Matrix.prototype.clone = function () {\r\n        return new Matrix(this.elements[0], this.elements[4], this.elements[8], this.elements[12], this.elements[1], this.elements[5], this.elements[9], this.elements[13], this.elements[2], this.elements[6], this.elements[10], this.elements[14], this.elements[3], this.elements[7], this.elements[11], this.elements[15]);\r\n    };\r\n    Matrix.prototype.multiplyMatrix = function (otherMatrix) {\r\n        var values1 = this.elements;\r\n        var values2 = otherMatrix.elements;\r\n        var m11 = values1[0] * values2[0] + values1[4] * values2[1] + values1[8] * values2[2] + values1[12] * values2[3];\r\n        var m12 = values1[0] * values2[4] + values1[4] * values2[5] + values1[8] * values2[6] + values1[12] * values2[7];\r\n        var m13 = values1[0] * values2[8] + values1[4] * values2[9] + values1[8] * values2[10] + values1[12] * values2[11];\r\n        var m14 = values1[0] * values2[12] + values1[4] * values2[13] + values1[8] * values2[14] + values1[12] * values2[15];\r\n        var m21 = values1[1] * values2[0] + values1[5] * values2[1] + values1[9] * values2[2] + values1[13] * values2[3];\r\n        var m22 = values1[1] * values2[4] + values1[5] * values2[5] + values1[9] * values2[6] + values1[13] * values2[7];\r\n        var m23 = values1[1] * values2[8] + values1[5] * values2[9] + values1[9] * values2[10] + values1[13] * values2[11];\r\n        var m24 = values1[1] * values2[12] + values1[5] * values2[13] + values1[9] * values2[14] + values1[13] * values2[15];\r\n        var m31 = values1[2] * values2[0] + values1[6] * values2[1] + values1[10] * values2[2] + values1[14] * values2[3];\r\n        var m32 = values1[2] * values2[4] + values1[6] * values2[5] + values1[10] * values2[6] + values1[14] * values2[7];\r\n        var m33 = values1[2] * values2[8] + values1[6] * values2[9] + values1[10] * values2[10] + values1[14] * values2[11];\r\n        var m34 = values1[2] * values2[12] + values1[6] * values2[13] + values1[10] * values2[14] + values1[14] * values2[15];\r\n        var m41 = values1[3] * values2[0] + values1[7] * values2[1] + values1[11] * values2[2] + values1[15] * values2[3];\r\n        var m42 = values1[3] * values2[4] + values1[7] * values2[5] + values1[11] * values2[6] + values1[15] * values2[7];\r\n        var m43 = values1[3] * values2[8] + values1[7] * values2[9] + values1[11] * values2[10] + values1[15] * values2[11];\r\n        var m44 = values1[3] * values2[12] + values1[7] * values2[13] + values1[11] * values2[14] + values1[15] * values2[15];\r\n        return new Matrix(m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44);\r\n    };\r\n    Matrix.prototype.multiplyColumn = function (c) {\r\n        var valid = c.length == 4;\r\n        if (!valid) {\r\n            throw \"invalid c\";\r\n        }\r\n        var values1 = this.elements;\r\n        var values2 = c;\r\n        var m11 = values1[0] * values2[0] + values1[4] * values2[1] + values1[8] * values2[2] + values1[12] * values2[3];\r\n        var m21 = values1[1] * values2[0] + values1[5] * values2[1] + values1[9] * values2[2] + values1[13] * values2[3];\r\n        var m31 = values1[2] * values2[0] + values1[6] * values2[1] + values1[10] * values2[2] + values1[14] * values2[3];\r\n        var m41 = values1[3] * values2[0] + values1[7] * values2[1] + values1[11] * values2[2] + values1[15] * values2[3];\r\n        return [m11, m21, m31, m41];\r\n    };\r\n    Matrix.prototype.hasNaN = function () {\r\n        return Utils_1.default.some(this.elements, function (v) {\r\n            return isNaN(v);\r\n        });\r\n    };\r\n    Matrix.prototype.divide = function (a) {\r\n        if (a === 0) {\r\n            throw \"invalid a:a is 0\";\r\n        }\r\n        if (a !== 0) {\r\n            for (var i = 0, length = this.elements.length; i < length; i++) {\r\n                this.elements[i] /= a;\r\n            }\r\n        }\r\n    };\r\n    Matrix.prototype.worldTranslate = function (x, y, z) {\r\n        this.elements[12] += x;\r\n        this.elements[13] += y;\r\n        this.elements[14] += z;\r\n    };\r\n    Matrix.prototype.localTranslate = function (x, y, z) {\r\n        var localColumn = [x, y, z, 1];\r\n        var worldColumn = this.multiplyColumn(localColumn);\r\n        var origin = this.getPosition();\r\n        this.worldTranslate(worldColumn[0] - origin.x, worldColumn[1] - origin.y, worldColumn[2] - origin.z);\r\n    };\r\n    Matrix.prototype.worldScale = function (scaleX, scaleY, scaleZ) {\r\n        scaleX = (scaleX !== undefined) ? scaleX : 1;\r\n        scaleY = (scaleY !== undefined) ? scaleY : 1;\r\n        scaleZ = (scaleZ !== undefined) ? scaleZ : 1;\r\n        var m = new Matrix(scaleX, 0, 0, 0, 0, scaleY, 0, 0, 0, 0, scaleZ, 0, 0, 0, 0, 1);\r\n        var result = m.multiplyMatrix(this);\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.localScale = function (scaleX, scaleY, scaleZ) {\r\n        var transVertice = this.getPosition();\r\n        this.setPosition(new Vertice_1.default(0, 0, 0));\r\n        this.worldScale(scaleX, scaleY, scaleZ);\r\n        this.setPosition(transVertice);\r\n    };\r\n    Matrix.prototype.worldRotateX = function (radian) {\r\n        var c = Math.cos(radian);\r\n        var s = Math.sin(radian);\r\n        var m = new Matrix(1, 0, 0, 0, 0, c, -s, 0, 0, s, c, 0, 0, 0, 0, 1);\r\n        var result = m.multiplyMatrix(this);\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.worldRotateY = function (radian) {\r\n        var c = Math.cos(radian);\r\n        var s = Math.sin(radian);\r\n        var m = new Matrix(c, 0, s, 0, 0, 1, 0, 0, -s, 0, c, 0, 0, 0, 0, 1);\r\n        var result = m.multiplyMatrix(this);\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.worldRotateZ = function (radian) {\r\n        var c = Math.cos(radian);\r\n        var s = Math.sin(radian);\r\n        var m = new Matrix(c, -s, 0, 0, s, c, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1);\r\n        var result = m.multiplyMatrix(this);\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.worldRotateByVector = function (radian, vector) {\r\n        var x = vector.x;\r\n        var y = vector.y;\r\n        var z = vector.z;\r\n        var length, s, c;\r\n        var xx, yy, zz, xy, yz, zx, xs, ys, zs, one_c;\r\n        s = Math.sin(radian);\r\n        c = Math.cos(radian);\r\n        length = Math.sqrt(x * x + y * y + z * z);\r\n        x /= length;\r\n        y /= length;\r\n        z /= length;\r\n        xx = x * x;\r\n        yy = y * y;\r\n        zz = z * z;\r\n        xy = x * y;\r\n        yz = y * z;\r\n        zx = z * x;\r\n        xs = x * s;\r\n        ys = y * s;\r\n        zs = z * s;\r\n        one_c = 1.0 - c;\r\n        var m11 = (one_c * xx) + c;\r\n        var m12 = (one_c * xy) - zs;\r\n        var m13 = (one_c * zx) + ys;\r\n        var m14 = 0.0;\r\n        var m21 = (one_c * xy) + zs;\r\n        var m22 = (one_c * yy) + c;\r\n        var m23 = (one_c * yz) - xs;\r\n        var m24 = 0.0;\r\n        var m31 = (one_c * zx) - ys;\r\n        var m32 = (one_c * yz) + xs;\r\n        var m33 = (one_c * zz) + c;\r\n        var m34 = 0.0;\r\n        var m41 = 0.0;\r\n        var m42 = 0.0;\r\n        var m43 = 0.0;\r\n        var m44 = 1.0;\r\n        var mat = new Matrix(m11, m12, m13, m14, m21, m22, m23, m24, m31, m32, m33, m34, m41, m42, m43, m44);\r\n        var result = mat.multiplyMatrix(this);\r\n        this.setMatrixByOther(result);\r\n    };\r\n    Matrix.prototype.localRotateX = function (radian) {\r\n        var transVertice = this.getPosition();\r\n        this.setPosition(new Vertice_1.default(0, 0, 0));\r\n        var columnX = this.getVectorX();\r\n        this.worldRotateByVector(radian, columnX);\r\n        this.setPosition(transVertice);\r\n    };\r\n    Matrix.prototype.localRotateY = function (radian) {\r\n        var transVertice = this.getPosition();\r\n        this.setPosition(new Vertice_1.default(0, 0, 0));\r\n        var columnY = this.getVectorY();\r\n        this.worldRotateByVector(radian, columnY);\r\n        this.setPosition(transVertice);\r\n    };\r\n    Matrix.prototype.localRotateZ = function (radian) {\r\n        var transVertice = this.getPosition();\r\n        this.setPosition(new Vertice_1.default(0, 0, 0));\r\n        var columnZ = this.getVectorZ();\r\n        this.worldRotateByVector(radian, columnZ);\r\n        this.setPosition(transVertice);\r\n    };\r\n    Matrix.prototype.localRotateByVector = function (radian, localVector) {\r\n        var localColumn = localVector.getArray();\r\n        localColumn.push(1);\r\n        var worldColumn = this.multiplyColumn(localColumn);\r\n        var worldVector = new Vector_1.default(worldColumn[0], worldColumn[1], worldColumn[2]);\r\n        var transVertice = this.getPosition();\r\n        this.setPosition(new Vertice_1.default(0, 0, 0));\r\n        this.worldRotateByVector(radian, worldVector);\r\n        this.setPosition(transVertice);\r\n    };\r\n    return Matrix;\r\n}());\r\nexports.default = Matrix;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/math/Matrix.ts\n// module id = 33\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar ImageUtils = {\r\n    MAX_LEVEL: 4,\r\n    images: {},\r\n    add: function (url, img) {\r\n        this.images[url] = img;\r\n    },\r\n    get: function (url) {\r\n        return this.images[url];\r\n    },\r\n    remove: function (url) {\r\n        delete this.images[url];\r\n    },\r\n    clear: function () {\r\n        this.images = {};\r\n    },\r\n    getCount: function () {\r\n        var count = 0;\r\n        for (var url in this.images) {\r\n            if (this.images.hasOwnProperty(url)) {\r\n                count++;\r\n            }\r\n        }\r\n        return count;\r\n    }\r\n};\r\nexports.default = ImageUtils;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Image.ts\n// module id = 34\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Extent_1 = require(\"../Extent\");\r\nvar Utils_1 = require(\"../math/Utils\");\r\nvar MeshTextureGraphic_1 = require(\"../graphics/MeshTextureGraphic\");\r\nvar TileMaterial_1 = require(\"../materials/TileMaterial\");\r\nvar TileGeometry_1 = require(\"../geometries/TileGeometry\");\r\nvar MeshVertice_1 = require(\"../geometries/MeshVertice\");\r\nvar Triangle_1 = require(\"../geometries/Triangle\");\r\nvar TileGrid_1 = require(\"../TileGrid\");\r\nvar TileInfo = (function () {\r\n    function TileInfo(level, row, column, url) {\r\n        this.level = level;\r\n        this.row = row;\r\n        this.column = column;\r\n        this.url = url;\r\n        this.minLon = null;\r\n        this.minLat = null;\r\n        this.maxLon = null;\r\n        this.maxLat = null;\r\n        this.minX = null;\r\n        this.minY = null;\r\n        this.maxX = null;\r\n        this.maxY = null;\r\n        this.segment = 1;\r\n        this._setTileInfo();\r\n        this._handleGlobeTile();\r\n        this.material = new TileMaterial_1.default(this.level, this.url);\r\n    }\r\n    TileInfo.prototype._setTileInfo = function () {\r\n        var Egeo = Utils_1.default.getTileGeographicEnvelopByGrid(this.level, this.row, this.column);\r\n        this.minLon = Egeo.minLon;\r\n        this.minLat = Egeo.minLat;\r\n        this.maxLon = Egeo.maxLon;\r\n        this.maxLat = Egeo.maxLat;\r\n        var minCoord = Utils_1.default.degreeGeographicToWebMercator(this.minLon, this.minLat);\r\n        var maxCoord = Utils_1.default.degreeGeographicToWebMercator(this.maxLon, this.maxLat);\r\n        this.minX = minCoord[0];\r\n        this.minY = minCoord[1];\r\n        this.maxX = maxCoord[0];\r\n        this.maxY = maxCoord[1];\r\n    };\r\n    TileInfo.prototype._handleGlobeTile = function () {\r\n        var BASE_LEVEL = Kernel_1.default.BASE_LEVEL;\r\n        if (this.level < BASE_LEVEL) {\r\n            var changeLevel = BASE_LEVEL - this.level;\r\n            this.segment = Math.pow(2, changeLevel);\r\n        }\r\n        else {\r\n            this.segment = 1;\r\n        }\r\n        this._handleTile();\r\n    };\r\n    TileInfo.prototype._handleTile = function () {\r\n        this.visible = true;\r\n        var verticeArray = [];\r\n        var triangleArray = [];\r\n        var vertices = [];\r\n        var indices = [];\r\n        var textureCoords = [];\r\n        var deltaX = (this.maxX - this.minX) / this.segment;\r\n        var deltaY = (this.maxY - this.minY) / this.segment;\r\n        var deltaTextureCoord = 1.0 / this.segment;\r\n        var levelDeltaR = 0;\r\n        var mercatorXs = [];\r\n        var mercatorYs = [];\r\n        var textureSs = [];\r\n        var textureTs = [];\r\n        var i, j;\r\n        for (i = 0; i <= this.segment; i++) {\r\n            mercatorXs.push(this.minX + i * deltaX);\r\n            mercatorYs.push(this.maxY - i * deltaY);\r\n            var b = i * deltaTextureCoord;\r\n            textureSs.push(b);\r\n            textureTs.push(1 - b);\r\n        }\r\n        var index = 0;\r\n        for (i = 0; i <= this.segment; i++) {\r\n            for (j = 0; j <= this.segment; j++) {\r\n                var merX = mercatorXs[j];\r\n                var merY = mercatorYs[i];\r\n                var ele = 0;\r\n                var lonlat = Utils_1.default.webMercatorToDegreeGeographic(merX, merY);\r\n                var p = Utils_1.default.geographicToCartesianCoord(lonlat[0], lonlat[1], Kernel_1.default.EARTH_RADIUS + ele + levelDeltaR).getArray();\r\n                vertices = vertices.concat(p);\r\n                textureCoords = textureCoords.concat(textureSs[j], textureTs[i]);\r\n                var v = new MeshVertice_1.default({\r\n                    p: p,\r\n                    i: index,\r\n                    uv: [textureSs[j], textureTs[i]]\r\n                });\r\n                verticeArray.push(v);\r\n                index++;\r\n            }\r\n        }\r\n        for (i = 0; i < this.segment; i++) {\r\n            for (j = 0; j < this.segment; j++) {\r\n                var idx0 = (this.segment + 1) * i + j;\r\n                var idx1 = (this.segment + 1) * (i + 1) + j;\r\n                var idx2 = idx1 + 1;\r\n                var idx3 = idx0 + 1;\r\n                indices = indices.concat(idx0, idx1, idx2);\r\n                indices = indices.concat(idx2, idx3, idx0);\r\n                var v0 = verticeArray[idx0];\r\n                var v1 = verticeArray[idx1];\r\n                var v2 = verticeArray[idx2];\r\n                var v3 = verticeArray[idx3];\r\n                var triangle1 = new Triangle_1.default(v0, v1, v2);\r\n                var triangle2 = new Triangle_1.default(v2, v3, v0);\r\n                triangleArray.push(triangle1, triangle2);\r\n            }\r\n        }\r\n        this.geometry = new TileGeometry_1.default(verticeArray, triangleArray);\r\n    };\r\n    return TileInfo;\r\n}());\r\nvar Tile = (function (_super) {\r\n    __extends(Tile, _super);\r\n    function Tile(geometry, material, tileInfo) {\r\n        var _this = _super.call(this, geometry, material) || this;\r\n        _this.geometry = geometry;\r\n        _this.material = material;\r\n        _this.tileInfo = tileInfo;\r\n        return _this;\r\n    }\r\n    Tile.getInstance = function (level, row, column, url) {\r\n        var tileInfo = new TileInfo(level, row, column, url);\r\n        return new Tile(tileInfo.geometry, tileInfo.material, tileInfo);\r\n    };\r\n    Tile.prototype.updateShaderUniforms = function (camera) {\r\n    };\r\n    Tile.prototype.getExtent = function () {\r\n        var tileInfo = this.tileInfo;\r\n        var tileGrid = new TileGrid_1.default(tileInfo.level, tileInfo.row, tileInfo.column);\r\n        return new Extent_1.default(this.tileInfo.minLon, this.tileInfo.minLat, this.tileInfo.maxLon, this.tileInfo.maxLat);\r\n    };\r\n    Tile.prototype.shouldDraw = function (camera) {\r\n        return this.tileInfo.visible && _super.prototype.shouldDraw.call(this, camera);\r\n    };\r\n    Tile.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this.subTiledLayer = null;\r\n    };\r\n    return Tile;\r\n}(MeshTextureGraphic_1.default));\r\nexports.default = Tile;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/Tile.ts\n// module id = 35\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Program_1 = require(\"../Program\");\r\nvar Graphic_1 = require(\"./Graphic\");\r\nvar vs = \"\\nattribute vec3 aPosition;\\nattribute vec2 aUV;\\nvarying vec2 vUV;\\nuniform mat4 uPMVMatrix;\\n\\nvoid main()\\n{\\n\\tgl_Position = uPMVMatrix * vec4(aPosition,1.0);\\n\\tvUV = aUV;\\n}\\n\";\r\nvar fs = \"\\nprecision mediump float;\\nvarying vec2 vUV;\\nuniform sampler2D uSampler;\\n\\nvoid main()\\n{\\n\\tgl_FragColor = texture2D(uSampler, vec2(vUV.s, vUV.t));\\n}\\n\";\r\nvar MeshTextureGraphic = (function (_super) {\r\n    __extends(MeshTextureGraphic, _super);\r\n    function MeshTextureGraphic(geometry, material, attributes) {\r\n        if (attributes === void 0) { attributes = null; }\r\n        var _this = _super.call(this, geometry, material, attributes) || this;\r\n        _this.geometry = geometry;\r\n        _this.material = material;\r\n        _this.attributes = attributes;\r\n        _this.geometry.calculateVBO();\r\n        _this.geometry.calculateIBO();\r\n        _this.geometry.calculateUVBO();\r\n        return _this;\r\n    }\r\n    MeshTextureGraphic.prototype.isGeometryReady = function () {\r\n        return !!this.geometry.vbo && !!this.geometry.ibo && !!this.geometry.uvbo;\r\n    };\r\n    MeshTextureGraphic.prototype.isReady = function () {\r\n        return this.isGeometryReady() && _super.prototype.isReady.call(this);\r\n    };\r\n    MeshTextureGraphic.findProgram = function () {\r\n        return Program_1.default.findProgram(vs, fs);\r\n    };\r\n    MeshTextureGraphic.prototype.createProgram = function () {\r\n        return Program_1.default.getProgram(vs, fs);\r\n    };\r\n    MeshTextureGraphic.prototype.updateShaderUniforms = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        var pmvMatrix = camera.getProjViewMatrixForDraw().multiplyMatrix(this.geometry.getMatrix());\r\n        var locPMVMatrix = this.program.getUniformLocation('uPMVMatrix');\r\n        gl.uniformMatrix4fv(locPMVMatrix, false, pmvMatrix.getFloat32Array());\r\n        gl.activeTexture(Kernel_1.default.gl.TEXTURE0);\r\n        var locSampler = this.program.getUniformLocation('uSampler');\r\n        gl.uniform1i(locSampler, 0);\r\n    };\r\n    MeshTextureGraphic.prototype.onDraw = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        this.updateShaderUniforms(camera);\r\n        var locPosition = this.program.getAttribLocation('aPosition');\r\n        this.program.enableVertexAttribArray('aPosition');\r\n        this.geometry.vbo.bind();\r\n        gl.vertexAttribPointer(locPosition, 3, Kernel_1.default.gl.FLOAT, false, 0, 0);\r\n        var locUV = this.program.getAttribLocation('aUV');\r\n        this.program.enableVertexAttribArray('aUV');\r\n        this.geometry.uvbo.bind();\r\n        gl.vertexAttribPointer(locUV, 2, Kernel_1.default.gl.FLOAT, false, 0, 0);\r\n        gl.bindTexture(Kernel_1.default.gl.TEXTURE_2D, this.material.texture);\r\n        this.geometry.ibo.bind();\r\n        var count = this.geometry.triangles.length * 3;\r\n        gl.drawElements(Kernel_1.default.gl.TRIANGLES, count, Kernel_1.default.gl.UNSIGNED_SHORT, 0);\r\n    };\r\n    MeshTextureGraphic.prototype.ifIntersectLocalLine = function (localLine) {\r\n        if (this.geometry) {\r\n            return this.geometry.ifIntersectLocalLine(localLine);\r\n        }\r\n        return false;\r\n    };\r\n    MeshTextureGraphic.prototype.ifIntersectWorldLine = function (worldLine) {\r\n        if (this.geometry) {\r\n            return this.geometry.ifIntersectWorldLine(worldLine);\r\n        }\r\n        return false;\r\n    };\r\n    return MeshTextureGraphic;\r\n}(Graphic_1.default));\r\nexports.default = MeshTextureGraphic;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/MeshTextureGraphic.ts\n// module id = 36\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar Program = (function () {\r\n    function Program(vs, fs) {\r\n        this.vs = vs;\r\n        this.fs = fs;\r\n        this.ready = false;\r\n        this.activeInfosObject = {};\r\n        this._init();\r\n    }\r\n    Program.getProgram = function (vs, fs) {\r\n        var program = Program.findProgram(vs, fs);\r\n        if (!program) {\r\n            program = new Program(vs, fs);\r\n            Program.programs.push(program);\r\n        }\r\n        return program;\r\n    };\r\n    Program.findProgram = function (vs, fs) {\r\n        var program = null;\r\n        Program.programs.some(function (item) {\r\n            if (item.vs === vs && item.fs === fs) {\r\n                program = item;\r\n                return true;\r\n            }\r\n            else {\r\n                return false;\r\n            }\r\n        });\r\n        return program;\r\n    };\r\n    Program.prototype.use = function () {\r\n        if (this.ready && Program.currentProgram !== this) {\r\n            Kernel_1.default.gl.useProgram(this.program);\r\n            Program.currentProgram = this;\r\n        }\r\n    };\r\n    Program.prototype.updateActiveAttribInfos = function () {\r\n        var count = Kernel_1.default.gl.getProgramParameter(this.program, Kernel_1.default.gl.ACTIVE_ATTRIBUTES);\r\n        for (var i = 0, activeInfo; i < count; i++) {\r\n            activeInfo = Kernel_1.default.gl.getActiveAttrib(this.program, i);\r\n            activeInfo.loc = Kernel_1.default.gl.getAttribLocation(this.program, activeInfo.name);\r\n            activeInfo.isAttribute = true;\r\n            this.activeInfosObject[activeInfo.name] = activeInfo;\r\n        }\r\n    };\r\n    Program.prototype.updateActiveUniformInfos = function () {\r\n        var count = Kernel_1.default.gl.getProgramParameter(this.program, Kernel_1.default.gl.ACTIVE_UNIFORMS);\r\n        for (var i = 0, activeInfo; i < count; i++) {\r\n            activeInfo = Kernel_1.default.gl.getActiveUniform(this.program, i);\r\n            activeInfo.loc = Kernel_1.default.gl.getUniformLocation(this.program, activeInfo.name);\r\n            activeInfo.isAttribute = false;\r\n            this.activeInfosObject[activeInfo.name] = activeInfo;\r\n        }\r\n    };\r\n    Program.prototype.getLocation = function (name) {\r\n        var loc = -1;\r\n        var activeInfo = this.activeInfosObject[name];\r\n        if (activeInfo) {\r\n            loc = activeInfo.loc;\r\n        }\r\n        return loc;\r\n    };\r\n    Program.prototype.getAttribLocation = function (name) {\r\n        var loc = -1;\r\n        var activeInfo = this.activeInfosObject[name];\r\n        if (activeInfo && activeInfo.isAttribute) {\r\n            loc = activeInfo.loc;\r\n        }\r\n        return loc;\r\n    };\r\n    Program.prototype.getUniformLocation = function (name) {\r\n        var loc;\r\n        var activeInfo = this.activeInfosObject[name];\r\n        if (activeInfo && !activeInfo.isAttribute) {\r\n            loc = activeInfo.loc;\r\n        }\r\n        return loc;\r\n    };\r\n    Program.prototype.getVertexAttrib = function () {\r\n    };\r\n    Program.prototype.getUniform = function (name) {\r\n        var result;\r\n        var loc = this.getUniformLocation(name);\r\n        if (loc) {\r\n            result = Kernel_1.default.gl.getUniform(this.program, loc);\r\n        }\r\n        return result;\r\n    };\r\n    Program.prototype.enableVertexAttribArray = function (name) {\r\n        var activeInfo = this.activeInfosObject[name];\r\n        if (activeInfo && activeInfo.isAttribute && activeInfo.isEnabled !== true) {\r\n            var loc = activeInfo.loc;\r\n            Kernel_1.default.gl.enableVertexAttribArray(loc);\r\n            activeInfo.isEnabled = true;\r\n        }\r\n    };\r\n    Program.prototype.disableVertexAttribArray = function (name) {\r\n        var activeInfo = this.activeInfosObject[name];\r\n        if (activeInfo && activeInfo.isAttribute && activeInfo.isEnabled !== false) {\r\n            var loc = activeInfo.loc;\r\n            Kernel_1.default.gl.disableVertexAttribArray(loc);\r\n            activeInfo.isEnabled = false;\r\n        }\r\n    };\r\n    Program.prototype._init = function () {\r\n        var vs = this._getShader(Kernel_1.default.gl.VERTEX_SHADER, this.vs);\r\n        if (!vs) {\r\n            return;\r\n        }\r\n        var fs = this._getShader(Kernel_1.default.gl.FRAGMENT_SHADER, this.fs);\r\n        if (!fs) {\r\n            return;\r\n        }\r\n        this.program = Kernel_1.default.gl.createProgram();\r\n        Kernel_1.default.gl.attachShader(this.program, vs);\r\n        Kernel_1.default.gl.attachShader(this.program, fs);\r\n        Kernel_1.default.gl.linkProgram(this.program);\r\n        if (!Kernel_1.default.gl.getProgramParameter(this.program, Kernel_1.default.gl.LINK_STATUS)) {\r\n            console.error(\"Could not link program!\");\r\n            Kernel_1.default.gl.deleteProgram(this.program);\r\n            Kernel_1.default.gl.deleteShader(vs);\r\n            Kernel_1.default.gl.deleteShader(fs);\r\n            this.program = null;\r\n            return;\r\n        }\r\n        this.updateActiveAttribInfos();\r\n        this.updateActiveUniformInfos();\r\n        this.ready = true;\r\n    };\r\n    Program.prototype._getShader = function (shaderType, shaderText) {\r\n        var shader = Kernel_1.default.gl.createShader(shaderType);\r\n        Kernel_1.default.gl.shaderSource(shader, shaderText);\r\n        Kernel_1.default.gl.compileShader(shader);\r\n        if (!Kernel_1.default.gl.getShaderParameter(shader, Kernel_1.default.gl.COMPILE_STATUS)) {\r\n            console.error(\"create shader failed\", Kernel_1.default.gl.getShaderInfoLog(shader));\r\n            Kernel_1.default.gl.deleteShader(shader);\r\n            return null;\r\n        }\r\n        return shader;\r\n    };\r\n    Program.programs = [];\r\n    return Program;\r\n}());\r\nexports.default = Program;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Program.ts\n// module id = 37\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Graphic = (function () {\r\n    function Graphic(geometry, material, attributes) {\r\n        if (geometry === void 0) { geometry = null; }\r\n        if (material === void 0) { material = null; }\r\n        if (attributes === void 0) { attributes = null; }\r\n        this.geometry = geometry;\r\n        this.material = material;\r\n        this.attributes = attributes;\r\n        this.visible = true;\r\n        this.id = ++Kernel_1.default.idCounter;\r\n        this.parent = null;\r\n        this.program = this.createProgram();\r\n    }\r\n    Graphic.prototype.setVisible = function (visible) {\r\n        this.visible = visible;\r\n    };\r\n    Graphic.prototype.isReady = function () {\r\n        return !!(this.geometry && this.material && this.material.isReady());\r\n    };\r\n    Graphic.prototype.shouldDraw = function (camera) {\r\n        return this.visible && this.isReady();\r\n    };\r\n    Graphic.prototype.draw = function (camera) {\r\n        if (this.shouldDraw(camera)) {\r\n            this.program.use();\r\n            this.onDraw(camera);\r\n        }\r\n    };\r\n    Graphic.prototype.destroy = function () {\r\n        this.parent = null;\r\n        if (this.geometry) {\r\n            this.geometry.destroy();\r\n        }\r\n        if (this.material) {\r\n            this.material.destroy();\r\n        }\r\n        this.geometry = null;\r\n        this.material = null;\r\n    };\r\n    return Graphic;\r\n}());\r\nexports.default = Graphic;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/Graphic.ts\n// module id = 38\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Triangle = (function () {\r\n    function Triangle(v1, v2, v3) {\r\n        this.v1 = v1;\r\n        this.v2 = v2;\r\n        this.v3 = v3;\r\n    }\r\n    Triangle.prototype.setColor = function (c) {\r\n        this.v1.c = this.v2.c = this.v3.c = c;\r\n    };\r\n    Triangle.assembleQuad = function (leftTop, leftBottom, rightTop, rightBottom) {\r\n        return [new Triangle(leftTop, leftBottom, rightTop), new Triangle(rightTop, leftBottom, rightBottom)];\r\n    };\r\n    return Triangle;\r\n}());\r\nexports.default = Triangle;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/geometries/Triangle.ts\n// module id = 39\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Line = (function () {\r\n    function Line(position, direction) {\r\n        this.vertice = position.clone();\r\n        this.vector = direction.clone();\r\n        this.vector.normalize();\r\n    }\r\n    Line.prototype.setVertice = function (position) {\r\n        this.vertice = position.clone();\r\n        return this;\r\n    };\r\n    Line.prototype.setVector = function (direction) {\r\n        this.vector = direction.clone();\r\n        this.vector.normalize();\r\n        return this;\r\n    };\r\n    Line.prototype.clone = function () {\r\n        var lineCopy = new Line(this.vertice, this.vector);\r\n        return lineCopy;\r\n    };\r\n    return Line;\r\n}());\r\nexports.default = Line;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/math/Line.ts\n// module id = 51\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Matrix_1 = require(\"./math/Matrix\");\r\nvar Object3D = (function () {\r\n    function Object3D() {\r\n        this.matrix = new Matrix_1.default();\r\n    }\r\n    Object3D.prototype.setMatrix = function (matrix) {\r\n        this.matrix = matrix;\r\n    };\r\n    Object3D.prototype.getMatrix = function () {\r\n        return this.matrix;\r\n    };\r\n    Object3D.prototype.cloneMatrix = function () {\r\n        return this.matrix.clone();\r\n    };\r\n    Object3D.prototype.setVectorX = function (vector) {\r\n        this.matrix.setVectorX(vector);\r\n    };\r\n    Object3D.prototype.getVectorX = function () {\r\n        return this.matrix.getVectorX();\r\n    };\r\n    Object3D.prototype.setVectorY = function (vector) {\r\n        this.matrix.setVectorY(vector);\r\n    };\r\n    Object3D.prototype.getVectorY = function () {\r\n        return this.matrix.getVectorY();\r\n    };\r\n    Object3D.prototype.setVectorZ = function (vector) {\r\n        this.matrix.setVectorZ(vector);\r\n    };\r\n    Object3D.prototype.getVectorZ = function () {\r\n        return this.matrix.getVectorZ();\r\n    };\r\n    Object3D.prototype.setPosition = function (vertice) {\r\n        this.matrix.setPosition(vertice);\r\n    };\r\n    Object3D.prototype.getPosition = function () {\r\n        return this.matrix.getPosition();\r\n    };\r\n    Object3D.prototype.worldTranslate = function (x, y, z) {\r\n        this.matrix.worldTranslate(x, y, z);\r\n    };\r\n    Object3D.prototype.localTranslate = function (x, y, z) {\r\n        this.matrix.localTranslate(x, y, z);\r\n    };\r\n    Object3D.prototype.worldScale = function (scaleX, scaleY, scaleZ) {\r\n        this.matrix.worldScale(scaleX, scaleY, scaleZ);\r\n    };\r\n    Object3D.prototype.localScale = function (scaleX, scaleY, scaleZ) {\r\n        this.matrix.localScale(scaleX, scaleY, scaleZ);\r\n    };\r\n    Object3D.prototype.worldRotateX = function (radian) {\r\n        this.matrix.worldRotateX(radian);\r\n    };\r\n    Object3D.prototype.worldRotateY = function (radian) {\r\n        this.matrix.worldRotateY(radian);\r\n    };\r\n    Object3D.prototype.worldRotateZ = function (radian) {\r\n        this.matrix.worldRotateZ(radian);\r\n    };\r\n    Object3D.prototype.worldRotateByVector = function (radian, vector) {\r\n        this.matrix.worldRotateByVector(radian, vector);\r\n    };\r\n    Object3D.prototype.localRotateX = function (radian) {\r\n        this.matrix.localRotateX(radian);\r\n    };\r\n    Object3D.prototype.localRotateY = function (radian) {\r\n        this.matrix.localRotateY(radian);\r\n    };\r\n    Object3D.prototype.localRotateZ = function (radian) {\r\n        this.matrix.localRotateZ(radian);\r\n    };\r\n    Object3D.prototype.localRotateByVector = function (radian, localVector) {\r\n        this.matrix.localRotateByVector(radian, localVector);\r\n    };\r\n    Object3D.prototype.getXAxisDirection = function () {\r\n        var directionX = this.matrix.getVectorX();\r\n        directionX.normalize();\r\n        return directionX;\r\n    };\r\n    Object3D.prototype.getYAxisDirection = function () {\r\n        var directionY = this.matrix.getVectorY();\r\n        directionY.normalize();\r\n        return directionY;\r\n    };\r\n    Object3D.prototype.getZAxisDirection = function () {\r\n        var directionZ = this.matrix.getVectorZ();\r\n        directionZ.normalize();\r\n        return directionZ;\r\n    };\r\n    return Object3D;\r\n}());\r\nexports.default = Object3D;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Object3D.ts\n// module id = 52\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Utils_1 = require(\"../Utils\");\r\nvar Tile_1 = require(\"../graphics/Tile\");\r\nvar GraphicGroup_1 = require(\"../GraphicGroup\");\r\nvar SubTiledLayer_1 = require(\"./SubTiledLayer\");\r\nvar TiledLayer = (function (_super) {\r\n    __extends(TiledLayer, _super);\r\n    function TiledLayer(style) {\r\n        if (style === void 0) { style = \"\"; }\r\n        var _this = _super.call(this) || this;\r\n        _this.style = style;\r\n        _this.imageRequestOptimizeDeltaLevel = 2;\r\n        _this.globe = null;\r\n        var subLayer0 = new SubTiledLayer_1.default(0);\r\n        _this.add(subLayer0);\r\n        var subLayer1 = new SubTiledLayer_1.default(1);\r\n        _this.add(subLayer1);\r\n        return _this;\r\n    }\r\n    TiledLayer.prototype.destroy = function () {\r\n        this.globe = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    TiledLayer.prototype._checkSubLayer1 = function () {\r\n        var subLayer1 = this.children[1];\r\n        if (subLayer1 && subLayer1.getLevel() === 1) {\r\n            if (subLayer1.children.length !== 4) {\r\n                subLayer1.children = [];\r\n                for (var m = 0; m <= 1; m++) {\r\n                    for (var n = 0; n <= 1; n++) {\r\n                        var args = {\r\n                            level: 1,\r\n                            row: m,\r\n                            column: n,\r\n                            url: \"\"\r\n                        };\r\n                        args.url = this.getTileUrl(args.level, args.row, args.column);\r\n                        var tile = Tile_1.default.getInstance(args.level, args.row, args.column, args.url);\r\n                        subLayer1.add(tile);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TiledLayer.prototype.refresh = function () {\r\n        if (!this.globe) {\r\n            return;\r\n        }\r\n        this._checkSubLayer1();\r\n        var camera = this.globe.camera;\r\n        var level = this.globe.getLevel();\r\n        var options = {\r\n            threshold: 1\r\n        };\r\n        options.threshold = 1;\r\n        var lastLevelTileGrids = camera.getVisibleTilesByLevel(level, options);\r\n        var levelsTileGrids = [];\r\n        var parentTileGrids = lastLevelTileGrids;\r\n        var subLevel;\r\n        for (subLevel = level; subLevel >= 2; subLevel--) {\r\n            levelsTileGrids[subLevel] = parentTileGrids;\r\n            parentTileGrids = parentTileGrids.map(function (item) {\r\n                return item.getParent();\r\n            });\r\n            parentTileGrids = Utils_1.default.filterRepeatArray(parentTileGrids);\r\n        }\r\n        for (subLevel = 2; subLevel <= level; subLevel++) {\r\n            var addNew = level === subLevel || (level - subLevel) > this.imageRequestOptimizeDeltaLevel;\r\n            this.children[subLevel].updateTiles(subLevel, levelsTileGrids[subLevel], addNew);\r\n        }\r\n    };\r\n    TiledLayer.prototype.updateSubLayerCount = function () {\r\n        if (!this.globe) {\r\n            return;\r\n        }\r\n        var level = this.globe.getLevel();\r\n        var subLayerCount = this.children.length;\r\n        var deltaLevel = level + 1 - subLayerCount;\r\n        var i, subLayer;\r\n        if (deltaLevel > 0) {\r\n            for (i = 0; i < deltaLevel; i++) {\r\n                subLayer = new SubTiledLayer_1.default(i + subLayerCount);\r\n                this.add(subLayer);\r\n            }\r\n        }\r\n        else if (deltaLevel < 0) {\r\n            deltaLevel *= -1;\r\n            for (i = 0; i < deltaLevel; i++) {\r\n                var removeLevel = this.children.length - 1;\r\n                if (removeLevel >= 2) {\r\n                    subLayer = this.children[removeLevel];\r\n                    this.remove(subLayer);\r\n                }\r\n                else {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    TiledLayer.prototype._getReadyTile = function (tileGrid) {\r\n        var level = tileGrid.level;\r\n        var row = tileGrid.row;\r\n        var column = tileGrid.column;\r\n        var tile = this.children[level].findTile(level, row, column);\r\n        if (level === 1) {\r\n            return tile;\r\n        }\r\n        else {\r\n            if (tile && tile.isReady()) {\r\n                return tile;\r\n            }\r\n            else {\r\n                return this._getReadyTile(tileGrid.getParent());\r\n            }\r\n        }\r\n    };\r\n    TiledLayer.prototype.updateTileVisibility = function () {\r\n        var _this = this;\r\n        if (!this.globe) {\r\n            return;\r\n        }\r\n        var level = this.globe.getLevel();\r\n        this.children.forEach(function (subTiledLayer) {\r\n            subTiledLayer.showAllTiles();\r\n        });\r\n        var ancesorLevel = level - this.imageRequestOptimizeDeltaLevel - 1;\r\n        if (ancesorLevel >= 1) {\r\n            var camera = this.globe.camera;\r\n            var tileGrids = camera.getTileGridsOfBoundary(ancesorLevel, false);\r\n            if (tileGrids.length === 8) {\r\n                tileGrids = Utils_1.default.filterRepeatArray(tileGrids);\r\n                for (var i = 0; i <= ancesorLevel; i++) {\r\n                    this.children[i].hideAllTiles();\r\n                }\r\n                tileGrids.forEach(function (tileGrid) {\r\n                    var tile = _this._getReadyTile(tileGrid);\r\n                    if (tile) {\r\n                        tile.setVisible(true);\r\n                        tile.parent.visible = true;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    };\r\n    TiledLayer.prototype.onDraw = function (camera) {\r\n        var gl = this.globe && this.globe.gl;\r\n        if (!gl) {\r\n            return;\r\n        }\r\n        var program = Tile_1.default.findProgram();\r\n        if (!program) {\r\n            return;\r\n        }\r\n        program.use();\r\n        var pmvMatrix = camera.getProjViewMatrixForDraw();\r\n        var locPMVMatrix = program.getUniformLocation('uPMVMatrix');\r\n        gl.uniformMatrix4fv(locPMVMatrix, false, pmvMatrix.getFloat32Array());\r\n        gl.activeTexture(Kernel_1.default.gl.TEXTURE0);\r\n        var locSampler = program.getUniformLocation('uSampler');\r\n        gl.uniform1i(locSampler, 0);\r\n        gl.depthFunc(Kernel_1.default.gl.ALWAYS);\r\n        _super.prototype.onDraw.call(this, camera);\r\n        gl.depthFunc(Kernel_1.default.gl.LEQUAL);\r\n    };\r\n    TiledLayer.prototype.getExtent = function () {\r\n        if (this.globe.isRenderingPaused()) {\r\n            return null;\r\n        }\r\n        var subTiledLayer = this.children[this.children.length - 1];\r\n        return subTiledLayer.getExtent();\r\n    };\r\n    TiledLayer.prototype.wrapUrlWithProxy = function (url) {\r\n        return Utils_1.default.wrapUrlWithProxy(url);\r\n    };\r\n    TiledLayer.prototype.getLastLevelVisibleTileGrids = function () {\r\n        var tileGrids = null;\r\n        var subTiledLayer = this.children[this.children.length - 1];\r\n        if (subTiledLayer) {\r\n            tileGrids = subTiledLayer.getVisibleTileGrids();\r\n        }\r\n        return tileGrids;\r\n    };\r\n    TiledLayer.prototype.logVisibleTiles = function () {\r\n        var result = [];\r\n        this.children.forEach(function (subLayer) {\r\n            var allCount = subLayer.children.length;\r\n            var visibleCount = subLayer.getShouldDrawTilesCount();\r\n            result.push({\r\n                level: subLayer.getLevel(),\r\n                allCount: allCount,\r\n                visibleCount: visibleCount\r\n            });\r\n        });\r\n        console.table(result);\r\n    };\r\n    return TiledLayer;\r\n}(GraphicGroup_1.default));\r\n;\r\nexports.default = TiledLayer;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/TiledLayer.ts\n// module id = 53\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Material = (function () {\r\n    function Material() {\r\n    }\r\n    return Material;\r\n}());\r\nexports.default = Material;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/materials/Material.ts\n// module id = 54\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar maxBufferSize = 200;\r\nvar buffers = [];\r\nvar VertexBufferObject = (function () {\r\n    function VertexBufferObject(target) {\r\n        this.target = target;\r\n        if (buffers.length > 0) {\r\n            this.buffer = buffers.pop();\r\n        }\r\n        else {\r\n            this.buffer = Kernel_1.default.gl.createBuffer();\r\n        }\r\n    }\r\n    VertexBufferObject.prototype.bind = function () {\r\n        Kernel_1.default.gl.bindBuffer(this.target, this.buffer);\r\n    };\r\n    VertexBufferObject.prototype.bufferData = function (data, usage, hasBinded) {\r\n        if (hasBinded === void 0) { hasBinded = false; }\r\n        if (!hasBinded) {\r\n            this.bind();\r\n        }\r\n        var gl = Kernel_1.default.gl;\r\n        if (this.target === Kernel_1.default.gl.ARRAY_BUFFER) {\r\n            gl.bufferData(Kernel_1.default.gl.ARRAY_BUFFER, new Float32Array(data), usage);\r\n        }\r\n        else if (this.target === Kernel_1.default.gl.ELEMENT_ARRAY_BUFFER) {\r\n            gl.bufferData(Kernel_1.default.gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(data), usage);\r\n        }\r\n    };\r\n    VertexBufferObject.prototype.destroy = function () {\r\n        if (this.buffer) {\r\n            if (buffers.length < maxBufferSize) {\r\n                buffers.push(this.buffer);\r\n            }\r\n            else {\r\n                Kernel_1.default.gl.deleteBuffer(this.buffer);\r\n            }\r\n        }\r\n        this.buffer = null;\r\n    };\r\n    return VertexBufferObject;\r\n}());\r\nexports.default = VertexBufferObject;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/VertexBufferObject.ts\n// module id = 55\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Extent_1 = require(\"../Extent\");\r\nvar TileGrid_1 = require(\"../TileGrid\");\r\nvar GraphicGroup_1 = require(\"../GraphicGroup\");\r\nvar Tile_1 = require(\"../graphics/Tile\");\r\nvar SubTiledLayer = (function (_super) {\r\n    __extends(SubTiledLayer, _super);\r\n    function SubTiledLayer(level) {\r\n        var _this = _super.call(this) || this;\r\n        _this.level = level;\r\n        return _this;\r\n    }\r\n    SubTiledLayer.prototype.getLevel = function () {\r\n        return this.level;\r\n    };\r\n    SubTiledLayer.prototype.showAllTiles = function () {\r\n        this.visible = true;\r\n        this.children.forEach(function (tile) {\r\n            tile.setVisible(true);\r\n        });\r\n    };\r\n    SubTiledLayer.prototype.hideAllTiles = function () {\r\n        this.visible = false;\r\n        this.children.forEach(function (tile) {\r\n            tile.setVisible(false);\r\n        });\r\n    };\r\n    SubTiledLayer.prototype.add = function (tile) {\r\n        if (tile.tileInfo.level === this.level) {\r\n            _super.prototype.add.call(this, tile);\r\n            tile.subTiledLayer = this;\r\n        }\r\n    };\r\n    SubTiledLayer.prototype.findTile = function (level, row, column) {\r\n        var length = this.children.length;\r\n        for (var i = 0; i < length; i++) {\r\n            var tile = this.children[i];\r\n            if (tile.tileInfo.level === level && tile.tileInfo.row === row && tile.tileInfo.column === column) {\r\n                return tile;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    SubTiledLayer.prototype.updateTiles = function (level, visibleTileGrids, addNew) {\r\n        this.level = level;\r\n        function checkTileExist(tileArray, lev, row, col) {\r\n            var result = {\r\n                isExist: false,\r\n                index: -1\r\n            };\r\n            for (var m = 0; m < tileArray.length; m++) {\r\n                var tileInfo = tileArray[m];\r\n                if (tileInfo.level === lev && tileInfo.row === row && tileInfo.column === col) {\r\n                    result.isExist = true;\r\n                    result.index = m;\r\n                    return result;\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        var tilesNeedDelete = [];\r\n        var i, tile;\r\n        for (i = 0; i < this.children.length; i++) {\r\n            tile = this.children[i];\r\n            var checkResult = checkTileExist(visibleTileGrids, tile.tileInfo.level, tile.tileInfo.row, tile.tileInfo.column);\r\n            var isExist = checkResult.isExist;\r\n            if (isExist) {\r\n                visibleTileGrids.splice(checkResult.index, 1);\r\n            }\r\n            else {\r\n                tilesNeedDelete.push(tile);\r\n            }\r\n        }\r\n        while (tilesNeedDelete.length > 0) {\r\n            var b = this.remove(tilesNeedDelete[0]);\r\n            tilesNeedDelete.splice(0, 1);\r\n            if (!b) {\r\n                console.debug(\"subTiledLayer.remove(tilesNeedDelete[0])失败\");\r\n            }\r\n        }\r\n        if (addNew) {\r\n            for (i = 0; i < visibleTileGrids.length; i++) {\r\n                var tileGridInfo = visibleTileGrids[i];\r\n                var args = {\r\n                    level: tileGridInfo.level,\r\n                    row: tileGridInfo.row,\r\n                    column: tileGridInfo.column,\r\n                    url: \"\"\r\n                };\r\n                args.url = this.getTileUrl(args.level, args.row, args.column);\r\n                tile = Tile_1.default.getInstance(args.level, args.row, args.column, args.url);\r\n                this.add(tile);\r\n            }\r\n        }\r\n    };\r\n    SubTiledLayer.prototype.getTileUrl = function (level, row, column) {\r\n        if (this.parent && typeof this.parent.getTileUrl === \"function\") {\r\n            return this.parent.getTileUrl(level, row, column);\r\n        }\r\n        return \"\";\r\n    };\r\n    SubTiledLayer.prototype.checkIfAllTilesLoaded = function () {\r\n        for (var i = 0; i < this.children.length; i++) {\r\n            var tile = this.children[i];\r\n            if (tile) {\r\n                var isTileLoaded = tile.material.isReady();\r\n                if (!isTileLoaded) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    };\r\n    SubTiledLayer.prototype.getExtent = function () {\r\n        return Extent_1.default.union(this.getExtents());\r\n    };\r\n    SubTiledLayer.prototype.getExtents = function () {\r\n        return this.children.map(function (item) { return item.getExtent(); });\r\n    };\r\n    SubTiledLayer.prototype.getVisibleTileGrids = function () {\r\n        var tileGrids = [];\r\n        if (this.visible) {\r\n            this.children.forEach(function (tile) {\r\n                if (tile.visible) {\r\n                    tileGrids.push(new TileGrid_1.default(tile.tileInfo.level, tile.tileInfo.row, tile.tileInfo.column));\r\n                }\r\n            });\r\n        }\r\n        return tileGrids;\r\n    };\r\n    SubTiledLayer.prototype.getShouldDrawTilesCount = function () {\r\n        return this.visible ? this.children.filter(function (tile) {\r\n            return tile.visible && tile.isReady();\r\n        }).length : 0;\r\n    };\r\n    return SubTiledLayer;\r\n}(GraphicGroup_1.default));\r\nexports.default = SubTiledLayer;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/SubTiledLayer.ts\n// module id = 56\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Tile_1 = require(\"../graphics/Tile\");\r\nvar SubTiledLayer_1 = require(\"./SubTiledLayer\");\r\nvar LabelLayer = (function (_super) {\r\n    __extends(LabelLayer, _super);\r\n    function LabelLayer() {\r\n        var _this = _super.call(this, -1) || this;\r\n        _this.minLevel = 4;\r\n        return _this;\r\n    }\r\n    LabelLayer.prototype.onDraw = function (camera) {\r\n        var program = Tile_1.default.findProgram();\r\n        if (!program) {\r\n            return;\r\n        }\r\n        program.use();\r\n        var gl = Kernel_1.default.gl;\r\n        gl.enable(gl.BLEND);\r\n        gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n        var pmvMatrix = camera.getProjViewMatrixForDraw();\r\n        var locPMVMatrix = program.getUniformLocation('uPMVMatrix');\r\n        gl.uniformMatrix4fv(locPMVMatrix, false, pmvMatrix.getFloat32Array());\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        var locSampler = program.getUniformLocation('uSampler');\r\n        gl.uniform1i(locSampler, 0);\r\n        gl.depthFunc(gl.ALWAYS);\r\n        _super.prototype.onDraw.call(this, camera);\r\n        gl.depthFunc(gl.LEQUAL);\r\n        gl.disable(gl.BLEND);\r\n    };\r\n    LabelLayer.prototype.updateTiles = function (level, visibleTileGrids) {\r\n        var _this = this;\r\n        var validTileGrids = visibleTileGrids.filter(function (tileGrid) { return tileGrid.level >= _this.minLevel; });\r\n        _super.prototype.updateTiles.call(this, level, validTileGrids, true);\r\n    };\r\n    return LabelLayer;\r\n}(SubTiledLayer_1.default));\r\nexports.default = LabelLayer;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/LabelLayer.ts\n// module id = 57\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.devicePixelRatio = window.devicePixelRatio;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Env.ts\n// module id = 58\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Utils_1 = require(\"../math/Utils\");\r\nvar Program_1 = require(\"../Program\");\r\nvar Graphic_1 = require(\"../graphics/Graphic\");\r\nvar VertexBufferObject_1 = require(\"../VertexBufferObject\");\r\nvar vs = \"\\nattribute vec3 aPosition;\\nuniform mat4 uPMVMatrix;\\nuniform float uSize;\\n\\nvoid main(void) {\\n  gl_Position = uPMVMatrix * vec4(aPosition, 1.0);\\n  gl_PointSize = uSize;\\n}\\n\";\r\nvar fs = \"\\nprecision mediump float;\\nuniform sampler2D uSampler;\\n\\nvoid main()\\n{\\n\\tvec4 color = texture2D(uSampler, vec2(gl_PointCoord.x, gl_PointCoord.y));\\n  if(color.a == 0.0){\\n    discard;\\n  }\\n  gl_FragColor = color;\\n}\\n\";\r\nvar MultiPointsGraphic = (function (_super) {\r\n    __extends(MultiPointsGraphic, _super);\r\n    function MultiPointsGraphic(material) {\r\n        var _this = _super.call(this, null, material) || this;\r\n        _this.material = material;\r\n        _this.vbo = null;\r\n        _this.vertices = null;\r\n        _this.vbo = new VertexBufferObject_1.default(Kernel_1.default.gl.ARRAY_BUFFER);\r\n        _this.vertices = [];\r\n        return _this;\r\n    }\r\n    MultiPointsGraphic.prototype.createProgram = function () {\r\n        return Program_1.default.getProgram(vs, fs);\r\n    };\r\n    MultiPointsGraphic.prototype.isReady = function () {\r\n        return !!(this.vertices.length > 0 && this.material && this.material.isReady());\r\n    };\r\n    MultiPointsGraphic.prototype.onDraw = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        gl.disable(Kernel_1.default.gl.DEPTH_TEST);\r\n        gl.depthMask(false);\r\n        gl.enable(Kernel_1.default.gl.BLEND);\r\n        gl.blendFunc(Kernel_1.default.gl.SRC_ALPHA, Kernel_1.default.gl.ONE_MINUS_SRC_ALPHA);\r\n        var locPosition = this.program.getAttribLocation('aPosition');\r\n        this.program.enableVertexAttribArray('aPosition');\r\n        this.vbo.bind();\r\n        var vertices = [];\r\n        this.vertices.map(function (vertice) {\r\n            vertices.push(vertice.x, vertice.y, vertice.z);\r\n        });\r\n        this.vbo.bufferData(vertices, Kernel_1.default.gl.DYNAMIC_DRAW, true);\r\n        gl.vertexAttribPointer(locPosition, 3, Kernel_1.default.gl.FLOAT, false, 0, 0);\r\n        var pmvMatrix = camera.getProjViewMatrixForDraw();\r\n        var locPMVMatrix = this.program.getUniformLocation('uPMVMatrix');\r\n        gl.uniformMatrix4fv(locPMVMatrix, false, pmvMatrix.getFloat32Array());\r\n        var locSize = this.program.getUniformLocation('uSize');\r\n        gl.uniform1f(locSize, this.material.size);\r\n        var locSampler = this.program.getUniformLocation('uSampler');\r\n        gl.activeTexture(gl.TEXTURE0);\r\n        gl.bindTexture(gl.TEXTURE_2D, this.material.texture);\r\n        gl.uniform1i(locSampler, 0);\r\n        gl.drawArrays(gl.POINTS, 0, vertices.length / 3);\r\n        gl.enable(gl.DEPTH_TEST);\r\n        gl.depthMask(true);\r\n        gl.disable(gl.BLEND);\r\n    };\r\n    MultiPointsGraphic.prototype.setLonlats = function (lonlats) {\r\n        var _this = this;\r\n        MultiPointsGraphic.prototype.clear.apply(this);\r\n        this.vertices = [];\r\n        lonlats.forEach(function (lonlat) {\r\n            var p = Utils_1.default.geographicToCartesianCoord(lonlat[0], lonlat[1], Kernel_1.default.EARTH_RADIUS + 0.001);\r\n            _this.vertices.push(p);\r\n        });\r\n    };\r\n    MultiPointsGraphic.prototype.clear = function () {\r\n        this.vertices = [];\r\n    };\r\n    return MultiPointsGraphic;\r\n}(Graphic_1.default));\r\nexports.default = MultiPointsGraphic;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/MultiPointsGraphic.ts\n// module id = 59\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar MeshTextureMaterial_1 = require(\"./MeshTextureMaterial\");\r\nvar MarkerTextureMaterial = (function (_super) {\r\n    __extends(MarkerTextureMaterial, _super);\r\n    function MarkerTextureMaterial(imageOrUrl, size) {\r\n        if (size === void 0) { size = 16; }\r\n        var _this = _super.call(this, imageOrUrl, false) || this;\r\n        _this.size = size;\r\n        return _this;\r\n    }\r\n    return MarkerTextureMaterial;\r\n}(MeshTextureMaterial_1.default));\r\nexports.default = MarkerTextureMaterial;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/materials/MarkerTextureMaterial.ts\n// module id = 60\n// module chunks = 0 1","!function(t,e){\"object\"==typeof exports&&\"undefined\"!=typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define(e):t.ES6Promise=e()}(this,function(){\"use strict\";function t(t){var e=typeof t;return null!==t&&(\"object\"===e||\"function\"===e)}function e(t){return\"function\"==typeof t}function n(t){B=t}function r(t){G=t}function o(){return function(){return process.nextTick(a)}}function i(){return\"undefined\"!=typeof z?function(){z(a)}:c()}function s(){var t=0,e=new J(a),n=document.createTextNode(\"\");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<W;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}W=0}function f(){try{var t=Function(\"return this\")().require(\"vertx\");return z=t.runOnLoop||t.runOnContext,i()}catch(e){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[Z]&&O(r);var o=n._state;if(o){var i=arguments[o-1];G(function(){return P(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&\"object\"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function v(){return new TypeError(\"You cannot resolve a promise with itself\")}function d(){return new TypeError(\"A promises callback cannot return that same promise.\")}function _(t){try{return t.then}catch(e){return nt.error=e,nt}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){G(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},\"Settle: \"+(t._label||\" unknown promise\"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===tt?S(t,e._result):e._state===et?j(t,e._result):E(e,void 0,function(e){return g(t,e)},function(e){return j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===nt?(j(t,nt.error),nt.error=null):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,v()):t(n)?w(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===$&&(t._result=e,t._state=tt,0!==t._subscribers.length&&G(T,t))}function j(t,e){t._state===$&&(t._state=et,t._result=e,G(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+tt]=n,o[i+et]=r,0===i&&t._state&&G(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function M(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function P(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==$||(i&&c?g(n,s):a?j(n,u):t===tt?S(n,s):t===et&&j(n,s))}function x(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function C(){return rt++}function O(t){t[Z]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error(\"Array Methods must be provided an Array\")}function F(t){return new ot(this,t).promise}function Y(t){var e=this;return new e(U(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError(\"You must pass an array to race.\"))})}function q(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError(\"You must pass a resolver function as the first argument to the promise constructor\")}function K(){throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\")}function L(){var t=void 0;if(\"undefined\"!=typeof global)t=global;else if(\"undefined\"!=typeof self)t=self;else try{t=Function(\"return this\")()}catch(e){throw new Error(\"polyfill failed because global object is unavailable in this environment\")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if(\"[object Promise]\"===r&&!n.cast)return}t.Promise=it}var N=void 0;N=Array.isArray?Array.isArray:function(t){return\"[object Array]\"===Object.prototype.toString.call(t)};var U=N,W=0,z=void 0,B=void 0,G=function(t,e){V[W]=t,V[W+1]=e,W+=2,2===W&&(B?B(a):X())},H=\"undefined\"!=typeof window?window:void 0,I=H||{},J=I.MutationObserver||I.WebKitMutationObserver,Q=\"undefined\"==typeof self&&\"undefined\"!=typeof process&&\"[object process]\"==={}.toString.call(process),R=\"undefined\"!=typeof Uint8ClampedArray&&\"undefined\"!=typeof importScripts&&\"undefined\"!=typeof MessageChannel,V=new Array(1e3),X=void 0;X=Q?o():J?s():R?u():void 0===H&&\"function\"==typeof require?f():c();var Z=Math.random().toString(36).substring(2),$=void 0,tt=1,et=2,nt={error:null},rt=0,ot=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[Z]||O(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&S(this.promise,this._result))):j(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===$&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==$)this._settledAt(t._state,e,t._result);else if(\"function\"!=typeof o)this._remaining--,this._result[e]=t;else if(n===it){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===$&&(this._remaining--,t===et?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(tt,e,t)},function(t){return n._settledAt(et,e,t)})},t}(),it=function(){function t(e){this[Z]=C(),this._result=this._state=void 0,this._subscribers=[],p!==e&&(\"function\"!=typeof e&&D(),this instanceof t?x(this,e):K())}return t.prototype[\"catch\"]=function(t){return this.then(null,t)},t.prototype[\"finally\"]=function(t){var n=this,r=n.constructor;return e(t)?n.then(function(e){return r.resolve(t()).then(function(){return e})},function(e){return r.resolve(t()).then(function(){throw e})}):n.then(t,t)},t}();return it.prototype.then=l,it.all=F,it.race=Y,it.resolve=h,it.reject=q,it._setScheduler=n,it._setAsap=r,it._asap=G,it.polyfill=L,it.Promise=it,it.polyfill(),it});\n\n\n// WEBPACK FOOTER //\n// ./node_modules/es6-promise/dist/es6-promise.auto.min.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/global.js","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Renderer_1 = require(\"./Renderer\");\r\nvar Camera_1 = require(\"./Camera\");\r\nvar Scene_1 = require(\"./Scene\");\r\nvar Image_1 = require(\"./Image\");\r\nvar EventHandler_1 = require(\"./EventHandler\");\r\nvar Google_1 = require(\"./layers/Google\");\r\nvar Autonavi_1 = require(\"./layers/Autonavi\");\r\nvar Atmosphere_1 = require(\"./graphics/Atmosphere\");\r\nvar LocationGraphic_1 = require(\"./graphics/LocationGraphic\");\r\nvar PoiLayer_1 = require(\"./layers/PoiLayer\");\r\nvar RouteLayer_1 = require(\"./layers/RouteLayer\");\r\nvar Extent_1 = require(\"./Extent\");\r\nvar Service_1 = require(\"./Service\");\r\nvar Env_1 = require(\"./Env\");\r\nvar initLevel = Utils_1.default.isMobile() ? 11 : 3;\r\nvar initLonlat = [116.3975, 39.9085];\r\nvar GlobeOptions = (function () {\r\n    function GlobeOptions() {\r\n        this.pauseRendering = false;\r\n        this.satellite = true;\r\n        this.level = 'auto';\r\n        this.lonlat = 'auto';\r\n        this.key = \"\";\r\n    }\r\n    return GlobeOptions;\r\n}());\r\nexports.GlobeOptions = GlobeOptions;\r\nvar Globe = (function () {\r\n    function Globe(canvas, width, height, options) {\r\n        var _this = this;\r\n        this.canvas = canvas;\r\n        this.options = options;\r\n        this.renderer = null;\r\n        this.scene = null;\r\n        this.camera = null;\r\n        this.tiledLayer = null;\r\n        this.labelLayer = null;\r\n        this.trafficLayer = null;\r\n        this.poiLayer = null;\r\n        this.routeLayer = null;\r\n        this.locationGraphic = null;\r\n        this.debugStopRefreshTiles = false;\r\n        this.REFRESH_INTERVAL = 150;\r\n        this.lastRefreshTimestamp = -1;\r\n        this.lastRefreshCameraCore = null;\r\n        this.eventHandler = null;\r\n        this.allRefreshCount = 0;\r\n        this.realRefreshCount = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.afterRenderCallbacks = [];\r\n        this.gl = null;\r\n        if (!this.options) {\r\n            this.options = new GlobeOptions();\r\n        }\r\n        this.resizeCanvas(width, height);\r\n        this.renderer = new Renderer_1.default(canvas, this._onBeforeRender.bind(this), this._onAfterRender.bind(this));\r\n        this.gl = this.renderer.gl;\r\n        this.scene = new Scene_1.default();\r\n        var radio = this.width / this.height;\r\n        var level = this.options.level >= 0 ? this.options.level : initLevel;\r\n        var lonlat = (this.options.lonlat && this.options.lonlat.length === 2) ? this.options.lonlat : initLonlat;\r\n        this.camera = new Camera_1.default(width, height, 30, radio, 1, Kernel_1.default.EARTH_RADIUS * 2, level, lonlat, options.resolutionFactor);\r\n        this.renderer.setScene(this.scene);\r\n        this.renderer.setCamera(this.camera);\r\n        if (this.options.satellite) {\r\n            this._setTiledLayer(new Google_1.GoogleTiledLayer(\"Default\"), this.options.pauseRendering);\r\n        }\r\n        else {\r\n            this._setTiledLayer(new Autonavi_1.AutonaviTiledLayer(), this.options.pauseRendering);\r\n        }\r\n        var atmosphere = Atmosphere_1.default.getInstance();\r\n        this.scene.add(atmosphere);\r\n        this.routeLayer = RouteLayer_1.default.getInstance(this.camera, this.options.key);\r\n        this.scene.add(this.routeLayer);\r\n        this.poiLayer = PoiLayer_1.default.getInstance();\r\n        this.poiLayer.globe = this;\r\n        this.scene.add(this.poiLayer);\r\n        this.locationGraphic = LocationGraphic_1.default.getInstance(this);\r\n        this.scene.add(this.locationGraphic);\r\n        this.eventHandler = new EventHandler_1.default(this);\r\n        if (this.options.pauseRendering !== true) {\r\n            this.renderer.resumeRendering();\r\n        }\r\n        var locationCallback = function (location) {\r\n            if (location) {\r\n                _this.afterRenderCallbacks.push(function () {\r\n                    _this.updateUserLocation(location);\r\n                });\r\n            }\r\n        };\r\n        Service_1.default.getCurrentPosition(false).then(locationCallback).then(function () {\r\n            if (Utils_1.default.isMobile()) {\r\n                Service_1.default.getCurrentPosition(true).then(locationCallback);\r\n            }\r\n        });\r\n    }\r\n    Globe.getInstance = function (options) {\r\n        if (!this.globe) {\r\n            var canvas = document.createElement(\"canvas\");\r\n            var width = document.documentElement.clientWidth;\r\n            var height = document.documentElement.clientHeight;\r\n            this.globe = new Globe(canvas, width, height, options);\r\n        }\r\n        return this.globe;\r\n    };\r\n    Globe.prototype.placeAt = function (container) {\r\n        if (this.canvas.parentNode) {\r\n            if (this.canvas.parentNode !== container) {\r\n                container.appendChild(this.canvas);\r\n            }\r\n        }\r\n        else {\r\n            container.appendChild(this.canvas);\r\n        }\r\n    };\r\n    Globe.prototype.getWidth = function () {\r\n        return this.width;\r\n    };\r\n    Globe.prototype.getHeight = function () {\r\n        return this.height;\r\n    };\r\n    Globe.prototype.resize = function (width, height) {\r\n        this.resizeCanvas(width, height);\r\n        this.renderer.updateViewportSize();\r\n        this.camera.setSize(width, height);\r\n        Utils_1.default.publish(\"extent-change\");\r\n    };\r\n    Globe.prototype.resizeCanvas = function (width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.canvas.width = width * Env_1.devicePixelRatio;\r\n        this.canvas.height = height * Env_1.devicePixelRatio;\r\n        this.canvas.style.width = width + \"px\";\r\n        this.canvas.style.height = height + \"px\";\r\n    };\r\n    Globe.prototype.updateUserLocation = function (location) {\r\n        this.locationGraphic.setLonLat(location.lon, location.lat);\r\n        var _a = this.camera.getLonlat(), lon = _a[0], lat = _a[1];\r\n        if (this.options.lonlat === 'auto') {\r\n            lon = location.lon;\r\n            lat = location.lat;\r\n        }\r\n        var level = this.getLevel();\r\n        if (this.options.level === 'auto') {\r\n            level = 8;\r\n            if (location.accuracy <= 100) {\r\n                level = 16;\r\n            }\r\n            else if (location.accuracy <= 1000) {\r\n                level = 13;\r\n            }\r\n            else {\r\n                level = 11;\r\n            }\r\n        }\r\n        this.centerTo(lon, lat, level);\r\n    };\r\n    Globe.prototype.getLonlat = function () {\r\n        return this.camera.getLonlat();\r\n    };\r\n    Globe.prototype.isRenderingPaused = function () {\r\n        return this.renderer.isRenderingPaused();\r\n    };\r\n    Globe.prototype.pauseRendering = function () {\r\n        this.renderer.pauseRendering();\r\n    };\r\n    Globe.prototype.resumeRendering = function () {\r\n        this.renderer.resumeRendering();\r\n        this.refresh(true);\r\n    };\r\n    Globe.prototype._setTiledLayer = function (tiledLayer, dontRefresh) {\r\n        if (dontRefresh === void 0) { dontRefresh = false; }\r\n        Image_1.default.clear();\r\n        if (this.tiledLayer) {\r\n            var b = this.scene.remove(this.tiledLayer);\r\n            if (!b) {\r\n                console.error(\"this.scene.remove(this.tiledLayer)失败\");\r\n            }\r\n            this.scene.tiledLayer = null;\r\n        }\r\n        tiledLayer.globe = this;\r\n        this.tiledLayer = tiledLayer;\r\n        this.scene.add(this.tiledLayer, true);\r\n        if (!dontRefresh) {\r\n            this.refresh(true);\r\n        }\r\n    };\r\n    Globe.prototype.showLabelLayer = function () {\r\n        if (this.labelLayer) {\r\n            this.labelLayer.visible = true;\r\n        }\r\n    };\r\n    Globe.prototype.hideLabelLayer = function () {\r\n        if (this.labelLayer) {\r\n            this.labelLayer.visible = false;\r\n        }\r\n    };\r\n    Globe.prototype.showTrafficLayer = function () {\r\n        if (this.trafficLayer) {\r\n            this.trafficLayer.visible = true;\r\n        }\r\n    };\r\n    Globe.prototype.hideTrafficLayer = function () {\r\n        if (this.trafficLayer) {\r\n            this.trafficLayer.visible = false;\r\n        }\r\n    };\r\n    Globe.prototype.getLevel = function () {\r\n        return this.camera.getLevel();\r\n    };\r\n    Globe.prototype.zoomIn = function () {\r\n        this.setLevel(this.getLevel() + 1);\r\n    };\r\n    Globe.prototype.setLevel = function (level) {\r\n        if (this.camera) {\r\n            this.camera.setLevel(level);\r\n        }\r\n    };\r\n    Globe.prototype.centerTo = function (lon, lat, level) {\r\n        if (level === void 0) { level = this.getLevel(); }\r\n        return this.camera.centerTo(lon, lat, level);\r\n    };\r\n    Globe.prototype.animateTo = function (newLon, newLat, newLevel, duration) {\r\n        if (newLevel === void 0) { newLevel = this.getLevel(); }\r\n        if (duration === void 0) { duration = 1000; }\r\n        return this.camera.animateTo(newLon, newLat, newLevel, duration);\r\n    };\r\n    Globe.prototype.setExtent = function (extent) {\r\n        return this.camera.setExtent(extent);\r\n    };\r\n    Globe.prototype.animateToExtent = function (extent, duration) {\r\n        if (duration === void 0) { duration = 1000; }\r\n        return this.camera.animateToExtent(extent, duration);\r\n    };\r\n    Globe.prototype.isAnimating = function () {\r\n        return this.camera.isAnimating();\r\n    };\r\n    Globe.prototype.animateToLevel = function (level, cb) {\r\n        if (!this.isAnimating()) {\r\n            if (level < Kernel_1.default.MIN_LEVEL) {\r\n                level = Kernel_1.default.MIN_LEVEL;\r\n            }\r\n            if (level > Kernel_1.default.MAX_LEVEL) {\r\n                level = Kernel_1.default.MAX_LEVEL;\r\n            }\r\n            if (level !== this.getLevel()) {\r\n                this.camera.animateToLevel(level, cb);\r\n            }\r\n        }\r\n    };\r\n    Globe.prototype.animateOut = function (cb) {\r\n        this.animateToLevel(this.getLevel() - 1, cb);\r\n    };\r\n    Globe.prototype.animateIn = function (cb) {\r\n        this.animateToLevel(this.getLevel() + 1, cb);\r\n    };\r\n    Globe.prototype._onBeforeRender = function (renderer) {\r\n        this.refresh();\r\n    };\r\n    Globe.prototype._onAfterRender = function (render) {\r\n        this.afterRenderCallbacks.forEach(function (callback) { return callback(); });\r\n        this.afterRenderCallbacks = [];\r\n    };\r\n    Globe.prototype.logRefreshInfo = function () {\r\n        console.log(this.realRefreshCount, this.allRefreshCount, this.realRefreshCount / this.allRefreshCount);\r\n    };\r\n    Globe.prototype.refresh = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        this.allRefreshCount++;\r\n        var timestamp = Date.now();\r\n        this.camera.update(force);\r\n        if (!this.tiledLayer || !this.scene || !this.camera) {\r\n            return;\r\n        }\r\n        if (this.debugStopRefreshTiles) {\r\n            return;\r\n        }\r\n        var newCameraCore = this.camera.getCameraCore();\r\n        var isNeedRefresh = false;\r\n        if (force) {\r\n            isNeedRefresh = true;\r\n        }\r\n        else {\r\n            if (this.isRenderingPaused()) {\r\n                isNeedRefresh = false;\r\n            }\r\n            else {\r\n                if (newCameraCore.equals(this.lastRefreshCameraCore)) {\r\n                    isNeedRefresh = false;\r\n                }\r\n                else {\r\n                    isNeedRefresh = timestamp - this.lastRefreshTimestamp >= this.REFRESH_INTERVAL;\r\n                }\r\n            }\r\n        }\r\n        this.tiledLayer.updateSubLayerCount();\r\n        if (isNeedRefresh) {\r\n            this.realRefreshCount++;\r\n            this.lastRefreshTimestamp = timestamp;\r\n            this.lastRefreshCameraCore = newCameraCore;\r\n            this.tiledLayer.refresh();\r\n        }\r\n        this.tiledLayer.updateTileVisibility();\r\n        if (!this.isRenderingPaused()) {\r\n            var a = !!(this.labelLayer && this.labelLayer.visible);\r\n            var b = !!(this.trafficLayer && this.trafficLayer.visible);\r\n            if (a || b) {\r\n                var lastLevelTileGrids = this.tiledLayer.getLastLevelVisibleTileGrids();\r\n                if (a) {\r\n                    this.labelLayer.updateTiles(this.getLevel(), lastLevelTileGrids);\r\n                }\r\n                if (b) {\r\n                    this.trafficLayer.updateTiles(this.getLevel(), lastLevelTileGrids);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    Globe.prototype.getExtent = function () {\r\n        var extents = [];\r\n        var layerExtent = this.tiledLayer.getExtent();\r\n        if (layerExtent) {\r\n            extents.push(layerExtent);\r\n        }\r\n        var cameraExtent = this.camera.getExtent();\r\n        if (cameraExtent) {\r\n            extents.push(cameraExtent);\r\n        }\r\n        if (extents.length === 0) {\r\n            return null;\r\n        }\r\n        else if (extents.length === 1) {\r\n            return extents[0];\r\n        }\r\n        else {\r\n            return Extent_1.default.intersect(extents);\r\n        }\r\n    };\r\n    Globe.prototype.pick = function (canvasX, canvasY) {\r\n        var pickInfo = this.camera.getPickInfoByCanvas(canvasX, canvasY, false);\r\n        var line = pickInfo.line;\r\n        this.scene.pickByWorldLine(line);\r\n    };\r\n    Globe.prototype.test = function () {\r\n        this.debugStopRefreshTiles = true;\r\n        this.labelLayer.hideAllTiles();\r\n        this.tiledLayer.children.forEach(function (subLayer) { return subLayer.hideAllTiles(); });\r\n        var subLayer = this.tiledLayer.children[this.tiledLayer.children.length - 1];\r\n        subLayer.visible = true;\r\n        subLayer.children[0].visible = true;\r\n        return subLayer;\r\n    };\r\n    Globe.globe = null;\r\n    return Globe;\r\n}());\r\nexports.default = Globe;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Globe.ts\n// module id = 81\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar Renderer = (function () {\r\n    function Renderer(canvas, onBeforeRender, onAfterRender) {\r\n        this.canvas = canvas;\r\n        this.onBeforeRender = onBeforeRender;\r\n        this.onAfterRender = onAfterRender;\r\n        this.scene = null;\r\n        this.camera = null;\r\n        this.renderingPaused = true;\r\n        this.gl = null;\r\n        this.gl = this._getWebGLContext(this.canvas);\r\n        Kernel_1.default.gl = this.gl;\r\n        if (!this.gl) {\r\n            console.debug(\"浏览器不支持WebGL或将WebGL禁用!\");\r\n        }\r\n        var gl = this.gl;\r\n        this.updateViewportSize();\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        gl.clearColor(0, 0, 0, 1);\r\n        gl.enable(gl.DEPTH_TEST);\r\n        gl.depthFunc(gl.LEQUAL);\r\n        gl.depthMask(true);\r\n        gl.enable(gl.CULL_FACE);\r\n        gl.frontFace(gl.CCW);\r\n        gl.cullFace(gl.BACK);\r\n    }\r\n    Renderer.prototype._getWebGLContext = function (canvas) {\r\n        var gl = null;\r\n        try {\r\n            var contextList = [\"webgl\", \"experimental-webgl\", \"webkit-3d\", \"moz-webgl\"];\r\n            for (var i = 0; i < contextList.length; i++) {\r\n                gl = canvas.getContext(contextList[i], {\r\n                    antialias: true\r\n                });\r\n                if (gl) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        return gl;\r\n    };\r\n    Renderer.prototype.render = function (scene, camera) {\r\n        var gl = this.gl;\r\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\r\n        gl.clearColor(0, 0, 0, 1);\r\n        try {\r\n            camera.update();\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        try {\r\n            if (this.onBeforeRender) {\r\n                this.onBeforeRender(this);\r\n            }\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        try {\r\n            if (!this.renderingPaused) {\r\n                scene.draw(camera);\r\n            }\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n        try {\r\n            if (this.onAfterRender) {\r\n                this.onAfterRender(this);\r\n            }\r\n        }\r\n        catch (e) {\r\n            console.error(e);\r\n        }\r\n    };\r\n    Renderer.prototype.updateViewportSize = function () {\r\n        this.gl.viewport(0, 0, this.canvas.width, this.canvas.height);\r\n    };\r\n    Renderer.prototype.setScene = function (scene) {\r\n        this.scene = scene;\r\n    };\r\n    Renderer.prototype.setCamera = function (camera) {\r\n        this.camera = camera;\r\n    };\r\n    Renderer.prototype._tick = function () {\r\n        if (this.scene && this.camera) {\r\n            this.render(this.scene, this.camera);\r\n        }\r\n        window.requestAnimationFrame(this._tick.bind(this));\r\n    };\r\n    Renderer.prototype.isRenderingPaused = function () {\r\n        return this.renderingPaused;\r\n    };\r\n    Renderer.prototype.pauseRendering = function () {\r\n        this.renderingPaused = true;\r\n    };\r\n    Renderer.prototype.resumeRendering = function () {\r\n        this.renderingPaused = false;\r\n        this._tick();\r\n    };\r\n    return Renderer;\r\n}());\r\nexports.default = Renderer;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Renderer.ts\n// module id = 82\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./Kernel\");\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Events_1 = require(\"./Events\");\r\nvar Utils_2 = require(\"./math/Utils\");\r\nvar Vertice_1 = require(\"./math/Vertice\");\r\nvar Vector_1 = require(\"./math/Vector\");\r\nvar Line_1 = require(\"./math/Line\");\r\nvar TileGrid_1 = require(\"./TileGrid\");\r\nvar Matrix_1 = require(\"./math/Matrix\");\r\nvar Object3D_1 = require(\"./Object3D\");\r\nvar Extent_1 = require(\"./Extent\");\r\nvar CameraCore = (function () {\r\n    function CameraCore(fov, aspect, near, far, floatLevel, matrix) {\r\n        this.fov = fov;\r\n        this.aspect = aspect;\r\n        this.near = near;\r\n        this.far = far;\r\n        this.floatLevel = floatLevel;\r\n        this.matrix = matrix;\r\n    }\r\n    CameraCore.prototype.getFov = function () {\r\n        return this.fov;\r\n    };\r\n    CameraCore.prototype.getAspect = function () {\r\n        return this.aspect;\r\n    };\r\n    CameraCore.prototype.getNear = function () {\r\n        return this.near;\r\n    };\r\n    CameraCore.prototype.getFar = function () {\r\n        return this.far;\r\n    };\r\n    CameraCore.prototype.getFloatLevel = function () {\r\n        return this.floatLevel;\r\n    };\r\n    CameraCore.prototype.getMatrix = function () {\r\n        return this.matrix;\r\n    };\r\n    CameraCore.prototype.equals = function (other) {\r\n        if (!other) {\r\n            return false;\r\n        }\r\n        return this.fov === other.getFov() &&\r\n            this.aspect === other.getAspect() &&\r\n            this.near === other.getNear() &&\r\n            this.far === other.getFar() &&\r\n            this.floatLevel === other.getFloatLevel() &&\r\n            this.matrix.equals(other.getMatrix());\r\n    };\r\n    return CameraCore;\r\n}());\r\nexports.CameraCore = CameraCore;\r\nvar realResolutionCache = {};\r\n(function () {\r\n    for (var i = 0; i <= Kernel_1.default.MAX_LEVEL; i++) {\r\n        realResolutionCache[i] = Kernel_1.default.MAX_REAL_RESOLUTION / Math.pow(2, i);\r\n    }\r\n})();\r\nvar Camera = (function (_super) {\r\n    __extends(Camera, _super);\r\n    function Camera(width, height, fov, aspect, near, far, level, lonlat, resolutionFactor) {\r\n        if (fov === void 0) { fov = 45; }\r\n        if (aspect === void 0) { aspect = 1; }\r\n        if (near === void 0) { near = 1; }\r\n        if (far === void 0) { far = 100; }\r\n        if (level === void 0) { level = 3; }\r\n        if (lonlat === void 0) { lonlat = [0, 0]; }\r\n        if (resolutionFactor === void 0) { resolutionFactor = Math.pow(2, 0.3752950); }\r\n        var _this = _super.call(this) || this;\r\n        _this.width = width;\r\n        _this.height = height;\r\n        _this.fov = fov;\r\n        _this.aspect = aspect;\r\n        _this.near = near;\r\n        _this.far = far;\r\n        _this.animationDuration = 200;\r\n        _this.nearFactor = 0.6;\r\n        _this.maxPitch = 40;\r\n        _this.isZeroPitch = true;\r\n        _this.level = -1;\r\n        _this.floatLevel = -2;\r\n        _this.lastFloatLevel = -3;\r\n        _this.lastFov = -1;\r\n        _this.lastAspect = -1;\r\n        _this.lastNear = -1;\r\n        _this.lastFar = -1;\r\n        _this.lonlatsOfBoundary = null;\r\n        _this.animating = false;\r\n        _this.eventEmitter = null;\r\n        if (!(resolutionFactor > 0)) {\r\n            resolutionFactor = Math.pow(2, 0.3752950);\r\n        }\r\n        _this.resolutionFactor1 = resolutionFactor;\r\n        _this.resolutionFactor2 = _this.resolutionFactor1 * 2;\r\n        _this.eventEmitter = new Events_1.EventEmitter();\r\n        _this.lonlatsOfBoundary = [];\r\n        _this.initFov = _this.fov;\r\n        _this.lastMatrix = new Matrix_1.default();\r\n        _this.lastMatrix.setUniqueValue(0);\r\n        _this.projMatrix = new Matrix_1.default();\r\n        _this._rawSetPerspectiveMatrix(_this.fov, _this.aspect, _this.near, _this.far);\r\n        _this._initCameraPosition(level, lonlat[0], lonlat[1]);\r\n        _this.update(true);\r\n        return _this;\r\n    }\r\n    Camera.prototype.getExtent = function () {\r\n        var extent = null;\r\n        if (this.isEarthFullOverlapScreen()) {\r\n            var lons = [];\r\n            var lats = [];\r\n            this.lonlatsOfBoundary.forEach(function (lonlat) {\r\n                lons.push(lonlat[0]);\r\n                lats.push(lonlat[1]);\r\n            });\r\n            var minLon = Math.min.apply(Math, lons);\r\n            var maxLon = Math.max.apply(Math, lons);\r\n            var minLat = Math.min.apply(Math, lats);\r\n            var maxLat = Math.max.apply(Math, lats);\r\n            extent = new Extent_1.default(minLon, minLat, maxLon, maxLat);\r\n        }\r\n        return extent;\r\n    };\r\n    Camera.prototype.getEventEmitter = function () {\r\n        return this.eventEmitter;\r\n    };\r\n    Camera.prototype.isEarthFullOverlapScreen = function () {\r\n        return this.lonlatsOfBoundary.length === 8;\r\n    };\r\n    Camera.prototype.getTileGridsOfBoundary = function (level, filterRepeat) {\r\n        var tileGridsOfBoundary = this.lonlatsOfBoundary.map(function (lonlat) {\r\n            return TileGrid_1.default.getTileGridByGeo(lonlat[0], lonlat[1], level);\r\n        });\r\n        return filterRepeat ? Utils_1.default.filterRepeatArray(tileGridsOfBoundary) : tileGridsOfBoundary;\r\n    };\r\n    Camera.prototype.toJson = function () {\r\n        function matrixToJson(mat) {\r\n            return mat ? mat.toJson() : null;\r\n        }\r\n        var json = {\r\n            matrix: matrixToJson(this.matrix),\r\n            isZeroPitch: this.isZeroPitch,\r\n            level: this.level,\r\n            floatLevel: this.floatLevel,\r\n            lastFloatLevel: this.lastFloatLevel,\r\n            lastMatrix: matrixToJson(this.lastMatrix),\r\n            lastFov: this.lastFov,\r\n            lastAspect: this.lastAspect,\r\n            lastNear: this.lastNear,\r\n            lastFar: this.lastFar,\r\n            viewMatrix: matrixToJson(this.viewMatrix),\r\n            projMatrix: matrixToJson(this.projMatrix),\r\n            projViewMatrix: matrixToJson(this.projViewMatrix),\r\n            matrixForDraw: matrixToJson(this.matrixForDraw),\r\n            viewMatrixForDraw: matrixToJson(this.viewMatrixForDraw),\r\n            projMatrixForDraw: matrixToJson(this.projMatrixForDraw),\r\n            projViewMatrixForDraw: matrixToJson(this.projViewMatrixForDraw),\r\n            animating: this.animating\r\n        };\r\n        return json;\r\n    };\r\n    Camera.prototype.toJsonString = function () {\r\n        return JSON.stringify(this.toJson());\r\n    };\r\n    Camera.prototype.fromJson = function (json) {\r\n        this.matrix = Matrix_1.default.fromJson(json.matrix);\r\n        this.isZeroPitch = json.isZeroPitch;\r\n        this.level = json.level;\r\n        this.floatLevel = json.floatLevel;\r\n        this.lastFloatLevel = json.lastFloatLevel;\r\n        this.lastMatrix = Matrix_1.default.fromJson(json.lastMatrix);\r\n        this.lastFov = json.lastFov;\r\n        this.lastAspect = json.lastAspect;\r\n        this.lastNear = json.lastNear;\r\n        this.lastFar = json.lastFar;\r\n        this.viewMatrix = Matrix_1.default.fromJson(json.viewMatrix);\r\n        this.projMatrix = Matrix_1.default.fromJson(json.projMatrix);\r\n        this.projViewMatrix = Matrix_1.default.fromJson(json.projViewMatrix);\r\n        this.matrixForDraw = Matrix_1.default.fromJson(json.matrixForDraw);\r\n        this.viewMatrixForDraw = Matrix_1.default.fromJson(json.viewMatrixForDraw);\r\n        this.projMatrixForDraw = Matrix_1.default.fromJson(json.projMatrixForDraw);\r\n        this.projViewMatrixForDraw = Matrix_1.default.fromJson(json.projViewMatrixForDraw);\r\n        this.animating = json.animating;\r\n        this.update(true);\r\n    };\r\n    Camera.prototype.fromJsonString = function (jsonStr) {\r\n        this.fromJson(JSON.parse(jsonStr));\r\n    };\r\n    Camera.prototype._setPerspectiveMatrix = function (fov, aspect, near, far) {\r\n        this._rawSetPerspectiveMatrix(fov, aspect, near, far);\r\n        this._updateFar();\r\n    };\r\n    Camera.prototype._rawSetPerspectiveMatrix = function (fov, aspect, near, far, projMatrix) {\r\n        if (projMatrix === void 0) { projMatrix = this.projMatrix; }\r\n        if (this.projMatrix === projMatrix) {\r\n            this.fov = fov;\r\n            this.aspect = aspect;\r\n            this.near = near;\r\n            this.far = far;\r\n        }\r\n        var mat = [\r\n            1, 0, 0, 0,\r\n            0, 1, 0, 0,\r\n            0, 0, 1, 0,\r\n            0, 0, 0, 1\r\n        ];\r\n        var halfFov = fov * Math.PI / 180 / 2;\r\n        var f = 1 / Math.tan(halfFov);\r\n        var nf = 1 / (near - far);\r\n        mat[0] = f / aspect;\r\n        mat[5] = f;\r\n        mat[10] = (far + near) * nf;\r\n        mat[11] = -1;\r\n        mat[14] = 2 * near * far * nf;\r\n        mat[15] = 0;\r\n        projMatrix.setElements(mat[0], mat[1], mat[2], mat[3], mat[4], mat[5], mat[6], mat[7], mat[8], mat[9], mat[10], mat[11], mat[12], mat[13], mat[14], mat[15]);\r\n    };\r\n    Camera.prototype._setFov = function (fov) {\r\n        if (!(fov > 0)) {\r\n            throw \"invalid fov:\" + fov;\r\n        }\r\n        this._setPerspectiveMatrix(fov, this.aspect, this.near, this.far);\r\n    };\r\n    Camera.prototype.setSize = function (width, height) {\r\n        this.width = width;\r\n        this.height = height;\r\n        this.setAspect(this.width / this.height);\r\n    };\r\n    Camera.prototype.setAspect = function (aspect) {\r\n        if (!(aspect > 0)) {\r\n            throw \"invalid aspect:\" + aspect;\r\n        }\r\n        this._setPerspectiveMatrix(this.fov, aspect, this.near, this.far);\r\n        this.setLevel(this.level, true);\r\n    };\r\n    Camera.prototype._updateFar = function () {\r\n    };\r\n    Camera.prototype._getMinimalFar = function (cameraPosition) {\r\n        var distance2EarthOrigin = Vector_1.default.fromVertice(cameraPosition).getLength();\r\n        var far = Math.sqrt(distance2EarthOrigin * distance2EarthOrigin - Kernel_1.default.EARTH_RADIUS * Kernel_1.default.EARTH_RADIUS);\r\n        far *= 1.05;\r\n        return far;\r\n    };\r\n    Camera.prototype.update = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        var shouldUpdate = this._updateCore(force);\r\n        if (shouldUpdate) {\r\n            this._updateTileGridsOfBoundary();\r\n        }\r\n        return shouldUpdate;\r\n    };\r\n    Camera.prototype._updateCore = function (force) {\r\n        if (force === void 0) { force = false; }\r\n        var shouldUpdate = force || this._isNeedUpdate();\r\n        if (shouldUpdate) {\r\n            this._normalUpdate();\r\n            this._updateProjViewMatrixForDraw();\r\n        }\r\n        this.lastFov = this.fov;\r\n        this.lastAspect = this.aspect;\r\n        this.lastNear = this.near;\r\n        this.lastFar = this.far;\r\n        this.lastFloatLevel = this.floatLevel;\r\n        this.lastMatrix.setMatrixByOther(this.matrix);\r\n        return shouldUpdate;\r\n    };\r\n    Camera.prototype._updateTileGridsOfBoundary = function () {\r\n        var _this = this;\r\n        var lonlatsOfBoundary = [];\r\n        var ndcs = [\r\n            [-1, 1],\r\n            [-1, 0],\r\n            [-1, -1],\r\n            [1, 1],\r\n            [1, 0],\r\n            [1, -1],\r\n            [0, 1],\r\n            [0, -1]\r\n        ];\r\n        ndcs.forEach(function (ndcXY) {\r\n            var lonlat = _this._getPickLonLatByNDC(ndcXY[0], ndcXY[1]);\r\n            if (lonlat && lonlat.length > 0) {\r\n                lonlatsOfBoundary.push(lonlat);\r\n            }\r\n        });\r\n        this.lonlatsOfBoundary = lonlatsOfBoundary;\r\n    };\r\n    Camera.prototype.getCameraCore = function () {\r\n        return new CameraCore(this.fov, this.aspect, this.near, this.far, this.floatLevel, this.matrix.clone());\r\n    };\r\n    Camera.prototype._isNeedUpdate = function () {\r\n        return (this.fov !== this.lastFov) ||\r\n            (this.aspect !== this.lastAspect) ||\r\n            (this.near !== this.lastNear) ||\r\n            (this.far !== this.lastFar) ||\r\n            (this.floatLevel !== this.lastFloatLevel) ||\r\n            (!this.matrix.equals(this.lastMatrix));\r\n    };\r\n    Camera.prototype.getProjViewMatrixForDraw = function () {\r\n        return this.projViewMatrixForDraw;\r\n    };\r\n    Camera.prototype._normalUpdate = function () {\r\n        this.viewMatrix = this.matrix.getInverseMatrix();\r\n        this._updateFar();\r\n        this.projViewMatrix = this.projMatrix.multiplyMatrix(this.viewMatrix);\r\n    };\r\n    Camera.prototype._updateProjViewMatrixForDraw = function () {\r\n        this.matrixForDraw = this.matrix.clone();\r\n        var newFov = this._updatePositionAndFov(this.matrixForDraw);\r\n        var aspect = this.aspect;\r\n        var near = this.near;\r\n        var newFar = this.far;\r\n        this.projMatrixForDraw = new Matrix_1.default();\r\n        this._rawSetPerspectiveMatrix(newFov, aspect, near, newFar, this.projMatrixForDraw);\r\n        this.viewMatrixForDraw = this.matrixForDraw.getInverseMatrix();\r\n        this.projViewMatrixForDraw = this.projMatrixForDraw.multiplyMatrix(this.viewMatrixForDraw);\r\n    };\r\n    Camera.prototype._updatePositionAndFov = function (cameraMatrix) {\r\n        var currentLevel = this.animating ? this.floatLevel : this.level;\r\n        var safeLevel = this._getSafeThresholdLevelForNear();\r\n        if (currentLevel > safeLevel) {\r\n            this._updatePositionByLevel(safeLevel, cameraMatrix);\r\n            var deltaLevel = currentLevel - safeLevel;\r\n            var newFov = this._calculateFovByDeltaLevel(this.initFov, deltaLevel);\r\n            return newFov;\r\n        }\r\n        else {\r\n            this._updatePositionByLevel(currentLevel, cameraMatrix);\r\n            return this.initFov;\r\n        }\r\n    };\r\n    Camera.prototype._getSafeThresholdLevelForNear = function () {\r\n        var thresholdNear = this.near * this.nearFactor;\r\n        var result = this._calculateResolutionAndBestDisplayLevelByDistance2EarthSurface(thresholdNear);\r\n        var level = result[1];\r\n        return level;\r\n    };\r\n    Camera.prototype._calculateDeltaLevelByFov = function (oldFov, newFov) {\r\n        var radianOldFov = Utils_2.default.degreeToRadian(oldFov);\r\n        var halfRadianOldFov = radianOldFov / 2;\r\n        var tanOld = Math.tan(halfRadianOldFov);\r\n        var radianNewFov = Utils_2.default.degreeToRadian(newFov);\r\n        var halfRadianNewFov = radianNewFov / 2;\r\n        var tanNew = Math.tan(halfRadianNewFov);\r\n        var deltaLevel = Utils_2.default.log2(tanOld / tanNew);\r\n        return deltaLevel;\r\n    };\r\n    Camera.prototype._calculateFovByDeltaLevel = function (oldFov, deltaLevel) {\r\n        var radianOldFov = Utils_2.default.degreeToRadian(oldFov);\r\n        var halfRadianOldFov = radianOldFov / 2;\r\n        var tanOld = Math.tan(halfRadianOldFov);\r\n        var tanNew = tanOld / Math.pow(2, deltaLevel);\r\n        var halfRadianNewFov = Math.atan(tanNew);\r\n        var radianNewFov = halfRadianNewFov * 2;\r\n        var newFov = Utils_2.default.radianToDegree(radianNewFov);\r\n        return newFov;\r\n    };\r\n    Camera.prototype.getResolution = function () {\r\n        var _a = this.measureXYResolutionAndBestDisplayLevel(), resolutionX = _a.resolutionX, bestDisplayLevelFloatX = _a.bestDisplayLevelFloatX, resolutionY = _a.resolutionY, bestDisplayLevelFloatY = _a.bestDisplayLevelFloatY;\r\n        return (resolutionX + resolutionY) / 2 / this.resolutionFactor1;\r\n    };\r\n    Camera.prototype.getResolutionInWorld = function () {\r\n        return this.getResolution() / Kernel_1.default.SCALE_FACTOR;\r\n    };\r\n    Camera.prototype.getResolutionInWorld2 = function () {\r\n        if (realResolutionCache.hasOwnProperty(this.level)) {\r\n            return realResolutionCache[this.level];\r\n        }\r\n        else {\r\n            return Kernel_1.default.MAX_REAL_RESOLUTION / Math.pow(2, this.level);\r\n        }\r\n    };\r\n    Camera.prototype.measureXYResolutionAndBestDisplayLevel = function () {\r\n        var p = this.matrix.getPosition();\r\n        var dir = Vector_1.default.fromVertice(p);\r\n        var line = new Line_1.default(p, dir);\r\n        var pickResult1 = this._getPickCartesianCoordInEarthByLine(line);\r\n        var p1 = pickResult1[0];\r\n        var ndc1 = this._convertVerticeFromWorldToNDC(p1);\r\n        var canvasXY1 = Utils_2.default.convertPointFromNdcToCanvas(this.width, this.height, ndc1.x, ndc1.y);\r\n        var centerX = canvasXY1[0];\r\n        var centerY = canvasXY1[1];\r\n        var offsetPixel = 10;\r\n        var leftPickResult = this.getPickCartesianCoordInEarthByCanvas(centerX - offsetPixel, centerY);\r\n        var vLeft = Vector_1.default.fromVertice(leftPickResult[0]);\r\n        var rightPickResult = this.getPickCartesianCoordInEarthByCanvas(centerX + offsetPixel, centerY);\r\n        var vRight = Vector_1.default.fromVertice(rightPickResult[0]);\r\n        var α = Vector_1.default.getRadianOfTwoVectors(vLeft, vRight);\r\n        var resolutionX = α * Kernel_1.default.EARTH_RADIUS / (2 * offsetPixel) * this.resolutionFactor1;\r\n        var bestDisplayLevelFloatX = this._calculateLevelByResolution(resolutionX);\r\n        var topPickResult = this.getPickCartesianCoordInEarthByCanvas(centerX, centerY + offsetPixel);\r\n        var vTop = Vector_1.default.fromVertice(topPickResult[0]);\r\n        var bottomPickResult = this.getPickCartesianCoordInEarthByCanvas(centerX, centerY - offsetPixel);\r\n        var vBottom = Vector_1.default.fromVertice(bottomPickResult[0]);\r\n        var β = Vector_1.default.getRadianOfTwoVectors(vTop, vBottom);\r\n        var resolutionY = β * Kernel_1.default.EARTH_RADIUS / (2 * offsetPixel) * this.resolutionFactor1;\r\n        var bestDisplayLevelFloatY = this._calculateLevelByResolution(resolutionY);\r\n        return {\r\n            resolutionX: resolutionX,\r\n            bestDisplayLevelFloatX: bestDisplayLevelFloatX,\r\n            resolutionY: resolutionY,\r\n            bestDisplayLevelFloatY: bestDisplayLevelFloatY\r\n        };\r\n    };\r\n    Camera.prototype.calculateCurrentResolutionAndBestDisplayLevel = function () {\r\n        var distance2EarthOrigin = this.getDistance2EarthOrigin();\r\n        return this._calculateResolutionAndBestDisplayLevelByDistance2EarthOrigin(distance2EarthOrigin);\r\n    };\r\n    Camera.prototype._calculateResolutionAndBestDisplayLevelByDistance2EarthOrigin = function (distance2EarthOrigin) {\r\n        var α2 = Utils_2.default.degreeToRadian(this.fov / 2);\r\n        var α1 = Math.atan(2 / this.height * Math.tan(α2));\r\n        var δ = Math.asin(distance2EarthOrigin * Math.sin(α1) / Kernel_1.default.EARTH_RADIUS);\r\n        var β = δ - α1;\r\n        var resolution = β * Kernel_1.default.EARTH_RADIUS * this.resolutionFactor2;\r\n        var bestDisplayLevelFloat = this._calculateLevelByResolution(resolution);\r\n        return [resolution, bestDisplayLevelFloat];\r\n    };\r\n    Camera.prototype._calculateResolutionAndBestDisplayLevelByDistance2EarthSurface = function (distance2EarthSurface) {\r\n        var distance2EarthOrigin = distance2EarthSurface + Kernel_1.default.EARTH_RADIUS;\r\n        return this._calculateResolutionAndBestDisplayLevelByDistance2EarthOrigin(distance2EarthOrigin);\r\n    };\r\n    Camera.prototype._calculateDistance2EarthSurfaceByBestDisplayLevel = function (level) {\r\n        return this._calculateDistance2EarthOriginByBestDisplayLevel(level) - Kernel_1.default.EARTH_RADIUS;\r\n    };\r\n    Camera.prototype._calculateDistance2EarthOriginByBestDisplayLevel = function (level) {\r\n        var resolution = this._calculateResolutionByLevel(level);\r\n        return this._calculateDistance2EarthOriginByResolution(resolution);\r\n    };\r\n    Camera.prototype._calculateDistance2EarthOriginByResolution = function (resolution) {\r\n        resolution /= this.resolutionFactor2;\r\n        var α2 = Utils_2.default.degreeToRadian(this.fov / 2);\r\n        var α1 = Math.atan(2 / this.height * Math.tan(α2));\r\n        var β = resolution / Kernel_1.default.EARTH_RADIUS;\r\n        var δ = α1 + β;\r\n        var distance2EarthOrigin = Kernel_1.default.EARTH_RADIUS * Math.sin(δ) / Math.sin(α1);\r\n        return distance2EarthOrigin;\r\n    };\r\n    Camera.prototype._calculateLevelByResolution = function (resolution) {\r\n        var pow2value = Kernel_1.default.MAX_RESOLUTION / resolution;\r\n        var bestDisplayLevelFloat = Utils_2.default.log2(pow2value);\r\n        return bestDisplayLevelFloat;\r\n    };\r\n    Camera.prototype._calculateResolutionByLevel = function (level) {\r\n        return Kernel_1.default.MAX_RESOLUTION / Math.pow(2, level);\r\n    };\r\n    Camera.prototype.getVertice = function () {\r\n        var origin2PositionVector = Vector_1.default.fromVertice(this.getPosition());\r\n        origin2PositionVector.setLength(Kernel_1.default.EARTH_RADIUS);\r\n        var p = origin2PositionVector.getVertice();\r\n        return p;\r\n    };\r\n    Camera.prototype.getLonlat = function () {\r\n        var p = this.getVertice();\r\n        var lonlat = Utils_2.default.cartesianCoordToGeographic(p);\r\n        return lonlat;\r\n    };\r\n    Camera.prototype.getLevel = function () {\r\n        return this.level;\r\n    };\r\n    Camera.prototype.setLevel = function (level, force) {\r\n        if (force === void 0) { force = false; }\r\n        if (!(Utils_1.default.isNonNegativeInteger(level))) {\r\n            throw \"invalid level:\" + level;\r\n        }\r\n        if (level < Kernel_1.default.MIN_LEVEL) {\r\n            level = Kernel_1.default.MIN_LEVEL;\r\n        }\r\n        if (level > Kernel_1.default.MAX_LEVEL) {\r\n            level = Kernel_1.default.MAX_LEVEL;\r\n        }\r\n        var oldLevel = this.level;\r\n        var levelChanged = level !== this.level;\r\n        if (levelChanged || force) {\r\n            this._updatePositionByLevel(level, this.matrix);\r\n            this.level = level;\r\n            this.floatLevel = level;\r\n        }\r\n        if (levelChanged) {\r\n            Utils_1.default.publish('level-change', {\r\n                oldLevel: oldLevel,\r\n                newLevel: this.level\r\n            });\r\n        }\r\n    };\r\n    Camera.prototype._initCameraPosition = function (level, lon, lat) {\r\n        var initDistanceToOrigin = this._calculateDistance2EarthOriginByBestDisplayLevel(level);\r\n        var initPosition = Utils_2.default.geographicToCartesianCoord(lon, lat, initDistanceToOrigin);\r\n        var origin = new Vertice_1.default(0, 0, 0);\r\n        var vector = this.getLightDirection().getOpposite();\r\n        vector.setLength(initDistanceToOrigin);\r\n        this._look(initPosition, origin);\r\n        this.setLevel(level);\r\n    };\r\n    Camera.prototype._updatePositionByLevel = function (level, cameraMatrix) {\r\n        var intersects = this._getDirectionIntersectPointWithEarth(cameraMatrix);\r\n        if (intersects.length === 0) {\r\n            throw \"no intersect\";\r\n        }\r\n        var intersect = intersects[0];\r\n        var theoryDistance2Interscet = this._calculateDistance2EarthSurfaceByBestDisplayLevel(level);\r\n        var vector = cameraMatrix.getVectorZ();\r\n        vector.setLength(theoryDistance2Interscet);\r\n        var newCameraPosition = Vector_1.default.verticePlusVector(intersect, vector);\r\n        cameraMatrix.setPosition(newCameraPosition);\r\n    };\r\n    Camera.prototype.setDeltaPitch = function (deltaPitch) {\r\n        if (this.level < Kernel_1.default.MIN_PITCH_LEVEL || !this.isEarthFullOverlapScreen()) {\r\n            return;\r\n        }\r\n        var currentPitch = this.getPitch();\r\n        var newPitch = currentPitch + deltaPitch;\r\n        if (newPitch > this.maxPitch) {\r\n            return;\r\n        }\r\n        if (newPitch < 0) {\r\n            newPitch = 0;\r\n        }\r\n        deltaPitch = newPitch - currentPitch;\r\n        if (deltaPitch === 0) {\r\n            return;\r\n        }\r\n        var intersects = this._getDirectionIntersectPointWithEarth(this.matrix);\r\n        if (intersects.length === 0) {\r\n            throw \"no intersects\";\r\n        }\r\n        var intersect = intersects[0];\r\n        var deltaRadian = Utils_2.default.degreeToRadian(deltaPitch);\r\n        var matrix = this.matrix.clone();\r\n        matrix.setPosition(intersect);\r\n        matrix.localRotateX(deltaRadian);\r\n        this._updatePositionByLevel(this.level, matrix);\r\n        this.isZeroPitch = newPitch === 0;\r\n        this.matrix = matrix;\r\n    };\r\n    Camera.prototype.getPitch = function () {\r\n        if (this.isZeroPitch) {\r\n            return 0;\r\n        }\r\n        var intersects = this._getDirectionIntersectPointWithEarth(this.matrix);\r\n        if (intersects.length === 0) {\r\n            throw \"no intersects\";\r\n        }\r\n        var intersect = intersects[0];\r\n        var vectorOrigin2Intersect = Vector_1.default.fromVertice(intersect);\r\n        var length1 = vectorOrigin2Intersect.getLength();\r\n        var vectorIntersect2Camera = Vector_1.default.verticeMinusVertice(this.getPosition(), intersect);\r\n        var length2 = vectorIntersect2Camera.getLength();\r\n        var cosθ = vectorOrigin2Intersect.dot(vectorIntersect2Camera) / (length1 * length2);\r\n        var radian = Utils_2.default.acosSafely(cosθ);\r\n        var crossVector = vectorOrigin2Intersect.cross(vectorIntersect2Camera);\r\n        var xAxisDirection = this.matrix.getVectorX();\r\n        if (crossVector.dot(xAxisDirection)) {\r\n            radian = Math.abs(radian);\r\n        }\r\n        else {\r\n            radian = -Math.abs(radian);\r\n        }\r\n        var pitch = Utils_2.default.radianToDegree(radian);\r\n        if (pitch >= 90) {\r\n            throw \"Invalid pitch: \" + pitch;\r\n        }\r\n        return pitch;\r\n    };\r\n    Camera.prototype.getPickInfoByCanvas = function (canvasX, canvasY, verticesResult) {\r\n        if (verticesResult === void 0) { verticesResult = false; }\r\n        var result = {\r\n            line: null,\r\n            vertices: []\r\n        };\r\n        this._updateCore();\r\n        var matrix = this.matrix;\r\n        var viewMatrix = this.viewMatrix;\r\n        var projMatrix = this.projMatrix;\r\n        var projViewMatrix = this.projViewMatrix;\r\n        this.matrix = this.matrixForDraw;\r\n        this.viewMatrix = this.viewMatrixForDraw;\r\n        this.projMatrix = this.projMatrixForDraw;\r\n        this.projViewMatrix = this.projViewMatrixForDraw;\r\n        var pickDirection = this._getPickDirectionByCanvas(canvasX, canvasY);\r\n        var p = this.getPosition();\r\n        result.line = new Line_1.default(p, pickDirection);\r\n        if (verticesResult) {\r\n            result.vertices = this._getPickCartesianCoordInEarthByLine(result.line);\r\n        }\r\n        this.matrix = matrix;\r\n        this.viewMatrix = viewMatrix;\r\n        this.projMatrix = projMatrix;\r\n        this.projViewMatrix = projViewMatrix;\r\n        return result;\r\n    };\r\n    Camera.prototype.getPickCartesianCoordInEarthByCanvas = function (canvasX, canvasY) {\r\n        var pickInfo = this.getPickInfoByCanvas(canvasX, canvasY, true);\r\n        return pickInfo.vertices;\r\n    };\r\n    Camera.prototype.getLightDirection = function () {\r\n        var dirVertice = this.matrix.getVectorZ();\r\n        var direction = new Vector_1.default(-dirVertice.x, -dirVertice.y, -dirVertice.z);\r\n        direction.normalize();\r\n        return direction;\r\n    };\r\n    Camera.prototype.getDistance2EarthSurface = function () {\r\n        var position = this.getPosition();\r\n        var length2EarthSurface = Vector_1.default.fromVertice(position).getLength() - Kernel_1.default.EARTH_RADIUS;\r\n        return length2EarthSurface;\r\n    };\r\n    Camera.prototype.getDistance2EarthOrigin = function () {\r\n        var position = this.getPosition();\r\n        return Vector_1.default.fromVertice(position).getLength();\r\n    };\r\n    Camera.prototype.isAnimating = function () {\r\n        return this.animating;\r\n    };\r\n    Camera.prototype.centerTo = function (newLon, newLat, newLevel) {\r\n        if (newLevel === void 0) { newLevel = this.getLevel(); }\r\n        if (newLevel !== this.getLevel()) {\r\n            var newPosition = this._safelyGetNewPositonByLevel(newLevel);\r\n            var newDistance = Vector_1.default.fromVertice(newPosition).getLength();\r\n            this._setPositionByLonLatDistance(newLon, newLat, newDistance);\r\n        }\r\n        else {\r\n            this._setPositionByLonLatDistance(newLon, newLat);\r\n        }\r\n        this.setLevel(newLevel, true);\r\n    };\r\n    Camera.prototype.animateTo = function (newLon, newLat, newLevel, duration) {\r\n        var _this = this;\r\n        if (newLevel === void 0) { newLevel = this.getLevel(); }\r\n        if (duration === void 0) { duration = 1000; }\r\n        var promise = new Promise(function (resolve, reject) {\r\n            if (_this.isAnimating()) {\r\n                reject(\"be animating\");\r\n                return;\r\n            }\r\n            var _a = _this.getLonlat(), startLon = _a[0], startLat = _a[1];\r\n            var singleSpan = 1000 / 60;\r\n            var count = Math.floor(duration / singleSpan);\r\n            var start = -1;\r\n            var deltaLon = (newLon - startLon) / count;\r\n            var deltaLat = (newLat - startLat) / count;\r\n            var deltaLevel = 0;\r\n            var deltaHeight = 0;\r\n            if (newLevel !== _this.level) {\r\n                deltaLevel = (newLevel - _this.level) / count;\r\n                var startDistance = _this.getDistance2EarthOrigin();\r\n                var newPosition = _this._safelyGetNewPositonByLevel(newLevel);\r\n                var newDistance = Vector_1.default.fromVertice(newPosition).getLength();\r\n                deltaHeight = (newDistance - startDistance) / count;\r\n            }\r\n            _this.animating = true;\r\n            var callback = function (timestap) {\r\n                if (start < 0) {\r\n                    start = timestap;\r\n                }\r\n                var a = timestap - start;\r\n                if (a >= duration) {\r\n                    _this.animating = false;\r\n                    _this.floatLevel = newLevel;\r\n                    _this.centerTo(newLon, newLat, newLevel);\r\n                    resolve();\r\n                }\r\n                else {\r\n                    _this.floatLevel += deltaLevel;\r\n                    _this._setPositionByDeltaLonLatDistance(deltaLon, deltaLat, deltaHeight);\r\n                    requestAnimationFrame(callback);\r\n                }\r\n            };\r\n            requestAnimationFrame(callback);\r\n        });\r\n        return promise;\r\n    };\r\n    Camera.prototype.animateToLevel = function (newLevel, cb) {\r\n        var _this = this;\r\n        if (this.isAnimating()) {\r\n            return;\r\n        }\r\n        if (!(Utils_1.default.isNonNegativeInteger(newLevel))) {\r\n            throw \"invalid level:\" + newLevel;\r\n        }\r\n        var newPosition = this._safelyGetNewPositonByLevel(newLevel);\r\n        var oldPosition = this.getPosition();\r\n        var span = this.animationDuration;\r\n        var singleSpan = 1000 / 60;\r\n        var count = Math.floor(span / singleSpan);\r\n        var deltaX = (newPosition.x - oldPosition.x) / count;\r\n        var deltaY = (newPosition.y - oldPosition.y) / count;\r\n        var deltaZ = (newPosition.z - oldPosition.z) / count;\r\n        var deltaLevel = (newLevel - this.level) / count;\r\n        var start = -1;\r\n        this.floatLevel = this.level;\r\n        this.animating = true;\r\n        var callback = function (timestap) {\r\n            if (start < 0) {\r\n                start = timestap;\r\n            }\r\n            var a = timestap - start;\r\n            if (a >= span) {\r\n                _this.animating = false;\r\n                _this.floatLevel = newLevel;\r\n                _this.setLevel(newLevel);\r\n                if (cb) {\r\n                    cb();\r\n                }\r\n            }\r\n            else {\r\n                _this.floatLevel += deltaLevel;\r\n                var p = _this.getPosition();\r\n                _this.setPosition(new Vertice_1.default(p.x + deltaX, p.y + deltaY, p.z + deltaZ));\r\n                requestAnimationFrame(callback);\r\n            }\r\n        };\r\n        requestAnimationFrame(callback);\r\n    };\r\n    Camera.prototype.setExtent = function (extent) {\r\n        if (extent) {\r\n            var _a = this._calculateLonLatLevelByExtent(extent), lon = _a[0], lat = _a[1], level = _a[2];\r\n            this.centerTo(lon, lat, level);\r\n        }\r\n    };\r\n    Camera.prototype.animateToExtent = function (extent, duration) {\r\n        if (duration === void 0) { duration = 1000; }\r\n        var _a = this._calculateLonLatLevelByExtent(extent), lon = _a[0], lat = _a[1], level = _a[2];\r\n        return this.animateTo(lon, lat, level, duration);\r\n    };\r\n    Camera.prototype._safelyGetNewPositonByLevel = function (newLevel) {\r\n        var newCameraMatrix = this.matrix.clone();\r\n        this._updatePositionByLevel(newLevel, newCameraMatrix);\r\n        var newPosition = newCameraMatrix.getPosition();\r\n        return newPosition;\r\n    };\r\n    Camera.prototype._setPositionByLonLatDistance = function (newLon, newLat, newLengthFromOrigin2Positon) {\r\n        var _a = this.getLonlat(), lon = _a[0], lat = _a[1];\r\n        var deltaLon = newLon - lon;\r\n        var deltaLat = newLat - lat;\r\n        this._setPositionByDeltaLonLatDistance(deltaLon, deltaLat);\r\n        if (newLengthFromOrigin2Positon > 0) {\r\n            this._setPositionByDistanceFromOrigin2Camera(newLengthFromOrigin2Positon);\r\n        }\r\n    };\r\n    Camera.prototype._setPositionByDeltaLonLatDistance = function (deltaLon, deltaLat, deltaHeight) {\r\n        var deltaLonRadian = Utils_2.default.degreeToRadian(deltaLon);\r\n        var deltaLatRadian = Utils_2.default.degreeToRadian(deltaLat);\r\n        this.worldRotateY(deltaLonRadian);\r\n        var vector1 = Vector_1.default.fromVertice(this.getPosition());\r\n        var vector2 = new Vector_1.default(0, 1, 0);\r\n        var crossAxis = vector1.cross(vector2);\r\n        this.worldRotateByVector(deltaLatRadian, crossAxis);\r\n        if (deltaHeight > 0 || deltaHeight < 0) {\r\n            var vectorFromOrigin2Position = Vector_1.default.fromVertice(this.getPosition());\r\n            var newLength = vectorFromOrigin2Position.getLength() + deltaHeight;\r\n            vectorFromOrigin2Position.setLength(newLength);\r\n            var newPosition = vectorFromOrigin2Position.getVertice();\r\n            this.setPosition(newPosition);\r\n        }\r\n    };\r\n    Camera.prototype._setPositionByDistanceFromOrigin2Camera = function (newLengthFromOrigin2Positon) {\r\n        var vectorFromOrigin2Position = Vector_1.default.fromVertice(this.getPosition());\r\n        vectorFromOrigin2Position.setLength(newLengthFromOrigin2Positon);\r\n        var newPosition = vectorFromOrigin2Position.getVertice();\r\n        this.setPosition(newPosition);\r\n    };\r\n    Camera.prototype._safelyGetValidLevel = function (level) {\r\n        if (level > Kernel_1.default.MAX_LEVEL) {\r\n            level = Kernel_1.default.MAX_LEVEL;\r\n        }\r\n        else if (level < Kernel_1.default.MIN_LEVEL) {\r\n            level = Kernel_1.default.MIN_LEVEL;\r\n        }\r\n        return level;\r\n    };\r\n    Camera.prototype._calculateLonLatLevelByExtent = function (extent) {\r\n        var centerLon = (extent.getMinLon() + extent.getMaxLon()) / 2;\r\n        var centerLat = (extent.getMinLat() + extent.getMaxLat()) / 2;\r\n        var deltaLon = extent.getMaxLon() - extent.getMinLon();\r\n        var deltaLonRadian = Utils_2.default.degreeToRadian(deltaLon);\r\n        var deltaLength = Kernel_1.default.EARTH_RADIUS * deltaLonRadian;\r\n        var resolution = deltaLength / this.width;\r\n        var bestFloatLevel = this._calculateLevelByResolution(resolution);\r\n        var level = Math.floor(bestFloatLevel);\r\n        level = this._safelyGetValidLevel(level);\r\n        return [centerLon, centerLat, level];\r\n    };\r\n    Camera.prototype._look = function (cameraPnt, targetPnt, upDirection) {\r\n        if (upDirection === void 0) { upDirection = new Vector_1.default(0, 1, 0); }\r\n        var cameraPntCopy = cameraPnt.clone();\r\n        var targetPntCopy = targetPnt.clone();\r\n        var up = upDirection.clone();\r\n        var zAxis = new Vector_1.default(cameraPntCopy.x - targetPntCopy.x, cameraPntCopy.y - targetPntCopy.y, cameraPntCopy.z - targetPntCopy.z);\r\n        zAxis.normalize();\r\n        var xAxis = up.cross(zAxis).normalize();\r\n        var yAxis = zAxis.cross(xAxis).normalize();\r\n        this.matrix.setVectorX(xAxis);\r\n        this.matrix.setVectorY(yAxis);\r\n        this.matrix.setVectorZ(zAxis);\r\n        this.matrix.setPosition(cameraPntCopy);\r\n        this.matrix.setLastRowDefault();\r\n        this._updateFar();\r\n    };\r\n    Camera.prototype._lookAt = function (targetPnt, upDirection) {\r\n        var targetPntCopy = targetPnt.clone();\r\n        var position = this.getPosition();\r\n        this._look(position, targetPntCopy, upDirection);\r\n    };\r\n    Camera.prototype._getPickDirectionByCanvas = function (canvasX, canvasY) {\r\n        var ndcXY = Utils_2.default.convertPointFromCanvasToNDC(this.width, this.height, canvasX, canvasY);\r\n        var pickDirection = this._getPickDirectionByNDC(ndcXY[0], ndcXY[1]);\r\n        return pickDirection;\r\n    };\r\n    Camera.prototype._getDirectionIntersectPointWithEarth = function (cameraMatrix) {\r\n        var dir = cameraMatrix.getVectorZ().getOpposite();\r\n        var p = cameraMatrix.getPosition();\r\n        var line = new Line_1.default(p, dir);\r\n        var result = this._getPickCartesianCoordInEarthByLine(line);\r\n        return result;\r\n    };\r\n    Camera.prototype._getPickDirectionByNDC = function (ndcX, ndcY) {\r\n        var verticeInNDC = new Vertice_1.default(ndcX, ndcY, 0.499);\r\n        var verticeInWorld = this._convertVerticeFromNdcToWorld(verticeInNDC);\r\n        var cameraPositon = this.getPosition();\r\n        var pickDirection = Vector_1.default.verticeMinusVertice(verticeInWorld, cameraPositon);\r\n        pickDirection.normalize();\r\n        return pickDirection;\r\n    };\r\n    Camera.prototype._getPickCartesianCoordInEarthByLine = function (line) {\r\n        var result = [];\r\n        var pickVertices = Utils_2.default.getLineIntersectPointWithEarth(line);\r\n        if (pickVertices.length === 0) {\r\n            result = [];\r\n        }\r\n        else if (pickVertices.length == 1) {\r\n            result = pickVertices;\r\n        }\r\n        else if (pickVertices.length == 2) {\r\n            var pickVerticeA = pickVertices[0];\r\n            var pickVerticeB = pickVertices[1];\r\n            var cameraVertice = this.getPosition();\r\n            var lengthA = Utils_2.default.getLengthFromVerticeToVertice(cameraVertice, pickVerticeA);\r\n            var lengthB = Utils_2.default.getLengthFromVerticeToVertice(cameraVertice, pickVerticeB);\r\n            result = lengthA <= lengthB ? [pickVerticeA, pickVerticeB] : [pickVerticeB, pickVerticeA];\r\n        }\r\n        return result;\r\n    };\r\n    Camera.prototype._getPickLonLatByNDC = function (ndcX, ndcY) {\r\n        var result = null;\r\n        var vertices = this._getPickCartesianCoordInEarthByNDC(ndcX, ndcY);\r\n        if (vertices.length > 0) {\r\n            result = Utils_2.default.cartesianCoordToGeographic(vertices[0]);\r\n        }\r\n        return result;\r\n    };\r\n    Camera.prototype._getPickCartesianCoordInEarthByNDC = function (ndcX, ndcY) {\r\n        var pickDirection = this._getPickDirectionByNDC(ndcX, ndcY);\r\n        var p = this.getPosition();\r\n        var line = new Line_1.default(p, pickDirection);\r\n        var result = this._getPickCartesianCoordInEarthByLine(line);\r\n        return result;\r\n    };\r\n    Camera.prototype._getPlanXOZ = function () {\r\n        var position = this.getPosition();\r\n        var direction = this.getLightDirection();\r\n        var plan = Utils_2.default.getCrossPlaneByLine(position, direction);\r\n        return plan;\r\n    };\r\n    Camera.prototype._convertVerticeFromWorldToNDC = function (verticeInWorld) {\r\n        var columnWorld = [verticeInWorld.x, verticeInWorld.y, verticeInWorld.z, 1];\r\n        var columnProject = this.projViewMatrix.multiplyColumn(columnWorld);\r\n        var w = columnProject[3];\r\n        var columnNDC = [];\r\n        columnNDC[0] = columnProject[0] / w;\r\n        columnNDC[1] = columnProject[1] / w;\r\n        columnNDC[2] = columnProject[2] / w;\r\n        columnNDC[3] = 1;\r\n        var verticeInNDC = new Vertice_1.default(columnNDC[0], columnNDC[1], columnNDC[2]);\r\n        return verticeInNDC;\r\n    };\r\n    Camera.prototype._convertVerticeFromNdcToWorld = function (verticeInNDC) {\r\n        var columnNDC = [verticeInNDC.x, verticeInNDC.y, verticeInNDC.z, 1];\r\n        var inverseProj = this.projMatrix.getInverseMatrix();\r\n        var columnCameraTemp = inverseProj.multiplyColumn(columnNDC);\r\n        var cameraX = columnCameraTemp[0] / columnCameraTemp[3];\r\n        var cameraY = columnCameraTemp[1] / columnCameraTemp[3];\r\n        var cameraZ = columnCameraTemp[2] / columnCameraTemp[3];\r\n        var cameraW = 1;\r\n        var columnCamera = [cameraX, cameraY, cameraZ, cameraW];\r\n        var columnWorld = this.matrix.multiplyColumn(columnCamera);\r\n        var verticeInWorld = new Vertice_1.default(columnWorld[0], columnWorld[1], columnWorld[2]);\r\n        return verticeInWorld;\r\n    };\r\n    Camera.prototype._convertVerticeFromCameraToWorld = function (verticeInCamera) {\r\n        var verticeInCameraCopy = verticeInCamera.clone();\r\n        var column = [verticeInCameraCopy.x, verticeInCameraCopy.y, verticeInCameraCopy.z, 1];\r\n        var column2 = this.matrix.multiplyColumn(column);\r\n        var verticeInWorld = new Vertice_1.default(column2[0], column2[1], column2[2]);\r\n        return verticeInWorld;\r\n    };\r\n    Camera.prototype._convertVectorFromCameraToWorld = function (vectorInCamera) {\r\n        var vectorInCameraCopy = vectorInCamera.clone();\r\n        var verticeInCamera = vectorInCameraCopy.getVertice();\r\n        var verticeInWorld = this._convertVerticeFromCameraToWorld(verticeInCamera);\r\n        var originInWorld = this.getPosition();\r\n        var vectorInWorld = Vector_1.default.verticeMinusVertice(verticeInWorld, originInWorld);\r\n        vectorInWorld.normalize();\r\n        return vectorInWorld;\r\n    };\r\n    Camera.prototype._isWorldVerticeVisibleInCanvas = function (verticeInWorld, options) {\r\n        if (options === void 0) { options = {}; }\r\n        var threshold = typeof options.threshold == \"number\" ? Math.abs(options.threshold) : 1;\r\n        var cameraP = this.getPosition();\r\n        var dir = Vector_1.default.verticeMinusVertice(verticeInWorld, cameraP);\r\n        var line = new Line_1.default(cameraP, dir);\r\n        var pickResult = this._getPickCartesianCoordInEarthByLine(line);\r\n        if (pickResult.length > 0) {\r\n            var pickVertice = pickResult[0];\r\n            var length2Vertice = Utils_2.default.getLengthFromVerticeToVertice(cameraP, verticeInWorld);\r\n            var length2Pick = Utils_2.default.getLengthFromVerticeToVertice(cameraP, pickVertice);\r\n            if (length2Vertice < length2Pick + 5) {\r\n                if (!(options.verticeInNDC instanceof Vertice_1.default)) {\r\n                    options.verticeInNDC = this._convertVerticeFromWorldToNDC(verticeInWorld);\r\n                }\r\n                var result = options.verticeInNDC.x >= -1 && options.verticeInNDC.x <= 1 && options.verticeInNDC.y >= -threshold && options.verticeInNDC.y <= 1;\r\n                return result;\r\n            }\r\n        }\r\n        return false;\r\n    };\r\n    Camera.prototype._isGeoVisibleInCanvas = function (lon, lat, options) {\r\n        var verticeInWorld = Utils_2.default.geographicToCartesianCoord(lon, lat);\r\n        var result = this._isWorldVerticeVisibleInCanvas(verticeInWorld, options);\r\n        return result;\r\n    };\r\n    Camera.prototype.getVisibleTilesByLevel = function (level, options) {\r\n        if (options === void 0) { options = {}; }\r\n        if (!(level >= 0)) {\r\n            throw \"invalid level\";\r\n        }\r\n        var result = [];\r\n        var LOOP_LIMIT = Math.min(10, Math.pow(2, level) - 1);\r\n        var mathOptions = {\r\n            maxSize: Math.pow(2, level)\r\n        };\r\n        function checkVisible(visibleInfo) {\r\n            if (visibleInfo.area >= 5000 && visibleInfo.clockwise) {\r\n                if (visibleInfo.visibleCount >= 1) {\r\n                    return true;\r\n                }\r\n            }\r\n            return false;\r\n        }\r\n        function handleRow(centerRow, centerColumn) {\r\n            var result = [];\r\n            var grid = new TileGrid_1.default(level, centerRow, centerColumn);\r\n            var visibleInfo = this._getTileVisibleInfo(grid.level, grid.row, grid.column, options);\r\n            var isRowCenterVisible = checkVisible(visibleInfo);\r\n            if (isRowCenterVisible) {\r\n                grid.visibleInfo = visibleInfo;\r\n                result.push(grid);\r\n                var leftLoopTime = 0;\r\n                var leftColumn = centerColumn;\r\n                var visible;\r\n                while (leftLoopTime < LOOP_LIMIT) {\r\n                    leftLoopTime++;\r\n                    grid = TileGrid_1.default.getTileGridByBrother(level, centerRow, leftColumn, TileGrid_1.TileGridPosition.LEFT, mathOptions);\r\n                    leftColumn = grid.column;\r\n                    visibleInfo = this._getTileVisibleInfo(grid.level, grid.row, grid.column, options);\r\n                    visible = checkVisible(visibleInfo);\r\n                    if (visible) {\r\n                        grid.visibleInfo = visibleInfo;\r\n                        result.push(grid);\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n                var rightLoopTime = 0;\r\n                var rightColumn = centerColumn;\r\n                while (rightLoopTime < LOOP_LIMIT) {\r\n                    rightLoopTime++;\r\n                    grid = TileGrid_1.default.getTileGridByBrother(level, centerRow, rightColumn, TileGrid_1.TileGridPosition.RIGHT, mathOptions);\r\n                    rightColumn = grid.column;\r\n                    visibleInfo = this._getTileVisibleInfo(grid.level, grid.row, grid.column, options);\r\n                    visible = checkVisible(visibleInfo);\r\n                    if (visible) {\r\n                        grid.visibleInfo = visibleInfo;\r\n                        result.push(grid);\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            return result;\r\n        }\r\n        var centerGrid = null;\r\n        var verticalCenterInfo = this._getVerticalVisibleCenterInfo();\r\n        if (TileGrid_1.default.isValidLatitude(verticalCenterInfo.lat)) {\r\n            centerGrid = TileGrid_1.default.getTileGridByGeo(verticalCenterInfo.lon, verticalCenterInfo.lat, level);\r\n        }\r\n        else {\r\n            centerGrid = new TileGrid_1.default(level, 0, 0);\r\n        }\r\n        var handleRowThis = handleRow.bind(this);\r\n        var rowResult = handleRowThis(centerGrid.row, centerGrid.column);\r\n        result = result.concat(rowResult);\r\n        var grid;\r\n        var bottomLoopTime = 0;\r\n        var bottomRow = centerGrid.row;\r\n        while (bottomLoopTime < LOOP_LIMIT) {\r\n            bottomLoopTime++;\r\n            grid = TileGrid_1.default.getTileGridByBrother(level, bottomRow, centerGrid.column, TileGrid_1.TileGridPosition.BOTTOM, mathOptions);\r\n            bottomRow = grid.row;\r\n            rowResult = handleRowThis(grid.row, grid.column);\r\n            if (rowResult.length > 0) {\r\n                result = result.concat(rowResult);\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        var topLoopTime = 0;\r\n        var topRow = centerGrid.row;\r\n        while (topLoopTime < LOOP_LIMIT) {\r\n            topLoopTime++;\r\n            grid = TileGrid_1.default.getTileGridByBrother(level, topRow, centerGrid.column, TileGrid_1.TileGridPosition.TOP, mathOptions);\r\n            topRow = grid.row;\r\n            rowResult = handleRowThis(grid.row, grid.column);\r\n            if (rowResult.length > 0) {\r\n                result = result.concat(rowResult);\r\n            }\r\n            else {\r\n                break;\r\n            }\r\n        }\r\n        return result;\r\n    };\r\n    Camera.prototype._getTileVisibleInfo = function (level, row, column, options) {\r\n        if (!(level >= 0)) {\r\n            throw \"invalid level\";\r\n        }\r\n        if (!(row >= 0)) {\r\n            throw \"invalid row\";\r\n        }\r\n        if (!(column >= 0)) {\r\n            throw \"invalid column\";\r\n        }\r\n        var threshold = typeof options.threshold == \"number\" ? Math.abs(options.threshold) : 1;\r\n        options.threshold = threshold;\r\n        var result = {\r\n            lb: {\r\n                lon: null,\r\n                lat: null,\r\n                verticeInWorld: null,\r\n                verticeInNDC: null,\r\n                visible: false\r\n            },\r\n            lt: {\r\n                lon: null,\r\n                lat: null,\r\n                verticeInWorld: null,\r\n                verticeInNDC: null,\r\n                visible: false\r\n            },\r\n            rt: {\r\n                lon: null,\r\n                lat: null,\r\n                verticeInWorld: null,\r\n                verticeInNDC: null,\r\n                visible: false\r\n            },\r\n            rb: {\r\n                lon: null,\r\n                lat: null,\r\n                verticeInWorld: null,\r\n                verticeInNDC: null,\r\n                visible: false\r\n            },\r\n            Egeo: null,\r\n            visibleCount: 0,\r\n            clockwise: false,\r\n            width: null,\r\n            height: null,\r\n            area: null\r\n        };\r\n        result.Egeo = Utils_2.default.getTileGeographicEnvelopByGrid(level, row, column);\r\n        var tileMinLon = result.Egeo.minLon;\r\n        var tileMaxLon = result.Egeo.maxLon;\r\n        var tileMinLat = result.Egeo.minLat;\r\n        var tileMaxLat = result.Egeo.maxLat;\r\n        result.lb.lon = tileMinLon;\r\n        result.lb.lat = tileMinLat;\r\n        result.lb.verticeInWorld = Utils_2.default.geographicToCartesianCoord(result.lb.lon, result.lb.lat);\r\n        result.lb.verticeInNDC = this._convertVerticeFromWorldToNDC(result.lb.verticeInWorld);\r\n        result.lb.visible = this._isWorldVerticeVisibleInCanvas(result.lb.verticeInWorld, {\r\n            verticeInNDC: result.lb.verticeInNDC,\r\n            threshold: threshold\r\n        });\r\n        if (result.lb.visible) {\r\n            result.visibleCount++;\r\n        }\r\n        result.lt.lon = tileMinLon;\r\n        result.lt.lat = tileMaxLat;\r\n        result.lt.verticeInWorld = Utils_2.default.geographicToCartesianCoord(result.lt.lon, result.lt.lat);\r\n        result.lt.verticeInNDC = this._convertVerticeFromWorldToNDC(result.lt.verticeInWorld);\r\n        result.lt.visible = this._isWorldVerticeVisibleInCanvas(result.lt.verticeInWorld, {\r\n            verticeInNDC: result.lt.verticeInNDC,\r\n            threshold: threshold\r\n        });\r\n        if (result.lt.visible) {\r\n            result.visibleCount++;\r\n        }\r\n        result.rt.lon = tileMaxLon;\r\n        result.rt.lat = tileMaxLat;\r\n        result.rt.verticeInWorld = Utils_2.default.geographicToCartesianCoord(result.rt.lon, result.rt.lat);\r\n        result.rt.verticeInNDC = this._convertVerticeFromWorldToNDC(result.rt.verticeInWorld);\r\n        result.rt.visible = this._isWorldVerticeVisibleInCanvas(result.rt.verticeInWorld, {\r\n            verticeInNDC: result.rt.verticeInNDC,\r\n            threshold: threshold\r\n        });\r\n        if (result.rt.visible) {\r\n            result.visibleCount++;\r\n        }\r\n        result.rb.lon = tileMaxLon;\r\n        result.rb.lat = tileMinLat;\r\n        result.rb.verticeInWorld = Utils_2.default.geographicToCartesianCoord(result.rb.lon, result.rb.lat);\r\n        result.rb.verticeInNDC = this._convertVerticeFromWorldToNDC(result.rb.verticeInWorld);\r\n        result.rb.visible = this._isWorldVerticeVisibleInCanvas(result.rb.verticeInWorld, {\r\n            verticeInNDC: result.rb.verticeInNDC,\r\n            threshold: threshold\r\n        });\r\n        if (result.rb.visible) {\r\n            result.visibleCount++;\r\n        }\r\n        var ndcs = [result.lb.verticeInNDC, result.lt.verticeInNDC, result.rt.verticeInNDC, result.rb.verticeInNDC];\r\n        var vector03 = Vector_1.default.verticeMinusVertice(ndcs[3], ndcs[0]);\r\n        vector03.z = 0;\r\n        var vector01 = Vector_1.default.verticeMinusVertice(ndcs[1], ndcs[0]);\r\n        vector01.z = 0;\r\n        var cross = vector03.cross(vector01);\r\n        result.clockwise = cross.z > 0;\r\n        var topWidth = Math.sqrt(Math.pow(ndcs[1].x - ndcs[2].x, 2) + Math.pow(ndcs[1].y - ndcs[2].y, 2)) * this.width / 2;\r\n        var bottomWidth = Math.sqrt(Math.pow(ndcs[0].x - ndcs[3].x, 2) + Math.pow(ndcs[0].y - ndcs[3].y, 2)) * this.width / 2;\r\n        result.width = Math.floor((topWidth + bottomWidth) / 2);\r\n        var leftHeight = Math.sqrt(Math.pow(ndcs[0].x - ndcs[1].x, 2) + Math.pow(ndcs[0].y - ndcs[1].y, 2)) * this.height / 2;\r\n        var rightHeight = Math.sqrt(Math.pow(ndcs[2].x - ndcs[3].x, 2) + Math.pow(ndcs[2].y - ndcs[3].y, 2)) * this.height / 2;\r\n        result.height = Math.floor((leftHeight + rightHeight) / 2);\r\n        result.area = result.width * result.height;\r\n        return result;\r\n    };\r\n    Camera.prototype._getVerticalVisibleCenterInfo = function () {\r\n        var result = {\r\n            ndcY: null,\r\n            pIntersect: null,\r\n            lon: null,\r\n            lat: null\r\n        };\r\n        var pickResults;\r\n        if (this.isZeroPitch) {\r\n            result.ndcY = 0;\r\n        }\r\n        else {\r\n            var count = 10;\r\n            var delta = 2.0 / count;\r\n            var topNdcY = 1;\r\n            var bottomNdcY = -1;\r\n            var ndcY;\r\n            for (ndcY = 1.0; ndcY >= -1.0; ndcY -= delta) {\r\n                pickResults = this._getPickCartesianCoordInEarthByNDC(0, ndcY);\r\n                if (pickResults.length > 0) {\r\n                    topNdcY = ndcY;\r\n                    break;\r\n                }\r\n            }\r\n            for (ndcY = -1.0; ndcY <= 1.0; ndcY += delta) {\r\n                pickResults = this._getPickCartesianCoordInEarthByNDC(0, ndcY);\r\n                if (pickResults.length > 0) {\r\n                    bottomNdcY = ndcY;\r\n                    break;\r\n                }\r\n            }\r\n            result.ndcY = (topNdcY + bottomNdcY) / 2;\r\n        }\r\n        pickResults = this._getPickCartesianCoordInEarthByNDC(0, result.ndcY);\r\n        result.pIntersect = pickResults[0];\r\n        var lonlat = Utils_2.default.cartesianCoordToGeographic(result.pIntersect);\r\n        result.lon = lonlat[0];\r\n        result.lat = lonlat[1];\r\n        return result;\r\n    };\r\n    return Camera;\r\n}(Object3D_1.default));\r\nexports.default = Camera;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Camera.ts\n// module id = 83\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar EventEmitter = (function () {\r\n    function EventEmitter() {\r\n        this.events = null;\r\n        this.events = {};\r\n    }\r\n    EventEmitter.prototype.emit = function (eventName, data) {\r\n        var listeners = this.events[eventName];\r\n        if (listeners) {\r\n            listeners.forEach(function (listener) {\r\n                listener(data);\r\n            });\r\n        }\r\n    };\r\n    EventEmitter.prototype.on = function (eventName, listener) {\r\n        return this.addEventListener(eventName, listener);\r\n    };\r\n    EventEmitter.prototype.addEventListener = function (eventName, listener) {\r\n        var _this = this;\r\n        var listeners = this.events[eventName];\r\n        if (listeners) {\r\n            listeners.push(listener);\r\n        }\r\n        else {\r\n            this.events[eventName] = [listener];\r\n        }\r\n        var handle = {};\r\n        handle.remove = function () { return _this.removeEventListener(eventName, listener); };\r\n        return handle;\r\n    };\r\n    EventEmitter.prototype.removeEventListener = function (eventName, listener) {\r\n        var listeners = this.events[eventName];\r\n        if (listeners) {\r\n            var index1 = listeners.indexOf(listener);\r\n            if (index1 >= 0) {\r\n                listeners.splice(index1, 1);\r\n            }\r\n        }\r\n    };\r\n    EventEmitter.prototype.removeAllEventListeners = function (eventName) {\r\n        if (eventName) {\r\n            this.events[eventName] = [];\r\n        }\r\n        else {\r\n            this.events = {};\r\n        }\r\n    };\r\n    return EventEmitter;\r\n}());\r\nexports.EventEmitter = EventEmitter;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Events.ts\n// module id = 84\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Plan = (function () {\r\n    function Plan(A, B, C, D) {\r\n        this.A = A;\r\n        this.B = B;\r\n        this.C = C;\r\n        this.D = D;\r\n    }\r\n    Plan.prototype.clone = function () {\r\n        var planCopy = new Plan(this.A, this.B, this.C, this.D);\r\n        return planCopy;\r\n    };\r\n    return Plan;\r\n}());\r\nexports.default = Plan;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/math/Plan.ts\n// module id = 85\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar GraphicGroup_1 = require(\"./GraphicGroup\");\r\nvar Scene = (function (_super) {\r\n    __extends(Scene, _super);\r\n    function Scene() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Scene.prototype.pickByWorldLine = function (worldLine) {\r\n        var count = this.children.length;\r\n        for (var i = count - 1; i >= 0; i--) {\r\n            var graphicGroup = this.children[i];\r\n            if (graphicGroup instanceof GraphicGroup_1.PickableGraphicGroup) {\r\n                var pickableGraphicGroup = graphicGroup;\r\n                var target = pickableGraphicGroup.pickByWorldLine(worldLine, true);\r\n                if (target) {\r\n                    return target;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    return Scene;\r\n}(GraphicGroup_1.default));\r\nexports.default = Scene;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/Scene.ts\n// module id = 86\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Utils_1 = require(\"./Utils\");\r\nvar Utils_2 = require(\"./math/Utils\");\r\nvar Vector_1 = require(\"./math/Vector\");\r\nvar EventHandler = (function () {\r\n    function EventHandler(globe) {\r\n        this.globe = globe;\r\n        this.down = false;\r\n        this.dragGeo = null;\r\n        this.previousX = -1;\r\n        this.previousY = -1;\r\n        this.twoTouchDistance = -1;\r\n        this.oldTime = -1;\r\n        this.lastTime = -1;\r\n        this.startTime = -1;\r\n        this.endTime = -1;\r\n        this.resizeListener = null;\r\n        this.bodyKeydownListener = null;\r\n        this.endTime = this.startTime = this.lastTime = this.oldTime = Date.now();\r\n        this._bindEvents();\r\n    }\r\n    EventHandler.prototype.destroy = function () {\r\n        if (this.bodyKeydownListener) {\r\n            document.body.removeEventListener(\"keydown\", this.bodyKeydownListener);\r\n        }\r\n        this.bodyKeydownListener = null;\r\n        this.globe = null;\r\n    };\r\n    EventHandler.prototype._bindEvents = function () {\r\n        if (Utils_1.default.isMobile()) {\r\n            this.globe.canvas.addEventListener(\"touchstart\", this._onTouchStart.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"touchend\", this._onTouchEnd.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"touchmove\", this._onTouchMove.bind(this), false);\r\n        }\r\n        else {\r\n            this.globe.canvas.addEventListener(\"mousedown\", this._onMouseDown.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"mouseup\", this._onMouseUp.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"mousemove\", this._onMouseMove.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"click\", this._onClick.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"dblclick\", this._onDbClick.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"mousewheel\", this._onMouseWheel.bind(this), false);\r\n            this.globe.canvas.addEventListener(\"DOMMouseScroll\", this._onMouseWheel.bind(this), false);\r\n            this.bodyKeydownListener = this._onKeyDown.bind(this);\r\n            document.body.addEventListener(\"keydown\", this.bodyKeydownListener, false);\r\n        }\r\n    };\r\n    EventHandler.prototype.moveLonLatToCanvas = function (lon, lat, canvasX, canvasY) {\r\n        var pickResult = this.globe.camera.getPickCartesianCoordInEarthByCanvas(canvasX, canvasY);\r\n        if (pickResult.length > 0) {\r\n            var newLonLat = Utils_2.default.cartesianCoordToGeographic(pickResult[0]);\r\n            var newLon = newLonLat[0];\r\n            var newLat = newLonLat[1];\r\n            this._moveGeo(lon, lat, newLon, newLat);\r\n        }\r\n    };\r\n    EventHandler.prototype._moveGeo = function (oldLon, oldLat, newLon, newLat) {\r\n        if (oldLon === newLon && oldLat === newLat) {\r\n            return;\r\n        }\r\n        var p1 = Utils_2.default.geographicToCartesianCoord(oldLon, oldLat);\r\n        var v1 = Vector_1.default.fromVertice(p1);\r\n        var p2 = Utils_2.default.geographicToCartesianCoord(newLon, newLat);\r\n        var v2 = Vector_1.default.fromVertice(p2);\r\n        var rotateVector = v1.cross(v2);\r\n        var rotateRadian = -Vector_1.default.getRadianOfTwoVectors(v1, v2);\r\n        this.globe.camera.worldRotateByVector(rotateRadian, rotateVector);\r\n    };\r\n    EventHandler.prototype._handleSingleClick = function (canvasX, canvasY) {\r\n        this.globe.pick(canvasX, canvasY);\r\n    };\r\n    EventHandler.prototype._handleMouseDownOrTouchStart = function (offsetX, offsetY) {\r\n        this.down = true;\r\n        this.previousX = offsetX;\r\n        this.previousY = offsetY;\r\n        var pickResult = this.globe.camera.getPickCartesianCoordInEarthByCanvas(this.previousX, this.previousY);\r\n        if (pickResult.length > 0) {\r\n            this.dragGeo = Utils_2.default.cartesianCoordToGeographic(pickResult[0]);\r\n        }\r\n    };\r\n    EventHandler.prototype._handleMouseMoveOrTouchMove = function (currentX, currentY) {\r\n        var globe = this.globe;\r\n        if (!globe || globe.isAnimating() || !this.down) {\r\n            return;\r\n        }\r\n        var pickResult = globe.camera.getPickCartesianCoordInEarthByCanvas(currentX, currentY);\r\n        if (pickResult.length > 0) {\r\n            if (this.dragGeo) {\r\n                var newGeo = Utils_2.default.cartesianCoordToGeographic(pickResult[0]);\r\n                this._moveGeo(this.dragGeo[0], this.dragGeo[1], newGeo[0], newGeo[1]);\r\n            }\r\n            else {\r\n                this.dragGeo = Utils_2.default.cartesianCoordToGeographic(pickResult[0]);\r\n            }\r\n            this.previousX = currentX;\r\n            this.previousY = currentY;\r\n            this.globe.canvas.style.cursor = \"pointer\";\r\n        }\r\n        else {\r\n            this.previousX = -1;\r\n            this.previousY = -1;\r\n            this.dragGeo = null;\r\n            this.globe.canvas.style.cursor = \"default\";\r\n        }\r\n    };\r\n    EventHandler.prototype._handleMouseUpOrTouchEnd = function () {\r\n        this.down = false;\r\n        this.previousX = -1;\r\n        this.previousY = -1;\r\n        this.dragGeo = null;\r\n        if (this.globe.canvas) {\r\n            this.globe.canvas.style.cursor = \"default\";\r\n        }\r\n        Utils_1.default.publish(\"extent-change\");\r\n    };\r\n    EventHandler.prototype._onMouseDown = function (event) {\r\n        var globe = this.globe;\r\n        if (!globe || globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var previousX = event.layerX || event.offsetX;\r\n        var previousY = event.layerY || event.offsetY;\r\n        this._handleMouseDownOrTouchStart(previousX, previousY);\r\n    };\r\n    EventHandler.prototype._onMouseMove = function (event) {\r\n        if (!this.down) {\r\n            return;\r\n        }\r\n        if (this.globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var currentX = event.layerX || event.offsetX;\r\n        var currentY = event.layerY || event.offsetY;\r\n        this._handleMouseMoveOrTouchMove(currentX, currentY);\r\n    };\r\n    EventHandler.prototype._onMouseUp = function () {\r\n        this._handleMouseUpOrTouchEnd();\r\n    };\r\n    EventHandler.prototype._onClick = function (event) {\r\n        var absoluteX = event.layerX || event.offsetX;\r\n        var absoluteY = event.layerY || event.offsetY;\r\n        this._handleSingleClick(absoluteX, absoluteY);\r\n    };\r\n    EventHandler.prototype._onDbClick = function (event) {\r\n        var globe = this.globe;\r\n        if (!globe || globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var absoluteX = event.layerX || event.offsetX;\r\n        var absoluteY = event.layerY || event.offsetY;\r\n        var pickResult = globe.camera.getPickCartesianCoordInEarthByCanvas(absoluteX, absoluteY);\r\n        globe.zoomIn();\r\n        if (pickResult.length >= 1) {\r\n            var pickVertice = pickResult[0];\r\n            var lonlat = Utils_2.default.cartesianCoordToGeographic(pickVertice);\r\n            var lon = lonlat[0];\r\n            var lat = lonlat[1];\r\n            globe.zoomIn();\r\n            this.moveLonLatToCanvas(lon, lat, absoluteX, absoluteY);\r\n        }\r\n    };\r\n    EventHandler.prototype._onMouseWheel = function (event) {\r\n        var globe = this.globe;\r\n        if (!globe || globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var deltaLevel = 0;\r\n        var delta;\r\n        if (event.wheelDelta) {\r\n            delta = event.wheelDelta;\r\n            deltaLevel = parseInt((delta / 120));\r\n        }\r\n        else if (event.detail) {\r\n            delta = event.detail;\r\n            deltaLevel = -parseInt((delta / 3));\r\n        }\r\n        var newLevel = globe.getLevel() + deltaLevel;\r\n        if (newLevel >= 0) {\r\n            globe.animateToLevel(newLevel, function () {\r\n                Utils_1.default.publish(\"extent-change\");\r\n            });\r\n        }\r\n    };\r\n    EventHandler.prototype._onKeyDown = function (event) {\r\n        var globe = this.globe;\r\n        if (!globe || globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var DELTA_PITCH = 2;\r\n        var camera = globe.camera;\r\n        var keyNum = event.keyCode !== undefined ? event.keyCode : event.which;\r\n        if (keyNum === 38) {\r\n            camera.setDeltaPitch(DELTA_PITCH);\r\n        }\r\n        else if (keyNum === 40) {\r\n            camera.setDeltaPitch(-DELTA_PITCH);\r\n        }\r\n    };\r\n    EventHandler.prototype._onTouchZero = function (event) {\r\n        this.twoTouchDistance = -1;\r\n        var previousX = this.previousX;\r\n        var previousY = this.previousY;\r\n        this._handleMouseUpOrTouchEnd();\r\n        this.endTime = Date.now();\r\n        var time = this.endTime - this.startTime;\r\n        if (time <= 200) {\r\n            var time2 = this.endTime - this.lastTime;\r\n            if (time2 < 300) {\r\n                this.lastTime = this.oldTime;\r\n                this.globe.zoomIn();\r\n            }\r\n            else {\r\n                this.lastTime = this.endTime;\r\n                var _a = this.globe.canvas.getBoundingClientRect(), left = _a.left, top_1 = _a.top;\r\n                var canvasX = previousX - left;\r\n                var canvasY = previousY - top_1;\r\n                this._handleSingleClick(canvasX, canvasY);\r\n            }\r\n        }\r\n    };\r\n    EventHandler.prototype._onTouchOne = function (event) {\r\n        this.twoTouchDistance = -1;\r\n        var touch = event.targetTouches[0];\r\n        var previousX = touch.pageX;\r\n        var previousY = touch.pageY;\r\n        this._handleMouseDownOrTouchStart(previousX, previousY);\r\n        this.startTime = Date.now();\r\n    };\r\n    EventHandler.prototype._onTouchTwo = function (event) {\r\n        this.down = true;\r\n        this.previousX = -1;\r\n        this.previousY = -1;\r\n        this.dragGeo = null;\r\n        var touch1 = event.targetTouches[0];\r\n        var x1 = touch1.pageX;\r\n        var y1 = touch1.pageY;\r\n        var touch2 = event.targetTouches[1];\r\n        var x2 = touch2.pageX;\r\n        var y2 = touch2.pageY;\r\n        this.twoTouchDistance = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\r\n    };\r\n    EventHandler.prototype._onTouchMulti = function () {\r\n        this.down = true;\r\n        this.previousX = -1;\r\n        this.previousY = -1;\r\n        this.dragGeo = null;\r\n        this.twoTouchDistance = -1;\r\n    };\r\n    EventHandler.prototype._onTouchStart = function (event) {\r\n        var globe = this.globe;\r\n        if (!globe || globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var touchCount = event.targetTouches.length;\r\n        if (touchCount === 0) {\r\n            this._onTouchZero(event);\r\n        }\r\n        else if (touchCount === 1) {\r\n            this._onTouchOne(event);\r\n        }\r\n        else if (touchCount === 2) {\r\n            this._onTouchTwo(event);\r\n        }\r\n        else {\r\n            this._onTouchMulti();\r\n        }\r\n    };\r\n    EventHandler.prototype._onTouchMoveOne = function (event) {\r\n        var touch = event.targetTouches[0];\r\n        var currentX = touch.pageX;\r\n        var currentY = touch.pageY;\r\n        this._handleMouseMoveOrTouchMove(currentX, currentY);\r\n    };\r\n    EventHandler.prototype._onTouchMoveTwo = function (event) {\r\n        var _this = this;\r\n        var touch1 = event.targetTouches[0];\r\n        var x1 = touch1.pageX;\r\n        var y1 = touch1.pageY;\r\n        var touch2 = event.targetTouches[1];\r\n        var x2 = touch2.pageX;\r\n        var y2 = touch2.pageY;\r\n        var twoTouchDistance = Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));\r\n        var radio = twoTouchDistance / this.twoTouchDistance;\r\n        if (radio >= 1.3) {\r\n            this.globe.animateIn(function () {\r\n                _this.twoTouchDistance = twoTouchDistance;\r\n            });\r\n        }\r\n        else if (radio <= 0.7) {\r\n            this.globe.animateOut(function () {\r\n                _this.twoTouchDistance = twoTouchDistance;\r\n            });\r\n        }\r\n    };\r\n    EventHandler.prototype._onTouchMove = function (event) {\r\n        event.preventDefault();\r\n        if (!this.down) {\r\n            return;\r\n        }\r\n        if (this.globe.isAnimating()) {\r\n            return;\r\n        }\r\n        var touchCount = event.targetTouches.length;\r\n        if (touchCount === 1) {\r\n            this._onTouchMoveOne(event);\r\n        }\r\n        else if (touchCount === 2) {\r\n            this._onTouchMoveTwo(event);\r\n        }\r\n    };\r\n    EventHandler.prototype._onTouchEnd = function (event) {\r\n        var touchCount = event.targetTouches.length;\r\n        if (touchCount === 0) {\r\n            this._onTouchZero(event);\r\n        }\r\n        else if (touchCount === 1) {\r\n            this._onTouchOne(event);\r\n        }\r\n        else if (touchCount === 2) {\r\n            this._onTouchTwo(event);\r\n        }\r\n        else {\r\n            this._onTouchMulti();\r\n        }\r\n    };\r\n    return EventHandler;\r\n}());\r\nexports.default = EventHandler;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/EventHandler.ts\n// module id = 87\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar TiledLayer_1 = require(\"./TiledLayer\");\r\nvar LabelLayer_1 = require(\"./LabelLayer\");\r\nvar Env_1 = require(\"../Env\");\r\nvar scale = Env_1.devicePixelRatio > 1 ? 2 : 1;\r\nvar GoogleTiledLayer = (function (_super) {\r\n    __extends(GoogleTiledLayer, _super);\r\n    function GoogleTiledLayer(style) {\r\n        if (style === void 0) { style = \"Default\"; }\r\n        var _this = _super.call(this, style) || this;\r\n        _this.idx = 0;\r\n        return _this;\r\n    }\r\n    GoogleTiledLayer.prototype.getTileUrl = function (level, row, column) {\r\n        if (this.idx === undefined) {\r\n            this.idx = 0;\r\n        }\r\n        var lyrs = \"y\";\r\n        switch (this.style) {\r\n            case \"Satellite\":\r\n                lyrs = \"s\";\r\n                break;\r\n            case \"Road\":\r\n                lyrs = \"m\";\r\n                break;\r\n            case \"RoadOnly\":\r\n                lyrs = \"h\";\r\n                break;\r\n            case \"Terrain\":\r\n                lyrs = \"p\";\r\n                break;\r\n            case \"TerrainOnly\":\r\n                lyrs = \"t\";\r\n                break;\r\n        }\r\n        var url = \"//mt\" + this.idx + \".google.cn/maps/vt?lyrs=\" + lyrs + \"&hl=zh-CN&gl=CN&&x=\" + column + \"&y=\" + row + \"&z=\" + level + \"&scale=\" + scale;\r\n        this.idx++;\r\n        if (this.idx >= 4) {\r\n            this.idx = 0;\r\n        }\r\n        return url;\r\n    };\r\n    return GoogleTiledLayer;\r\n}(TiledLayer_1.default));\r\nexports.GoogleTiledLayer = GoogleTiledLayer;\r\n;\r\nvar GoogleLabelLayer = (function (_super) {\r\n    __extends(GoogleLabelLayer, _super);\r\n    function GoogleLabelLayer() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.idx = 0;\r\n        return _this;\r\n    }\r\n    GoogleLabelLayer.prototype.getTileUrl = function (level, row, column) {\r\n        if (this.idx === undefined) {\r\n            this.idx = 0;\r\n        }\r\n        var url = \"//mt\" + this.idx + \".google.cn/vt/imgtp=png32&lyrs=h@365000000&hl=zh-CN&gl=cn&x=\" + column + \"&y=\" + row + \"&z=\" + level + \"&s=Galil\";\r\n        this.idx++;\r\n        if (this.idx >= 4) {\r\n            this.idx = 0;\r\n        }\r\n        return url;\r\n    };\r\n    return GoogleLabelLayer;\r\n}(LabelLayer_1.default));\r\nexports.GoogleLabelLayer = GoogleLabelLayer;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/Google.ts\n// module id = 88\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar MeshTextureMaterial_1 = require(\"./MeshTextureMaterial\");\r\nvar Image_1 = require(\"../Image\");\r\nvar TileMaterial = (function (_super) {\r\n    __extends(TileMaterial, _super);\r\n    function TileMaterial(level, imageOrUrl) {\r\n        var _this = _super.call(this, imageOrUrl, true) || this;\r\n        _this.level = level >= 0 ? level : 20;\r\n        return _this;\r\n    }\r\n    TileMaterial.prototype.onLoad = function () {\r\n        if (this.level <= Image_1.default.MAX_LEVEL) {\r\n            Image_1.default.add(this.image.src, this.image);\r\n        }\r\n        _super.prototype.onLoad.call(this);\r\n    };\r\n    return TileMaterial;\r\n}(MeshTextureMaterial_1.default));\r\nexports.default = TileMaterial;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/materials/TileMaterial.ts\n// module id = 89\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Mesh_1 = require(\"./Mesh\");\r\nvar TileGeometry = (function (_super) {\r\n    __extends(TileGeometry, _super);\r\n    function TileGeometry(vertices, triangles) {\r\n        var _this = _super.call(this) || this;\r\n        _this.vertices = vertices;\r\n        _this.triangles = triangles;\r\n        return _this;\r\n    }\r\n    return TileGeometry;\r\n}(Mesh_1.default));\r\nexports.default = TileGeometry;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/geometries/TileGeometry.ts\n// module id = 90\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar TiledLayer_1 = require(\"./TiledLayer\");\r\nvar LabelLayer_1 = require(\"./LabelLayer\");\r\nvar AutonaviTiledLayer = (function (_super) {\r\n    __extends(AutonaviTiledLayer, _super);\r\n    function AutonaviTiledLayer(style) {\r\n        if (style === void 0) { style = \"Default\"; }\r\n        var _this = _super.call(this, style) || this;\r\n        _this.idx = 1;\r\n        return _this;\r\n    }\r\n    AutonaviTiledLayer.prototype.getTileUrl = function (level, row, column) {\r\n        if (this.idx === undefined) {\r\n            this.idx = 1;\r\n        }\r\n        var url = \"\";\r\n        if (this.style === 'Satellite') {\r\n            url = \"//webst0\" + this.idx + \".is.autonavi.com/appmaptile?style=6&x=\" + column + \"&y=\" + row + \"&z=\" + level;\r\n        }\r\n        else {\r\n            url = \"//webst0\" + this.idx + \".is.autonavi.com/appmaptile?style=7&x=\" + column + \"&y=\" + row + \"&z=\" + level;\r\n        }\r\n        this.idx++;\r\n        if (this.idx >= 5) {\r\n            this.idx = 1;\r\n        }\r\n        return url;\r\n    };\r\n    return AutonaviTiledLayer;\r\n}(TiledLayer_1.default));\r\nexports.AutonaviTiledLayer = AutonaviTiledLayer;\r\n;\r\nvar AutonaviLabelLayer = (function (_super) {\r\n    __extends(AutonaviLabelLayer, _super);\r\n    function AutonaviLabelLayer() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.idx = 1;\r\n        return _this;\r\n    }\r\n    AutonaviLabelLayer.prototype.getTileUrl = function (level, row, column) {\r\n        if (this.idx === undefined) {\r\n            this.idx = 1;\r\n        }\r\n        var url = \"//webst0\" + this.idx + \".is.autonavi.com/appmaptile?style=8&x=\" + column + \"&y=\" + row + \"&z=\" + level;\r\n        this.idx++;\r\n        if (this.idx >= 5) {\r\n            this.idx = 1;\r\n        }\r\n        return url;\r\n    };\r\n    return AutonaviLabelLayer;\r\n}(LabelLayer_1.default));\r\nexports.AutonaviLabelLayer = AutonaviLabelLayer;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/Autonavi.ts\n// module id = 91\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar MeshTextureGraphic_1 = require(\"./MeshTextureGraphic\");\r\nvar Atmosphere_1 = require(\"../geometries/Atmosphere\");\r\nvar MeshTextureMaterial_1 = require(\"../materials/MeshTextureMaterial\");\r\nvar Vector_1 = require(\"../math/Vector\");\r\nvar atmosphereImgUrl = require(\"../images/atmosphere.png\");\r\nvar Atmosphere = (function (_super) {\r\n    __extends(Atmosphere, _super);\r\n    function Atmosphere(geometry, material) {\r\n        var _this = _super.call(this, geometry, material) || this;\r\n        _this.geometry = geometry;\r\n        _this.material = material;\r\n        return _this;\r\n    }\r\n    Atmosphere.getInstance = function () {\r\n        var geometry = new Atmosphere_1.default();\r\n        var material = new MeshTextureMaterial_1.default(atmosphereImgUrl, false);\r\n        return new Atmosphere(geometry, material);\r\n    };\r\n    Atmosphere.prototype.shouldDraw = function (camera) {\r\n        return !camera.isEarthFullOverlapScreen() && _super.prototype.shouldDraw.call(this, camera);\r\n    };\r\n    Atmosphere.prototype.onDraw = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        gl.disable(Kernel_1.default.gl.DEPTH_TEST);\r\n        gl.depthMask(false);\r\n        gl.enable(Kernel_1.default.gl.BLEND);\r\n        gl.blendFunc(Kernel_1.default.gl.SRC_ALPHA, Kernel_1.default.gl.ONE_MINUS_SRC_ALPHA);\r\n        this.geometry.getMatrix().setUnitMatrix();\r\n        var R = Kernel_1.default.EARTH_RADIUS;\r\n        var distanceCamera2Origin = camera.getDistance2EarthOrigin();\r\n        var distanceCamera2EarthTangent = Math.sqrt(distanceCamera2Origin * distanceCamera2Origin - R * R);\r\n        var sinθ = distanceCamera2EarthTangent / distanceCamera2Origin;\r\n        var distanceCamera2Atmosphere = distanceCamera2EarthTangent * sinθ;\r\n        var vector = camera.getLightDirection().setLength(distanceCamera2Atmosphere);\r\n        var atmosphereNewPosition = Vector_1.default.verticePlusVector(camera.getPosition(), vector);\r\n        this.geometry.setPosition(atmosphereNewPosition);\r\n        this.geometry.setVectorX(camera.getVectorX());\r\n        this.geometry.setVectorY(camera.getVectorY());\r\n        this.geometry.setVectorZ(camera.getVectorZ());\r\n        this.geometry.localScale(sinθ, sinθ, sinθ);\r\n        _super.prototype.onDraw.call(this, camera);\r\n        gl.enable(Kernel_1.default.gl.DEPTH_TEST);\r\n        gl.depthMask(true);\r\n        gl.disable(Kernel_1.default.gl.BLEND);\r\n    };\r\n    return Atmosphere;\r\n}(MeshTextureGraphic_1.default));\r\nexports.default = Atmosphere;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/Atmosphere.ts\n// module id = 92\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar MeshVertice_1 = require(\"./MeshVertice\");\r\nvar Triangle_1 = require(\"./Triangle\");\r\nvar Mesh_1 = require(\"./Mesh\");\r\nvar Vertice_1 = require(\"../math/Vertice\");\r\nvar Matrix_1 = require(\"../math/Matrix\");\r\nvar Atmosphere = (function (_super) {\r\n    __extends(Atmosphere, _super);\r\n    function Atmosphere() {\r\n        var _this = _super.call(this) || this;\r\n        _this.segment = 360;\r\n        _this.radius1 = Kernel_1.default.EARTH_RADIUS * 0.99;\r\n        _this.radius2 = Kernel_1.default.EARTH_RADIUS * 1.01;\r\n        _this.buildTriangles();\r\n        return _this;\r\n    }\r\n    Atmosphere.prototype.buildTriangles = function () {\r\n        var _a, _b;\r\n        this.vertices = [];\r\n        this.triangles = [];\r\n        var mat1 = new Matrix_1.default();\r\n        mat1.setPosition(new Vertice_1.default(0, this.radius1, 0));\r\n        var meshVertices1 = [];\r\n        var mat2 = new Matrix_1.default();\r\n        mat2.setPosition(new Vertice_1.default(0, this.radius2, 0));\r\n        var meshVertices2 = [];\r\n        var deltaRadian = -Math.PI * 2 / this.segment;\r\n        var deltaS = 1.0 / this.segment;\r\n        var u = 0;\r\n        for (var i = 0; i <= this.segment; i++) {\r\n            u = deltaS * i;\r\n            if (u > 1) {\r\n                u = 1;\r\n            }\r\n            meshVertices1.push(new MeshVertice_1.default({\r\n                i: i,\r\n                p: mat1.getPosition().getArray(),\r\n                uv: [u, 1]\r\n            }));\r\n            meshVertices2.push(new MeshVertice_1.default({\r\n                i: this.segment + 1 + i,\r\n                p: mat2.getPosition().getArray(),\r\n                uv: [u, 0]\r\n            }));\r\n            if (i > 0) {\r\n                var vLeftTop = meshVertices2[i - 1];\r\n                var vLeftBottom = meshVertices1[i - 1];\r\n                var vRightTop = meshVertices2[i];\r\n                var vRightBottom = meshVertices1[i];\r\n                (_a = this.triangles).push.apply(_a, Triangle_1.default.assembleQuad(vLeftTop, vLeftBottom, vRightTop, vRightBottom));\r\n            }\r\n            mat1.worldRotateZ(deltaRadian);\r\n            mat2.worldRotateZ(deltaRadian);\r\n        }\r\n        (_b = this.vertices).push.apply(_b, meshVertices1.concat(meshVertices2));\r\n    };\r\n    return Atmosphere;\r\n}(Mesh_1.default));\r\nexports.default = Atmosphere;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/geometries/Atmosphere.ts\n// module id = 93\n// module chunks = 0 1","module.exports = __webpack_public_path__ + \"f42e74f3a391873a7d0d2ec2ae63eff9.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/images/atmosphere.png\n// module id = 94\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar MultiPointsGraphic_1 = require(\"../graphics/MultiPointsGraphic\");\r\nvar MarkerTextureMaterial_1 = require(\"../materials/MarkerTextureMaterial\");\r\nvar locationImageUrl = require('../images/location.png');\r\nvar LocationGraphic = (function (_super) {\r\n    __extends(LocationGraphic, _super);\r\n    function LocationGraphic(material, globe) {\r\n        var _this = _super.call(this, material) || this;\r\n        _this.globe = globe;\r\n        return _this;\r\n    }\r\n    LocationGraphic.prototype.setLonLat = function (lon, lat) {\r\n        this.setLonlats([[lon, lat]]);\r\n    };\r\n    LocationGraphic.prototype.destroy = function () {\r\n        this.globe = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    LocationGraphic.prototype.isReady = function () {\r\n        return this.globe && this.globe.camera.isEarthFullOverlapScreen() && _super.prototype.isReady.call(this);\r\n    };\r\n    LocationGraphic.getInstance = function (globe) {\r\n        var material = new MarkerTextureMaterial_1.default(locationImageUrl, 24);\r\n        return new LocationGraphic(material, globe);\r\n    };\r\n    return LocationGraphic;\r\n}(MultiPointsGraphic_1.default));\r\nexports.default = LocationGraphic;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/LocationGraphic.ts\n// module id = 95\n// module chunks = 0 1","module.exports = __webpack_public_path__ + \"0a1a7c4881e6fd01b9ef9772a7e1b2f3.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/images/location.png\n// module id = 96\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Utils_1 = require(\"../Utils\");\r\nvar Utils_2 = require(\"../math/Utils\");\r\nvar Vector_1 = require(\"../math/Vector\");\r\nvar MeshVertice_1 = require(\"../geometries/MeshVertice\");\r\nvar Mesh_1 = require(\"../geometries/Mesh\");\r\nvar MeshTextureGraphic_1 = require(\"../graphics/MeshTextureGraphic\");\r\nvar GraphicGroup_1 = require(\"../GraphicGroup\");\r\nvar MeshTextureMaterial_1 = require(\"../materials/MeshTextureMaterial\");\r\nvar Service_1 = require(\"../Service\");\r\nvar Extent_1 = require(\"../Extent\");\r\nvar poiImgUrl = require('../images/icons.png');\r\nvar PoiLayer = (function (_super) {\r\n    __extends(PoiLayer, _super);\r\n    function PoiLayer() {\r\n        var _this = _super.call(this) || this;\r\n        _this.keyword = null;\r\n        _this.searchExtentMode = false;\r\n        _this.globe = null;\r\n        _this.currentHighLightPoi = null;\r\n        _this.highlightListener = null;\r\n        _this.unHighlightListener = null;\r\n        _this.iconsWidth = 874;\r\n        _this.iconsHeight = 524;\r\n        _this.iconsRow = 6;\r\n        _this.iconsColumn = 10;\r\n        _this.MAX_POI_COUNT = _this.iconsColumn;\r\n        _this.validPinIconWidth = 50;\r\n        _this.validPinIconHeight = 70;\r\n        _this.normalMaterialRow = 3;\r\n        _this.highLightMaterialRow = 1;\r\n        _this.pinIconWidth = _this.iconsWidth / _this.iconsColumn;\r\n        _this.pinIconHeight = _this.iconsHeight / _this.iconsRow;\r\n        _this.pinIconDeltaU = _this.pinIconWidth / _this.iconsWidth;\r\n        _this.pinIconDeltaV = _this.pinIconHeight / _this.iconsHeight;\r\n        _this.validPinIconDeltaU = _this.validPinIconWidth / _this.iconsWidth;\r\n        _this.validPinIconDeltaV = _this.validPinIconHeight / _this.iconsHeight;\r\n        _this.validPinIconOffsetU = (_this.pinIconDeltaU - _this.validPinIconDeltaU) / 2;\r\n        _this.validPinIconOffsetV = (_this.pinIconDeltaV - _this.validPinIconDeltaV) / 2;\r\n        _this.poiPixelWidth = 30;\r\n        _this.poiPixelHeight = 42;\r\n        Utils_1.default.subscribe('extent-change', function () {\r\n            if (_this.searchExtentMode && _this.keyword) {\r\n                _this.search(_this.keyword);\r\n            }\r\n        });\r\n        Utils_1.default.subscribe('level-change', function () {\r\n            if (_this.children.length > 0) {\r\n                var resolution_1 = _this.globe.camera.getResolution();\r\n                _this.children.forEach(function (graphic) {\r\n                    var scale = resolution_1 / graphic.geometry.resolution;\r\n                    graphic.geometry.localScale(scale, scale, scale);\r\n                    graphic.geometry.resolution = resolution_1;\r\n                });\r\n            }\r\n        });\r\n        _this.setPickListener(function (target) {\r\n            if (_this.currentHighLightPoi !== target) {\r\n                _this.unHighlightPoi();\r\n                _this.highlightPoi(target);\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    PoiLayer.getInstance = function () {\r\n        return new PoiLayer();\r\n    };\r\n    PoiLayer.prototype._getUV = function (row, column) {\r\n        var smallV = this.pinIconDeltaV * row + this.validPinIconOffsetV;\r\n        var bigV = smallV + this.validPinIconDeltaV;\r\n        var smallU = this.pinIconDeltaU * column + this.validPinIconOffsetU;\r\n        var bigU = smallU + this.validPinIconDeltaU;\r\n        var v0 = [smallU, smallV];\r\n        var v1 = [smallU, bigV];\r\n        var v2 = [bigU, smallV];\r\n        var v3 = [bigU, bigV];\r\n        return [v0, v1, v2, v3];\r\n    };\r\n    PoiLayer.prototype.getHighlightPoi = function () {\r\n        return this.currentHighLightPoi;\r\n    };\r\n    PoiLayer.prototype.highlightPoi = function (target) {\r\n        if (this.currentHighLightPoi === target) {\r\n            return;\r\n        }\r\n        this.unHighlightPoi();\r\n        this.currentHighLightPoi = target;\r\n        this._updateMaterial(this.currentHighLightPoi, this.highLightMaterialRow);\r\n        this.moveChildToLastPosition(this.currentHighLightPoi);\r\n        if (this.highlightListener) {\r\n            this.highlightListener(this.currentHighLightPoi);\r\n        }\r\n    };\r\n    PoiLayer.prototype.unHighlightPoi = function () {\r\n        if (this.currentHighLightPoi) {\r\n            this._updateMaterial(this.currentHighLightPoi, this.normalMaterialRow);\r\n            this.currentHighLightPoi = null;\r\n            if (this.unHighlightListener) {\r\n                this.unHighlightListener();\r\n            }\r\n        }\r\n    };\r\n    PoiLayer.prototype.setHighlightListener = function (listener) {\r\n        this.highlightListener = listener;\r\n    };\r\n    PoiLayer.prototype.setUnHighlightListener = function (listener) {\r\n        this.unHighlightListener = listener;\r\n    };\r\n    PoiLayer.prototype._updateMaterial = function (target, row) {\r\n        var columnIndex = target.columnIndex;\r\n        var uv = this._getUV(row, columnIndex);\r\n        var _a = target.geometry.vertices, vLeftTop = _a[0], vLeftBottom = _a[1], vRightTop = _a[2], vRightBottom = _a[3];\r\n        vLeftTop.uv = uv[0];\r\n        vLeftBottom.uv = uv[1];\r\n        vRightTop.uv = uv[2];\r\n        vRightBottom.uv = uv[3];\r\n        target.geometry.calculateUVBO(true);\r\n    };\r\n    PoiLayer.prototype.shouldDraw = function () {\r\n        return this.globe && this.globe.camera.isEarthFullOverlapScreen() && _super.prototype.shouldDraw.call(this);\r\n    };\r\n    PoiLayer.prototype.onBeforeDraw = function () {\r\n        var gl = Kernel_1.default.gl;\r\n        gl.disable(gl.DEPTH_TEST);\r\n        gl.enable(Kernel_1.default.gl.BLEND);\r\n        gl.blendFunc(Kernel_1.default.gl.SRC_ALPHA, Kernel_1.default.gl.ONE_MINUS_SRC_ALPHA);\r\n    };\r\n    PoiLayer.prototype.onAfterDraw = function () {\r\n        var gl = Kernel_1.default.gl;\r\n        gl.enable(gl.DEPTH_TEST);\r\n        gl.disable(Kernel_1.default.gl.BLEND);\r\n    };\r\n    PoiLayer.prototype.destroy = function () {\r\n        this.globe = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    PoiLayer.prototype.clear = function () {\r\n        this.currentHighLightPoi = null;\r\n        _super.prototype.clear.call(this);\r\n    };\r\n    PoiLayer.prototype.clearAll = function () {\r\n        this.clear();\r\n        this.keyword = null;\r\n    };\r\n    PoiLayer.prototype._addPoi = function (lon, lat, resolution, item, index) {\r\n        var localMatrix = this.globe.camera.getMatrix().clone();\r\n        var pCenterBottom = Utils_2.default.geographicToCartesianCoord(lon, lat, Kernel_1.default.EARTH_RADIUS + 0.001);\r\n        localMatrix.setPosition(pCenterBottom);\r\n        var localXAxisVector = new Vector_1.default(1, 0, 0);\r\n        var halfWidth = resolution * this.poiPixelWidth / 2;\r\n        localXAxisVector.setLength(halfWidth);\r\n        var v3 = localXAxisVector.getVertice();\r\n        var v1 = localXAxisVector.getOpposite().getVertice();\r\n        var localUp = new Vector_1.default(0, 1, 0);\r\n        var height = resolution * this.poiPixelHeight;\r\n        localUp.setLength(height);\r\n        var v0 = Vector_1.default.verticePlusVector(v1, localUp);\r\n        var v2 = Vector_1.default.verticePlusVector(v3, localUp);\r\n        var uv = this._getUV(this.normalMaterialRow, index);\r\n        var meshV0 = new MeshVertice_1.default({\r\n            i: 0,\r\n            p: v0.getArray(),\r\n            uv: uv[0]\r\n        });\r\n        var meshV1 = new MeshVertice_1.default({\r\n            i: 1,\r\n            p: v1.getArray(),\r\n            uv: uv[1]\r\n        });\r\n        var meshV2 = new MeshVertice_1.default({\r\n            i: 2,\r\n            p: v2.getArray(),\r\n            uv: uv[2]\r\n        });\r\n        var meshV3 = new MeshVertice_1.default({\r\n            i: 3,\r\n            p: v3.getArray(),\r\n            uv: uv[3]\r\n        });\r\n        var mesh = Mesh_1.default.buildMesh(meshV0, meshV1, meshV2, meshV3);\r\n        mesh.setMatrix(localMatrix);\r\n        var material = new MeshTextureMaterial_1.default(poiImgUrl);\r\n        var graphic = new MeshTextureGraphic_1.default(mesh, material, item);\r\n        graphic.geometry.resolution = resolution;\r\n        graphic.columnIndex = index;\r\n        this.add(graphic);\r\n        return graphic;\r\n    };\r\n    PoiLayer.prototype._showPois = function (searchResponse) {\r\n        var _this = this;\r\n        this.clear();\r\n        var pois = searchResponse.detail.pois || [];\r\n        if (pois.length === 0) {\r\n            return;\r\n        }\r\n        if (pois.length > this.MAX_POI_COUNT) {\r\n            pois = pois.slice(0, this.MAX_POI_COUNT);\r\n        }\r\n        var lonlats = pois.map(function (item) {\r\n            var lon = parseFloat(item.pointx);\r\n            var lat = parseFloat(item.pointy);\r\n            return [lon, lat];\r\n        });\r\n        if (lonlats.length > 1) {\r\n            var extent = Extent_1.default.fromLonlats(lonlats);\r\n            this.globe.setExtent(extent);\r\n        }\r\n        else {\r\n            var lonlat = lonlats[0];\r\n            this.globe.centerTo(lonlat[0], lonlat[1]);\r\n        }\r\n        var resolution = this.globe.camera.getResolution();\r\n        searchResponse.detail.graphics = pois.map(function (item, index) {\r\n            var lon = parseFloat(item.pointx);\r\n            var lat = parseFloat(item.pointy);\r\n            return _this._addPoi(lon, lat, resolution, item, index);\r\n        });\r\n    };\r\n    PoiLayer.prototype.search = function (keyword) {\r\n        var _this = this;\r\n        this.searchExtentMode = true;\r\n        this.clearAll();\r\n        this.keyword = keyword;\r\n        var level = this.globe.getLevel();\r\n        if (level >= 10) {\r\n            var extent = this.globe.getExtent();\r\n            if (extent) {\r\n                Service_1.default.searchByExtent(keyword, level, extent).then(function (response) {\r\n                    _this._showPois(response);\r\n                });\r\n            }\r\n        }\r\n    };\r\n    PoiLayer.prototype.searchNearby = function (keyword, radius, searchType, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (searchType === void 0) { searchType = 'Auto'; }\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        this.clearAll();\r\n        this.keyword = keyword;\r\n        this.searchExtentMode = false;\r\n        return Service_1.default.searchNearby(keyword, radius, searchType, false, pageCapacity, pageIndex).then(function (response) {\r\n            _this._showPois(response);\r\n            return response;\r\n        });\r\n    };\r\n    PoiLayer.prototype.searchByCurrentCity = function (keyword, searchType, pageCapacity, pageIndex) {\r\n        var _this = this;\r\n        if (searchType === void 0) { searchType = 'Auto'; }\r\n        if (pageCapacity === void 0) { pageCapacity = 50; }\r\n        if (pageIndex === void 0) { pageIndex = 0; }\r\n        this.clearAll();\r\n        this.keyword = keyword;\r\n        return Service_1.default.searchByCurrentCity(keyword, searchType, pageCapacity, pageIndex).then(function (response) {\r\n            if (response) {\r\n                if (!response.location) {\r\n                    response.location = _this.globe.getLonlat();\r\n                }\r\n            }\r\n            _this._showPois(response);\r\n            return response;\r\n        });\r\n    };\r\n    return PoiLayer;\r\n}(GraphicGroup_1.PickableGraphicGroup));\r\nexports.default = PoiLayer;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/PoiLayer.ts\n// module id = 97\n// module chunks = 0 1","module.exports = __webpack_public_path__ + \"0f1e4f2d34556cdc2a9c4a8bc46f5def.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/images/icons.png\n// module id = 98\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Utils_1 = require(\"../Utils\");\r\nvar Utils_2 = require(\"../math/Utils\");\r\nvar Vertice_1 = require(\"../math/Vertice\");\r\nvar Vector_1 = require(\"../math/Vector\");\r\nvar MeshVertice_1 = require(\"../geometries/MeshVertice\");\r\nvar Mesh_1 = require(\"../geometries/Mesh\");\r\nvar MeshColorGraphic_1 = require(\"../graphics/MeshColorGraphic\");\r\nvar ColorMaterial_1 = require(\"../materials/ColorMaterial\");\r\nvar MarkerTextureMaterial_1 = require(\"../materials/MarkerTextureMaterial\");\r\nvar MultiPointsGraphic_1 = require(\"../graphics/MultiPointsGraphic\");\r\nvar GraphicGroup_1 = require(\"../GraphicGroup\");\r\nvar Service_1 = require(\"../Service\");\r\nvar Extent_1 = require(\"../Extent\");\r\nvar startPointImageUrl = require('../images/start.png');\r\nvar startPointImageSize = 80;\r\nvar endPointImageUrl = require('../images/end.png');\r\nvar endPointImageSize = 80;\r\nvar MeshRouteGraphic = (function (_super) {\r\n    __extends(MeshRouteGraphic, _super);\r\n    function MeshRouteGraphic(originalLonlats, pixelWidth, resolution, material) {\r\n        var _this = _super.call(this, null, material) || this;\r\n        _this.originalLonlats = originalLonlats;\r\n        _this.pixelWidth = pixelWidth;\r\n        _this.inflexionPointAngle = 30;\r\n        _this._removeDuplicatePoints(_this.originalLonlats);\r\n        _this.updateGeometry(resolution);\r\n        return _this;\r\n    }\r\n    MeshRouteGraphic.prototype.updateGeometry = function (resolution) {\r\n        var lonlats = this._handleCurveJoin(this.originalLonlats, resolution, this.pixelWidth);\r\n        var geometry = this._getRouteGeometryByLonlats(lonlats, resolution, this.pixelWidth);\r\n        this.setGeometry(geometry);\r\n    };\r\n    MeshRouteGraphic.prototype._removeDuplicatePoints = function (lonlats) {\r\n        var cursor = 0;\r\n        while (cursor <= (lonlats.length - 2)) {\r\n            var currentLonlat = lonlats[cursor];\r\n            var nextLonlat = lonlats[cursor + 1];\r\n            if (currentLonlat[0] === nextLonlat[0] && currentLonlat[1] === nextLonlat[1]) {\r\n                lonlats.splice(cursor + 1, 1);\r\n            }\r\n            else {\r\n                cursor += 1;\r\n            }\r\n        }\r\n    };\r\n    MeshRouteGraphic.prototype._handleCurveJoin = function (_lonlats, resolution, pixelWidth) {\r\n        var lonlats = [].concat(_lonlats);\r\n        var cursor = 1;\r\n        var offsetLonlat = Utils_2.default.radianToDegree(resolution * pixelWidth / Kernel_1.default.EARTH_RADIUS);\r\n        while (cursor <= (lonlats.length - 2)) {\r\n            var currentLonlat = lonlats[cursor];\r\n            var prevLonlat = lonlats[cursor - 1];\r\n            var nextLonlat = lonlats[cursor + 1];\r\n            var currentPoint = new Vertice_1.default(currentLonlat[0], currentLonlat[1], 0);\r\n            var prevPoint = new Vertice_1.default(prevLonlat[0], prevLonlat[1], 0);\r\n            var nextPoint = new Vertice_1.default(nextLonlat[0], nextLonlat[1], 0);\r\n            var vector1 = Vector_1.default.verticeMinusVertice(currentPoint, prevPoint);\r\n            var vector2 = Vector_1.default.verticeMinusVertice(nextPoint, currentPoint);\r\n            var radian = Vector_1.default.getRadianOfTwoVectors(vector1, vector2);\r\n            var angle = Utils_2.default.radianToDegree(radian);\r\n            if (angle > this.inflexionPointAngle) {\r\n                var p0 = null;\r\n                var p1 = currentLonlat;\r\n                var p2 = null;\r\n                var length1 = vector1.getLength();\r\n                var length2 = vector2.getLength();\r\n                var minLength = Math.min(length1, length2);\r\n                var deltaLength = Math.min(offsetLonlat, minLength / 2);\r\n                var p0Vertice = Vector_1.default.verticePlusVector(currentPoint, vector1.getOpposite().setLength(deltaLength));\r\n                p0 = [p0Vertice.x, p0Vertice.y];\r\n                var p2Vertice = Vector_1.default.verticePlusVector(currentPoint, vector2.clone().setLength(deltaLength));\r\n                p2 = [p2Vertice.x, p2Vertice.y];\r\n                var curveLonlats = Utils_2.default.quad(p0, p1, p2, 10);\r\n                lonlats.splice.apply(lonlats, [cursor, 1].concat(curveLonlats));\r\n                cursor += curveLonlats.length;\r\n            }\r\n            else {\r\n                cursor++;\r\n            }\r\n        }\r\n        return lonlats;\r\n    };\r\n    MeshRouteGraphic.prototype._getRouteGeometryByLonlats = function (lonlats, resolution, pixelWidth) {\r\n        var _this = this;\r\n        var mesh = new Mesh_1.default();\r\n        var points = lonlats.map(function (lonlat) {\r\n            return {\r\n                lonlat: lonlat,\r\n                vertice: Utils_2.default.geographicToCartesianCoord(lonlat[0], lonlat[1]),\r\n                start2EndVector: null,\r\n                v1: null,\r\n                v3: null\r\n            };\r\n        });\r\n        points.forEach(function (startPoint, index) {\r\n            if (index !== points.length - 1) {\r\n                var endPoint = points[index + 1];\r\n                startPoint.start2EndVector = Vector_1.default.verticeMinusVertice(endPoint.vertice, startPoint.vertice);\r\n            }\r\n            else {\r\n                var prevPoint = points[index - 1];\r\n                startPoint.start2EndVector = prevPoint.start2EndVector;\r\n            }\r\n        });\r\n        var startIndex = 0;\r\n        points.forEach(function (point, index) {\r\n            var _a;\r\n            var result = _this._getRouteVertices(startIndex, point.vertice, point.start2EndVector, resolution, pixelWidth);\r\n            startIndex = result.startIndex;\r\n            point.v1 = result.v1;\r\n            point.v3 = result.v3;\r\n            mesh.vertices.push(point.v1, point.v3);\r\n            if (index !== 0) {\r\n                var prevPoint = points[index - 1];\r\n                var v1 = prevPoint.v1;\r\n                var v3 = prevPoint.v3;\r\n                var v0 = point.v1;\r\n                var v2 = point.v3;\r\n                var triangles = Mesh_1.default.buildPlane(v0, v1, v2, v3);\r\n                (_a = mesh.triangles).push.apply(_a, triangles);\r\n            }\r\n        });\r\n        return mesh;\r\n    };\r\n    MeshRouteGraphic.prototype._getRouteVertices = function (startIndex, startVertice, start2EndVector, resolution, pixelWidth) {\r\n        var origin2StartVector = Vector_1.default.fromVertice(startVertice);\r\n        var end2StartVector = start2EndVector.getOpposite();\r\n        var offset = resolution * pixelWidth / 2;\r\n        var start2LeftBottomVector = origin2StartVector.cross(start2EndVector).setLength(offset);\r\n        var p1 = Vector_1.default.verticePlusVector(startVertice, start2LeftBottomVector).getArray();\r\n        var v1 = new MeshVertice_1.default({\r\n            i: startIndex++,\r\n            p: p1\r\n        });\r\n        var start2RightBottomVector = origin2StartVector.cross(end2StartVector).setLength(offset);\r\n        var p3 = Vector_1.default.verticePlusVector(startVertice, start2RightBottomVector).getArray();\r\n        var v3 = new MeshVertice_1.default({\r\n            i: startIndex++,\r\n            p: p3\r\n        });\r\n        return {\r\n            startIndex: startIndex,\r\n            v1: v1,\r\n            v3: v3\r\n        };\r\n    };\r\n    return MeshRouteGraphic;\r\n}(MeshColorGraphic_1.default));\r\nvar RouteLayer = (function (_super) {\r\n    __extends(RouteLayer, _super);\r\n    function RouteLayer(camera, key) {\r\n        var _this = _super.call(this) || this;\r\n        _this.camera = camera;\r\n        _this.key = key;\r\n        _this.pixelWidth = 5;\r\n        _this.busColor = [82, 153, 255];\r\n        _this.drivingColor = [0, 189, 0];\r\n        _this.walkingColor = [76, 221, 38];\r\n        _this.startLonlat = null;\r\n        _this.endLonlat = null;\r\n        _this.route = null;\r\n        _this.deltaLonlatSquareThreshold = Math.pow(1 / (2 * Math.PI * Kernel_1.default.REAL_EARTH_RADIUS) * 360, 2);\r\n        Utils_1.default.subscribe('level-change', function () {\r\n            if (_this.children.length > 0) {\r\n                var resolution_1 = _this.camera.getResolution();\r\n                _this.children.forEach(function (graphic) {\r\n                    if (graphic instanceof MeshRouteGraphic) {\r\n                        graphic.updateGeometry(resolution_1);\r\n                    }\r\n                });\r\n            }\r\n        });\r\n        return _this;\r\n    }\r\n    RouteLayer.prototype.test = function (pixelWidth, segments, rgb) {\r\n        if (pixelWidth === void 0) { pixelWidth = 5; }\r\n        if (segments === void 0) { segments = 100; }\r\n        if (rgb === void 0) { rgb = [0, 255, 0]; }\r\n        var resolution = this.camera.getResolution();\r\n        this._addRouteByLonlats([[90, 0], [120, 0], [120, 40]], resolution, this.pixelWidth, rgb);\r\n    };\r\n    RouteLayer.prototype._addRouteByLonlat = function (startLonLat, endLonLat, resolution, pixelWidth, segments, rgb) {\r\n        var lonlats = this._getLonlatsBySegments(startLonLat, endLonLat, segments);\r\n        return this._addRouteByLonlats(lonlats, resolution, pixelWidth, rgb);\r\n    };\r\n    RouteLayer.prototype._addRouteByLonlats = function (lonlats, resolution, pixelWidth, rgb) {\r\n        var graphic = null;\r\n        if (lonlats.length >= 2) {\r\n            var validLonlats = lonlats;\r\n            if (validLonlats.length >= 2) {\r\n                graphic = new MeshRouteGraphic(validLonlats, pixelWidth, resolution, new ColorMaterial_1.default(rgb));\r\n                this.add(graphic);\r\n            }\r\n        }\r\n        return graphic;\r\n    };\r\n    RouteLayer.prototype._getLonlatsBySegments = function (startLonLat, endLonLat, segments) {\r\n        var deltaLon = (endLonLat[0] - startLonLat[0]) / segments;\r\n        var deltaLat = (endLonLat[1] - startLonLat[1]) / segments;\r\n        var lonlats = [];\r\n        for (var i = 0; i < segments; i++) {\r\n            var lonlat = [startLonLat[0] + deltaLon * i, startLonLat[1] + deltaLat * i];\r\n            lonlats.push(lonlat);\r\n        }\r\n        lonlats.push(endLonLat);\r\n        return lonlats;\r\n    };\r\n    RouteLayer.prototype.showPath = function (pathIndex) {\r\n        if (this.route) {\r\n            if (this.route.type === 'driving') {\r\n                this._showDrivingPath(pathIndex);\r\n            }\r\n            else if (this.route.type === 'bus') {\r\n                this._showBusPath(pathIndex);\r\n            }\r\n            else if (this.route.type === 'walking') {\r\n                this._showWalkingPath(pathIndex);\r\n            }\r\n        }\r\n    };\r\n    RouteLayer.prototype.routeByDriving = function (fromLon, fromLat, toLon, toLat, strategy) {\r\n        var _this = this;\r\n        if (strategy === void 0) { strategy = 5; }\r\n        return Service_1.default.routeByDriving(fromLon, fromLat, toLon, toLat, this.key, strategy).then(function (response) {\r\n            _this._clearAll();\r\n            if (response.route && response.route.paths && response.route.paths.length > 0) {\r\n                _this.startLonlat = [fromLon, fromLat];\r\n                _this.endLonlat = [toLon, toLat];\r\n                _this.route = response.route;\r\n                _this.showPath(0);\r\n            }\r\n            return response;\r\n        });\r\n    };\r\n    RouteLayer.prototype._showDrivingPath = function (pathIndex) {\r\n        var _this = this;\r\n        if (this.route && this.route.paths && this.route.paths.length > 0) {\r\n            var path = this.route.paths[pathIndex];\r\n            if (path && path.steps && path.steps.length > 0) {\r\n                this.clear();\r\n                var lonlats_1 = [];\r\n                path.steps.forEach(function (step, index, steps) {\r\n                    lonlats_1.push.apply(lonlats_1, step.lonlats);\r\n                });\r\n                var extent = Extent_1.default.fromLonlats(lonlats_1);\r\n                if (extent) {\r\n                    this.camera.setExtent(extent);\r\n                    setTimeout(function () {\r\n                        var resolution = _this.camera.getResolution();\r\n                        _this._addRouteByLonlats(lonlats_1, resolution, _this.pixelWidth, _this.drivingColor);\r\n                        _this._showStartEndPoints();\r\n                    }, 0);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    RouteLayer.prototype.routeByBus = function (fromLon, fromLat, toLon, toLat, startCity, endCity, strategy) {\r\n        var _this = this;\r\n        if (strategy === void 0) { strategy = 0; }\r\n        return Service_1.default.routeByBus(fromLon, fromLat, toLon, toLat, startCity, endCity, this.key, strategy).then(function (response) {\r\n            _this._clearAll();\r\n            if (response.route && response.route.transits && response.route.transits.length > 0) {\r\n                _this.startLonlat = [fromLon, fromLat];\r\n                _this.endLonlat = [toLon, toLat];\r\n                _this.route = response.route;\r\n                _this.showPath(0);\r\n            }\r\n            return response;\r\n        });\r\n    };\r\n    RouteLayer.prototype._showBusPath = function (pathIndex) {\r\n        var _this = this;\r\n        if (this.route && this.route.transits && this.route.transits.length > 0) {\r\n            var transit = this.route.transits[pathIndex];\r\n            if (transit && transit.segments && transit.segments.length > 0) {\r\n                this.clear();\r\n                var lonlats_2 = [];\r\n                var lonlatsSegments_1 = [];\r\n                transit.segments.forEach(function (segment) {\r\n                    if (segment.walking && segment.walking.lonlats && segment.walking.lonlats.length > 0) {\r\n                        segment.walking.lonlats.color = _this.walkingColor;\r\n                        lonlatsSegments_1.push(segment.walking.lonlats);\r\n                        lonlats_2.push.apply(lonlats_2, segment.walking.lonlats);\r\n                    }\r\n                    if (segment.bus && segment.bus.lonlats && segment.bus.lonlats.length > 0) {\r\n                        segment.bus.lonlats.color = _this.busColor;\r\n                        lonlatsSegments_1.push(segment.bus.lonlats);\r\n                        lonlats_2.push.apply(lonlats_2, segment.bus.lonlats);\r\n                    }\r\n                    if (segment.railway && segment.railway.lonlats && segment.railway.lonlats.length > 0) {\r\n                        segment.railway.lonlats.color = _this.busColor;\r\n                        lonlatsSegments_1.push(segment.railway.lonlats);\r\n                        lonlats_2.push.apply(lonlats_2, segment.railway.lonlats);\r\n                    }\r\n                });\r\n                var extent = Extent_1.default.fromLonlats(lonlats_2);\r\n                if (extent) {\r\n                    this.camera.setExtent(extent);\r\n                    setTimeout(function () {\r\n                        var resolution = _this.camera.getResolution();\r\n                        lonlatsSegments_1.forEach(function (lonlats) {\r\n                            _this._addRouteByLonlats(lonlats, resolution, _this.pixelWidth, lonlats.color);\r\n                        });\r\n                        _this._showStartEndPoints();\r\n                    }, 0);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    RouteLayer.prototype.routeByWalking = function (fromLon, fromLat, toLon, toLat) {\r\n        var _this = this;\r\n        return Service_1.default.routeByWalking(fromLon, fromLat, toLon, toLat, this.key).then(function (response) {\r\n            _this._clearAll();\r\n            if (response.route && response.route.paths && response.route.paths.length > 0) {\r\n                _this.startLonlat = [fromLon, fromLat];\r\n                _this.endLonlat = [toLon, toLat];\r\n                _this.route = response.route;\r\n                _this._showWalkingPath(0);\r\n            }\r\n            return response;\r\n        });\r\n    };\r\n    RouteLayer.prototype._showWalkingPath = function (pathIndex) {\r\n        var _this = this;\r\n        if (this.route && this.route.paths && this.route.paths.length > 0) {\r\n            var path = this.route.paths[pathIndex];\r\n            if (path && path.steps && path.steps.length > 0) {\r\n                this.clear();\r\n                var lonlats_3 = [];\r\n                path.steps.forEach(function (step) {\r\n                    lonlats_3.push.apply(lonlats_3, step.lonlats);\r\n                });\r\n                var extent = Extent_1.default.fromLonlats(lonlats_3);\r\n                if (extent) {\r\n                    this.camera.setExtent(extent);\r\n                    setTimeout(function () {\r\n                        var resolution = _this.camera.getResolution();\r\n                        _this._addRouteByLonlats(lonlats_3, resolution, _this.pixelWidth, _this.walkingColor);\r\n                        _this._showStartEndPoints();\r\n                    }, 0);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    RouteLayer.prototype._showStartEndPoints = function () {\r\n        if (this.startLonlat) {\r\n            var material = new MarkerTextureMaterial_1.default(startPointImageUrl, startPointImageSize);\r\n            var startPointGraphic = new MultiPointsGraphic_1.default(material);\r\n            startPointGraphic.setLonlats([this.startLonlat]);\r\n            this.add(startPointGraphic);\r\n        }\r\n        if (this.endLonlat) {\r\n            var material = new MarkerTextureMaterial_1.default(endPointImageUrl, endPointImageSize);\r\n            var endPointGraphic = new MultiPointsGraphic_1.default(material);\r\n            endPointGraphic.setLonlats([this.endLonlat]);\r\n            this.add(endPointGraphic);\r\n        }\r\n    };\r\n    RouteLayer.prototype._clearAll = function () {\r\n        this.startLonlat = null;\r\n        this.endLonlat = null;\r\n        this.route = null;\r\n        this.clear();\r\n    };\r\n    RouteLayer.prototype.onDraw = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        gl.disable(Kernel_1.default.gl.DEPTH_TEST);\r\n        gl.depthMask(false);\r\n        _super.prototype.onDraw.call(this, camera);\r\n        gl.enable(Kernel_1.default.gl.DEPTH_TEST);\r\n        gl.depthMask(true);\r\n    };\r\n    RouteLayer.prototype.destroy = function () {\r\n        this.camera = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    RouteLayer.prototype.test2 = function (str) {\r\n        var splits = str.split(\";\");\r\n        var splits1 = splits[0].split(\",\");\r\n        var splits2 = splits[1].split(\",\");\r\n        var lon1 = parseFloat(splits1[0]);\r\n        var lat1 = parseFloat(splits1[1]);\r\n        var lon2 = parseFloat(splits2[0]);\r\n        var lat2 = parseFloat(splits2[1]);\r\n        var s = Math.pow((lon1 - lon2), 2) + Math.pow((lat1 - lat2), 2);\r\n        var distance = Utils_2.default.getRealArcDistanceBetweenLonLats(lon1, lat1, lon2, lat2);\r\n        return {\r\n            lon1: lon1,\r\n            lat1: lat1,\r\n            lon2: lon2,\r\n            lat2: lat2,\r\n            s: s,\r\n            distance: distance\r\n        };\r\n    };\r\n    RouteLayer.getInstance = function (camera, key) {\r\n        return new RouteLayer(camera, key);\r\n    };\r\n    return RouteLayer;\r\n}(GraphicGroup_1.default));\r\nexports.default = RouteLayer;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/layers/RouteLayer.ts\n// module id = 99\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"../Kernel\");\r\nvar Program_1 = require(\"../Program\");\r\nvar Graphic_1 = require(\"./Graphic\");\r\nvar vs = \"\\nattribute vec3 aPosition;\\nattribute vec3 aColor;\\nvarying vec4 vColor;\\nuniform mat4 uPMVMatrix;\\n\\nvoid main()\\n{\\n\\tgl_Position = uPMVMatrix * vec4(aPosition,1.0);\\n\\tvColor = vec4(aColor,1.0);\\n}\\n\";\r\nvar fs = \"\\nprecision mediump float;\\nvarying vec4 vColor;\\n\\nvoid main()\\n{\\n\\tgl_FragColor = vColor;\\n}\\n\";\r\nvar MeshColorGraphic = (function (_super) {\r\n    __extends(MeshColorGraphic, _super);\r\n    function MeshColorGraphic(geometry, material) {\r\n        var _this = _super.call(this, geometry, material) || this;\r\n        _this.geometry = geometry;\r\n        _this.material = material;\r\n        _this.setGeometry(geometry);\r\n        return _this;\r\n    }\r\n    MeshColorGraphic.prototype.setGeometry = function (geometry) {\r\n        var _this = this;\r\n        if (this.geometry) {\r\n            this.geometry.destroy();\r\n        }\r\n        this.geometry = geometry;\r\n        if (this.geometry) {\r\n            this.geometry.vertices.forEach(function (vertice) {\r\n                vertice.c = _this.material.color;\r\n            });\r\n            this.geometry.calculateVBO();\r\n            this.geometry.calculateIBO();\r\n            this.geometry.calculateCBO();\r\n        }\r\n    };\r\n    MeshColorGraphic.prototype.isGeometryReady = function () {\r\n        return !!this.geometry.vbo && !!this.geometry.ibo && !!this.geometry.cbo;\r\n    };\r\n    MeshColorGraphic.prototype.isReady = function () {\r\n        return this.isGeometryReady() && _super.prototype.isReady.call(this);\r\n    };\r\n    MeshColorGraphic.prototype.createProgram = function () {\r\n        return Program_1.default.getProgram(vs, fs);\r\n    };\r\n    MeshColorGraphic.prototype.updateShaderUniforms = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        var pmvMatrix = camera.getProjViewMatrixForDraw().multiplyMatrix(this.geometry.getMatrix());\r\n        var locPMVMatrix = this.program.getUniformLocation('uPMVMatrix');\r\n        gl.uniformMatrix4fv(locPMVMatrix, false, pmvMatrix.getFloat32Array());\r\n    };\r\n    MeshColorGraphic.prototype.onDraw = function (camera) {\r\n        var gl = Kernel_1.default.gl;\r\n        this.updateShaderUniforms(camera);\r\n        var locPosition = this.program.getAttribLocation('aPosition');\r\n        this.program.enableVertexAttribArray('aPosition');\r\n        this.geometry.vbo.bind();\r\n        gl.vertexAttribPointer(locPosition, 3, Kernel_1.default.gl.FLOAT, false, 0, 0);\r\n        var locColor = this.program.getAttribLocation('aColor');\r\n        this.program.enableVertexAttribArray('aColor');\r\n        this.geometry.cbo.bind();\r\n        gl.vertexAttribPointer(locColor, 3, Kernel_1.default.gl.FLOAT, false, 0, 0);\r\n        this.geometry.ibo.bind();\r\n        var count = this.geometry.triangles.length * 3;\r\n        gl.drawElements(Kernel_1.default.gl.TRIANGLES, count, Kernel_1.default.gl.UNSIGNED_SHORT, 0);\r\n    };\r\n    return MeshColorGraphic;\r\n}(Graphic_1.default));\r\nexports.default = MeshColorGraphic;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/graphics/MeshColorGraphic.ts\n// module id = 100\n// module chunks = 0 1","\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Material_1 = require(\"./Material\");\r\nvar ColorMaterial = (function (_super) {\r\n    __extends(ColorMaterial, _super);\r\n    function ColorMaterial(rgb255) {\r\n        var _this = _super.call(this) || this;\r\n        _this.color = null;\r\n        _this.color = [rgb255[0] / 255, rgb255[1] / 255, rgb255[2] / 255];\r\n        return _this;\r\n    }\r\n    ColorMaterial.prototype.isReady = function () {\r\n        return this.color && this.color.length > 0;\r\n    };\r\n    ColorMaterial.prototype.destroy = function () {\r\n    };\r\n    return ColorMaterial;\r\n}(Material_1.default));\r\nexports.default = ColorMaterial;\r\n;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/materials/ColorMaterial.ts\n// module id = 101\n// module chunks = 0 1","module.exports = __webpack_public_path__ + \"1e93a1226fa156bb6eeecd8276af7194.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/images/start.png\n// module id = 102\n// module chunks = 0 1","module.exports = __webpack_public_path__ + \"34bb6835acf6236b7da4eaedd6b3db4e.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/world/images/end.png\n// module id = 103\n// module chunks = 0 1","\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Kernel_1 = require(\"./world/Kernel\");\r\nexports.Kernel = Kernel_1.default;\r\nvar Globe_1 = require(\"./world/Globe\");\r\nexports.Globe = Globe_1.default;\r\nexports.GlobeOptions = Globe_1.GlobeOptions;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/core/index.ts\n// module id = 179\n// module chunks = 1"],"sourceRoot":""}